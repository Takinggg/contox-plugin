#!/usr/bin/env node
"use strict";var cy=Object.create;var xi=Object.defineProperty;var uy=Object.getOwnPropertyDescriptor;var ly=Object.getOwnPropertyNames;var dy=Object.getPrototypeOf,py=Object.prototype.hasOwnProperty;var z=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),bi=(t,e)=>{for(var r in e)xi(t,r,{get:e[r],enumerable:!0})},fy=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ly(e))!py.call(t,o)&&o!==r&&xi(t,o,{get:()=>e[o],enumerable:!(n=uy(e,o))||n.enumerable});return t};var So=(t,e,r)=>(r=t!=null?cy(dy(t)):{},fy(e||!t||!t.__esModule?xi(r,"default",{value:t,enumerable:!0}):r,t));var Gn=z(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.regexpCode=Y.getEsmExportName=Y.getProperty=Y.safeStringify=Y.stringify=Y.strConcat=Y.addCodeArg=Y.str=Y._=Y.nil=Y._Code=Y.Name=Y.IDENTIFIER=Y._CodeOrName=void 0;var Hn=class{};Y._CodeOrName=Hn;Y.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var wr=class extends Hn{constructor(e){if(super(),!Y.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};Y.Name=wr;var et=class extends Hn{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof wr&&(r[n.str]=(r[n.str]||0)+1),r),{})}};Y._Code=et;Y.nil=new et("");function Xf(t,...e){let r=[t[0]],n=0;for(;n<e.length;)su(r,e[n]),r.push(t[++n]);return new et(r)}Y._=Xf;var ou=new et("+");function Yf(t,...e){let r=[Bn(t[0])],n=0;for(;n<e.length;)r.push(ou),su(r,e[n]),r.push(ou,Bn(t[++n]));return l$(r),new et(r)}Y.str=Yf;function su(t,e){e instanceof et?t.push(...e._items):e instanceof wr?t.push(e):t.push(f$(e))}Y.addCodeArg=su;function l$(t){let e=1;for(;e<t.length-1;){if(t[e]===ou){let r=d$(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function d$(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof wr||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof wr))return`"${t}${e.slice(1)}`}function p$(t,e){return e.emptyStr()?t:t.emptyStr()?e:Yf`${t}${e}`}Y.strConcat=p$;function f$(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Bn(Array.isArray(t)?t.join(","):t)}function m$(t){return new et(Bn(t))}Y.stringify=m$;function Bn(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}Y.safeStringify=Bn;function h$(t){return typeof t=="string"&&Y.IDENTIFIER.test(t)?new et(`.${t}`):Xf`[${t}]`}Y.getProperty=h$;function g$(t){if(typeof t=="string"&&Y.IDENTIFIER.test(t))return new et(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}Y.getEsmExportName=g$;function y$(t){return new et(t.toString())}Y.regexpCode=y$});var cu=z(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.ValueScope=Ue.ValueScopeName=Ue.Scope=Ue.varKinds=Ue.UsedValueState=void 0;var Le=Gn(),iu=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},Ts;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(Ts||(Ue.UsedValueState=Ts={}));Ue.varKinds={const:new Le.Name("const"),let:new Le.Name("let"),var:new Le.Name("var")};var Ps=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof Le.Name?e:this.name(e)}name(e){return new Le.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};Ue.Scope=Ps;var Es=class extends Le.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,Le._)`.${new Le.Name(r)}[${n}]`}};Ue.ValueScopeName=Es;var _$=(0,Le._)`\n`,au=class extends Ps{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?_$:Le.nil}}get(){return this._scope}name(e){return new Es(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let o=this.toName(e),{prefix:s}=o,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[s];if(a){let l=a.get(i);if(l)return l}else a=this._values[s]=new Map;a.set(i,o);let c=this._scope[s]||(this._scope[s]=[]),u=c.length;return c[u]=r.ref,o.setValue(r,{property:s,itemIndex:u}),o}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,Le._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,o=>{if(o.value===void 0)throw new Error(`CodeGen: name "${o}" has no value`);return o.value.code},r,n)}_reduceValues(e,r,n={},o){let s=Le.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,Ts.Started);let l=r(u);if(l){let d=this.opts.es5?Ue.varKinds.var:Ue.varKinds.const;s=(0,Le._)`${s}${d} ${u} = ${l};${this.opts._n}`}else if(l=o?.(u))s=(0,Le._)`${s}${l}${this.opts._n}`;else throw new iu(u);c.set(u,Ts.Completed)})}return s}};Ue.ValueScope=au});var V=z(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.or=F.and=F.not=F.CodeGen=F.operators=F.varKinds=F.ValueScopeName=F.ValueScope=F.Scope=F.Name=F.regexpCode=F.stringify=F.getProperty=F.nil=F.strConcat=F.str=F._=void 0;var W=Gn(),ct=cu(),Ft=Gn();Object.defineProperty(F,"_",{enumerable:!0,get:function(){return Ft._}});Object.defineProperty(F,"str",{enumerable:!0,get:function(){return Ft.str}});Object.defineProperty(F,"strConcat",{enumerable:!0,get:function(){return Ft.strConcat}});Object.defineProperty(F,"nil",{enumerable:!0,get:function(){return Ft.nil}});Object.defineProperty(F,"getProperty",{enumerable:!0,get:function(){return Ft.getProperty}});Object.defineProperty(F,"stringify",{enumerable:!0,get:function(){return Ft.stringify}});Object.defineProperty(F,"regexpCode",{enumerable:!0,get:function(){return Ft.regexpCode}});Object.defineProperty(F,"Name",{enumerable:!0,get:function(){return Ft.Name}});var Ns=cu();Object.defineProperty(F,"Scope",{enumerable:!0,get:function(){return Ns.Scope}});Object.defineProperty(F,"ValueScope",{enumerable:!0,get:function(){return Ns.ValueScope}});Object.defineProperty(F,"ValueScopeName",{enumerable:!0,get:function(){return Ns.ValueScopeName}});Object.defineProperty(F,"varKinds",{enumerable:!0,get:function(){return Ns.varKinds}});F.operators={GT:new W._Code(">"),GTE:new W._Code(">="),LT:new W._Code("<"),LTE:new W._Code("<="),EQ:new W._Code("==="),NEQ:new W._Code("!=="),NOT:new W._Code("!"),OR:new W._Code("||"),AND:new W._Code("&&"),ADD:new W._Code("+")};var Pt=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},uu=class extends Pt{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?ct.varKinds.var:this.varKind,o=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${o};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=Qr(this.rhs,e,r)),this}get names(){return this.rhs instanceof W._CodeOrName?this.rhs.names:{}}},Is=class extends Pt{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof W.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=Qr(this.rhs,e,r),this}get names(){let e=this.lhs instanceof W.Name?{}:{...this.lhs.names};return Rs(e,this.rhs)}},lu=class extends Is{constructor(e,r,n,o){super(e,n,o),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},du=class extends Pt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},pu=class extends Pt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},fu=class extends Pt{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},mu=class extends Pt{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=Qr(this.code,e,r),this}get names(){return this.code instanceof W._CodeOrName?this.code.names:{}}},Jn=class extends Pt{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,o=n.length;for(;o--;){let s=n[o];s.optimizeNames(e,r)||(v$(e,s.names),n.splice(o,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>zr(e,r.names),{})}},Et=class extends Jn{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},hu=class extends Jn{},Yr=class extends Et{};Yr.kind="else";var kr=class t extends Et{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new Yr(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(Qf(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=Qr(this.condition,e,r),this}get names(){let e=super.names;return Rs(e,this.condition),this.else&&zr(e,this.else.names),e}};kr.kind="if";var Sr=class extends Et{};Sr.kind="for";var gu=class extends Sr{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=Qr(this.iteration,e,r),this}get names(){return zr(super.names,this.iteration.names)}},yu=class extends Sr{constructor(e,r,n,o){super(),this.varKind=e,this.name=r,this.from=n,this.to=o}render(e){let r=e.es5?ct.varKinds.var:this.varKind,{name:n,from:o,to:s}=this;return`for(${r} ${n}=${o}; ${n}<${s}; ${n}++)`+super.render(e)}get names(){let e=Rs(super.names,this.from);return Rs(e,this.to)}},Cs=class extends Sr{constructor(e,r,n,o){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=o}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=Qr(this.iterable,e,r),this}get names(){return zr(super.names,this.iterable.names)}},Wn=class extends Et{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Wn.kind="func";var Xn=class extends Jn{render(e){return"return "+super.render(e)}};Xn.kind="return";var _u=class extends Et{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,o;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(o=this.finally)===null||o===void 0||o.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&zr(e,this.catch.names),this.finally&&zr(e,this.finally.names),e}},Yn=class extends Et{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Yn.kind="catch";var Qn=class extends Et{render(e){return"finally"+super.render(e)}};Qn.kind="finally";var vu=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new ct.Scope({parent:e}),this._nodes=[new hu]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,o){let s=this._scope.toName(r);return n!==void 0&&o&&(this._constants[s.str]=n),this._leafNode(new uu(e,s,n)),s}const(e,r,n){return this._def(ct.varKinds.const,e,r,n)}let(e,r,n){return this._def(ct.varKinds.let,e,r,n)}var(e,r,n){return this._def(ct.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Is(e,r,n))}add(e,r){return this._leafNode(new lu(e,F.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==W.nil&&this._leafNode(new mu(e)),this}object(...e){let r=["{"];for(let[n,o]of e)r.length>1&&r.push(","),r.push(n),(n!==o||this.opts.es5)&&(r.push(":"),(0,W.addCodeArg)(r,o));return r.push("}"),new W._Code(r)}if(e,r,n){if(this._blockNode(new kr(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new kr(e))}else(){return this._elseNode(new Yr)}endIf(){return this._endBlockNode(kr,Yr)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new gu(e),r)}forRange(e,r,n,o,s=this.opts.es5?ct.varKinds.var:ct.varKinds.let){let i=this._scope.toName(e);return this._for(new yu(s,i,r,n),()=>o(i))}forOf(e,r,n,o=ct.varKinds.const){let s=this._scope.toName(e);if(this.opts.es5){let i=r instanceof W.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,W._)`${i}.length`,a=>{this.var(s,(0,W._)`${i}[${a}]`),n(s)})}return this._for(new Cs("of",o,s,r),()=>n(s))}forIn(e,r,n,o=this.opts.es5?ct.varKinds.var:ct.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,W._)`Object.keys(${r})`,n);let s=this._scope.toName(e);return this._for(new Cs("in",o,s,r),()=>n(s))}endFor(){return this._endBlockNode(Sr)}label(e){return this._leafNode(new du(e))}break(e){return this._leafNode(new pu(e))}return(e){let r=new Xn;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Xn)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let o=new _u;if(this._blockNode(o),this.code(e),r){let s=this.name("e");this._currNode=o.catch=new Yn(s),r(s)}return n&&(this._currNode=o.finally=new Qn,this.code(n)),this._endBlockNode(Yn,Qn)}throw(e){return this._leafNode(new fu(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=W.nil,n,o){return this._blockNode(new Wn(e,r,n)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(Wn)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof kr))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};F.CodeGen=vu;function zr(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function Rs(t,e){return e instanceof W._CodeOrName?zr(t,e.names):t}function Qr(t,e,r){if(t instanceof W.Name)return n(t);if(!o(t))return t;return new W._Code(t._items.reduce((s,i)=>(i instanceof W.Name&&(i=n(i)),i instanceof W._Code?s.push(...i._items):s.push(i),s),[]));function n(s){let i=r[s.str];return i===void 0||e[s.str]!==1?s:(delete e[s.str],i)}function o(s){return s instanceof W._Code&&s._items.some(i=>i instanceof W.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function v$(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Qf(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,W._)`!${xu(t)}`}F.not=Qf;var x$=em(F.operators.AND);function b$(...t){return t.reduce(x$)}F.and=b$;var $$=em(F.operators.OR);function w$(...t){return t.reduce($$)}F.or=w$;function em(t){return(e,r)=>e===W.nil?r:r===W.nil?e:(0,W._)`${xu(e)} ${t} ${xu(r)}`}function xu(t){return t instanceof W.Name?t:(0,W._)`(${t})`}});var Q=z(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.checkStrictMode=K.getErrorPath=K.Type=K.useFunc=K.setEvaluated=K.evaluatedPropsToName=K.mergeEvaluated=K.eachItem=K.unescapeJsonPointer=K.escapeJsonPointer=K.escapeFragment=K.unescapeFragment=K.schemaRefOrVal=K.schemaHasRulesButRef=K.schemaHasRules=K.checkUnknownRules=K.alwaysValidSchema=K.toHash=void 0;var ne=V(),k$=Gn();function S$(t){let e={};for(let r of t)e[r]=!0;return e}K.toHash=S$;function z$(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(nm(t,e),!om(e,t.self.RULES.all))}K.alwaysValidSchema=z$;function nm(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let o=n.RULES.keywords;for(let s in e)o[s]||am(t,`unknown keyword: "${s}"`)}K.checkUnknownRules=nm;function om(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}K.schemaHasRules=om;function T$(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}K.schemaHasRulesButRef=T$;function P$({topSchemaRef:t,schemaPath:e},r,n,o){if(!o){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,ne._)`${r}`}return(0,ne._)`${t}${e}${(0,ne.getProperty)(n)}`}K.schemaRefOrVal=P$;function E$(t){return sm(decodeURIComponent(t))}K.unescapeFragment=E$;function I$(t){return encodeURIComponent($u(t))}K.escapeFragment=I$;function $u(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}K.escapeJsonPointer=$u;function sm(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}K.unescapeJsonPointer=sm;function C$(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}K.eachItem=C$;function tm({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(o,s,i,a)=>{let c=i===void 0?s:i instanceof ne.Name?(s instanceof ne.Name?t(o,s,i):e(o,s,i),i):s instanceof ne.Name?(e(o,i,s),s):r(s,i);return a===ne.Name&&!(c instanceof ne.Name)?n(o,c):c}}K.mergeEvaluated={props:tm({mergeNames:(t,e,r)=>t.if((0,ne._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,ne._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,ne._)`${r} || {}`).code((0,ne._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,ne._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,ne._)`${r} || {}`),wu(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:im}),items:tm({mergeNames:(t,e,r)=>t.if((0,ne._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,ne._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,ne._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,ne._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function im(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,ne._)`{}`);return e!==void 0&&wu(t,r,e),r}K.evaluatedPropsToName=im;function wu(t,e,r){Object.keys(r).forEach(n=>t.assign((0,ne._)`${e}${(0,ne.getProperty)(n)}`,!0))}K.setEvaluated=wu;var rm={};function R$(t,e){return t.scopeValue("func",{ref:e,code:rm[e.code]||(rm[e.code]=new k$._Code(e.code))})}K.useFunc=R$;var bu;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(bu||(K.Type=bu={}));function N$(t,e,r){if(t instanceof ne.Name){let n=e===bu.Num;return r?n?(0,ne._)`"[" + ${t} + "]"`:(0,ne._)`"['" + ${t} + "']"`:n?(0,ne._)`"/" + ${t}`:(0,ne._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ne.getProperty)(t).toString():"/"+$u(t)}K.getErrorPath=N$;function am(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}K.checkStrictMode=am});var It=z(ku=>{"use strict";Object.defineProperty(ku,"__esModule",{value:!0});var Ee=V(),O$={data:new Ee.Name("data"),valCxt:new Ee.Name("valCxt"),instancePath:new Ee.Name("instancePath"),parentData:new Ee.Name("parentData"),parentDataProperty:new Ee.Name("parentDataProperty"),rootData:new Ee.Name("rootData"),dynamicAnchors:new Ee.Name("dynamicAnchors"),vErrors:new Ee.Name("vErrors"),errors:new Ee.Name("errors"),this:new Ee.Name("this"),self:new Ee.Name("self"),scope:new Ee.Name("scope"),json:new Ee.Name("json"),jsonPos:new Ee.Name("jsonPos"),jsonLen:new Ee.Name("jsonLen"),jsonPart:new Ee.Name("jsonPart")};ku.default=O$});var eo=z(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.extendErrors=Ie.resetErrorsCount=Ie.reportExtraError=Ie.reportError=Ie.keyword$DataError=Ie.keywordError=void 0;var X=V(),Os=Q(),je=It();Ie.keywordError={message:({keyword:t})=>(0,X.str)`must pass "${t}" keyword validation`};Ie.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,X.str)`"${t}" keyword must be ${e} ($data)`:(0,X.str)`"${t}" keyword is invalid ($data)`};function j$(t,e=Ie.keywordError,r,n){let{it:o}=t,{gen:s,compositeRule:i,allErrors:a}=o,c=lm(t,e,r);n??(i||a)?cm(s,c):um(o,(0,X._)`[${c}]`)}Ie.reportError=j$;function Z$(t,e=Ie.keywordError,r){let{it:n}=t,{gen:o,compositeRule:s,allErrors:i}=n,a=lm(t,e,r);cm(o,a),s||i||um(n,je.default.vErrors)}Ie.reportExtraError=Z$;function A$(t,e){t.assign(je.default.errors,e),t.if((0,X._)`${je.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,X._)`${je.default.vErrors}.length`,e),()=>t.assign(je.default.vErrors,null)))}Ie.resetErrorsCount=A$;function M$({gen:t,keyword:e,schemaValue:r,data:n,errsCount:o,it:s}){if(o===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",o,je.default.errors,a=>{t.const(i,(0,X._)`${je.default.vErrors}[${a}]`),t.if((0,X._)`${i}.instancePath === undefined`,()=>t.assign((0,X._)`${i}.instancePath`,(0,X.strConcat)(je.default.instancePath,s.errorPath))),t.assign((0,X._)`${i}.schemaPath`,(0,X.str)`${s.errSchemaPath}/${e}`),s.opts.verbose&&(t.assign((0,X._)`${i}.schema`,r),t.assign((0,X._)`${i}.data`,n))})}Ie.extendErrors=M$;function cm(t,e){let r=t.const("err",e);t.if((0,X._)`${je.default.vErrors} === null`,()=>t.assign(je.default.vErrors,(0,X._)`[${r}]`),(0,X._)`${je.default.vErrors}.push(${r})`),t.code((0,X._)`${je.default.errors}++`)}function um(t,e){let{gen:r,validateName:n,schemaEnv:o}=t;o.$async?r.throw((0,X._)`new ${t.ValidationError}(${e})`):(r.assign((0,X._)`${n}.errors`,e),r.return(!1))}var Tr={keyword:new X.Name("keyword"),schemaPath:new X.Name("schemaPath"),params:new X.Name("params"),propertyName:new X.Name("propertyName"),message:new X.Name("message"),schema:new X.Name("schema"),parentSchema:new X.Name("parentSchema")};function lm(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,X._)`{}`:D$(t,e,r)}function D$(t,e,r={}){let{gen:n,it:o}=t,s=[q$(o,r),L$(t,r)];return U$(t,e,s),n.object(...s)}function q$({errorPath:t},{instancePath:e}){let r=e?(0,X.str)`${t}${(0,Os.getErrorPath)(e,Os.Type.Str)}`:t;return[je.default.instancePath,(0,X.strConcat)(je.default.instancePath,r)]}function L$({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let o=n?e:(0,X.str)`${e}/${t}`;return r&&(o=(0,X.str)`${o}${(0,Os.getErrorPath)(r,Os.Type.Str)}`),[Tr.schemaPath,o]}function U$(t,{params:e,message:r},n){let{keyword:o,data:s,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([Tr.keyword,o],[Tr.params,typeof e=="function"?e(t):e||(0,X._)`{}`]),c.messages&&n.push([Tr.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([Tr.schema,i],[Tr.parentSchema,(0,X._)`${l}${d}`],[je.default.data,s]),u&&n.push([Tr.propertyName,u])}});var pm=z(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.boolOrEmptySchema=en.topBoolOrEmptySchema=void 0;var V$=eo(),F$=V(),K$=It(),H$={message:"boolean schema is false"};function B$(t){let{gen:e,schema:r,validateName:n}=t;r===!1?dm(t,!1):typeof r=="object"&&r.$async===!0?e.return(K$.default.data):(e.assign((0,F$._)`${n}.errors`,null),e.return(!0))}en.topBoolOrEmptySchema=B$;function G$(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),dm(t)):r.var(e,!0)}en.boolOrEmptySchema=G$;function dm(t,e){let{gen:r,data:n}=t,o={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,V$.reportError)(o,H$,void 0,e)}});var Su=z(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.getRules=tn.isJSONType=void 0;var J$=["string","number","integer","boolean","null","object","array"],W$=new Set(J$);function X$(t){return typeof t=="string"&&W$.has(t)}tn.isJSONType=X$;function Y$(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}tn.getRules=Y$});var zu=z(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.shouldUseRule=Kt.shouldUseGroup=Kt.schemaHasRulesForType=void 0;function Q$({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&fm(t,n)}Kt.schemaHasRulesForType=Q$;function fm(t,e){return e.rules.some(r=>mm(t,r))}Kt.shouldUseGroup=fm;function mm(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Kt.shouldUseRule=mm});var to=z(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.reportTypeError=Ce.checkDataTypes=Ce.checkDataType=Ce.coerceAndCheckDataType=Ce.getJSONTypes=Ce.getSchemaTypes=Ce.DataType=void 0;var ew=Su(),tw=zu(),rw=eo(),L=V(),hm=Q(),rn;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(rn||(Ce.DataType=rn={}));function nw(t){let e=gm(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Ce.getSchemaTypes=nw;function gm(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(ew.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Ce.getJSONTypes=gm;function ow(t,e){let{gen:r,data:n,opts:o}=t,s=sw(e,o.coerceTypes),i=e.length>0&&!(s.length===0&&e.length===1&&(0,tw.schemaHasRulesForType)(t,e[0]));if(i){let a=Pu(e,n,o.strictNumbers,rn.Wrong);r.if(a,()=>{s.length?iw(t,e,s):Eu(t)})}return i}Ce.coerceAndCheckDataType=ow;var ym=new Set(["string","number","integer","boolean","null"]);function sw(t,e){return e?t.filter(r=>ym.has(r)||e==="array"&&r==="array"):[]}function iw(t,e,r){let{gen:n,data:o,opts:s}=t,i=n.let("dataType",(0,L._)`typeof ${o}`),a=n.let("coerced",(0,L._)`undefined`);s.coerceTypes==="array"&&n.if((0,L._)`${i} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>n.assign(o,(0,L._)`${o}[0]`).assign(i,(0,L._)`typeof ${o}`).if(Pu(e,o,s.strictNumbers),()=>n.assign(a,o))),n.if((0,L._)`${a} !== undefined`);for(let u of r)(ym.has(u)||u==="array"&&s.coerceTypes==="array")&&c(u);n.else(),Eu(t),n.endIf(),n.if((0,L._)`${a} !== undefined`,()=>{n.assign(o,a),aw(t,a)});function c(u){switch(u){case"string":n.elseIf((0,L._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,L._)`"" + ${o}`).elseIf((0,L._)`${o} === null`).assign(a,(0,L._)`""`);return;case"number":n.elseIf((0,L._)`${i} == "boolean" || ${o} === null
              || (${i} == "string" && ${o} && ${o} == +${o})`).assign(a,(0,L._)`+${o}`);return;case"integer":n.elseIf((0,L._)`${i} === "boolean" || ${o} === null
              || (${i} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(a,(0,L._)`+${o}`);return;case"boolean":n.elseIf((0,L._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(a,!1).elseIf((0,L._)`${o} === "true" || ${o} === 1`).assign(a,!0);return;case"null":n.elseIf((0,L._)`${o} === "" || ${o} === 0 || ${o} === false`),n.assign(a,null);return;case"array":n.elseIf((0,L._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${o} === null`).assign(a,(0,L._)`[${o}]`)}}}function aw({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,L._)`${e} !== undefined`,()=>t.assign((0,L._)`${e}[${r}]`,n))}function Tu(t,e,r,n=rn.Correct){let o=n===rn.Correct?L.operators.EQ:L.operators.NEQ,s;switch(t){case"null":return(0,L._)`${e} ${o} null`;case"array":s=(0,L._)`Array.isArray(${e})`;break;case"object":s=(0,L._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=i((0,L._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=i();break;default:return(0,L._)`typeof ${e} ${o} ${t}`}return n===rn.Correct?s:(0,L.not)(s);function i(a=L.nil){return(0,L.and)((0,L._)`typeof ${e} == "number"`,a,r?(0,L._)`isFinite(${e})`:L.nil)}}Ce.checkDataType=Tu;function Pu(t,e,r,n){if(t.length===1)return Tu(t[0],e,r,n);let o,s=(0,hm.toHash)(t);if(s.array&&s.object){let i=(0,L._)`typeof ${e} != "object"`;o=s.null?i:(0,L._)`!${e} || ${i}`,delete s.null,delete s.array,delete s.object}else o=L.nil;s.number&&delete s.integer;for(let i in s)o=(0,L.and)(o,Tu(i,e,r,n));return o}Ce.checkDataTypes=Pu;var cw={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,L._)`{type: ${t}}`:(0,L._)`{type: ${e}}`};function Eu(t){let e=uw(t);(0,rw.reportError)(e,cw)}Ce.reportTypeError=Eu;function uw(t){let{gen:e,data:r,schema:n}=t,o=(0,hm.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:o,schemaValue:o,parentSchema:n,params:{},it:t}}});var vm=z(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});js.assignDefaults=void 0;var nn=V(),lw=Q();function dw(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let o in r)_m(t,o,r[o].default);else e==="array"&&Array.isArray(n)&&n.forEach((o,s)=>_m(t,s,o.default))}js.assignDefaults=dw;function _m(t,e,r){let{gen:n,compositeRule:o,data:s,opts:i}=t;if(r===void 0)return;let a=(0,nn._)`${s}${(0,nn.getProperty)(e)}`;if(o){(0,lw.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,nn._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,nn._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,nn._)`${a} = ${(0,nn.stringify)(r)}`)}});var tt=z(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.validateUnion=re.validateArray=re.usePattern=re.callValidateCode=re.schemaProperties=re.allSchemaProperties=re.noPropertyInData=re.propertyInData=re.isOwnProperty=re.hasPropFunc=re.reportMissingProp=re.checkMissingProp=re.checkReportMissingProp=void 0;var ae=V(),Iu=Q(),Ht=It(),pw=Q();function fw(t,e){let{gen:r,data:n,it:o}=t;r.if(Ru(r,n,e,o.opts.ownProperties),()=>{t.setParams({missingProperty:(0,ae._)`${e}`},!0),t.error()})}re.checkReportMissingProp=fw;function mw({gen:t,data:e,it:{opts:r}},n,o){return(0,ae.or)(...n.map(s=>(0,ae.and)(Ru(t,e,s,r.ownProperties),(0,ae._)`${o} = ${s}`)))}re.checkMissingProp=mw;function hw(t,e){t.setParams({missingProperty:e},!0),t.error()}re.reportMissingProp=hw;function xm(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,ae._)`Object.prototype.hasOwnProperty`})}re.hasPropFunc=xm;function Cu(t,e,r){return(0,ae._)`${xm(t)}.call(${e}, ${r})`}re.isOwnProperty=Cu;function gw(t,e,r,n){let o=(0,ae._)`${e}${(0,ae.getProperty)(r)} !== undefined`;return n?(0,ae._)`${o} && ${Cu(t,e,r)}`:o}re.propertyInData=gw;function Ru(t,e,r,n){let o=(0,ae._)`${e}${(0,ae.getProperty)(r)} === undefined`;return n?(0,ae.or)(o,(0,ae.not)(Cu(t,e,r))):o}re.noPropertyInData=Ru;function bm(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}re.allSchemaProperties=bm;function yw(t,e){return bm(e).filter(r=>!(0,Iu.alwaysValidSchema)(t,e[r]))}re.schemaProperties=yw;function _w({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:o,errorPath:s},it:i},a,c,u){let l=u?(0,ae._)`${t}, ${e}, ${n}${o}`:e,d=[[Ht.default.instancePath,(0,ae.strConcat)(Ht.default.instancePath,s)],[Ht.default.parentData,i.parentData],[Ht.default.parentDataProperty,i.parentDataProperty],[Ht.default.rootData,Ht.default.rootData]];i.opts.dynamicRef&&d.push([Ht.default.dynamicAnchors,Ht.default.dynamicAnchors]);let h=(0,ae._)`${l}, ${r.object(...d)}`;return c!==ae.nil?(0,ae._)`${a}.call(${c}, ${h})`:(0,ae._)`${a}(${h})`}re.callValidateCode=_w;var vw=(0,ae._)`new RegExp`;function xw({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:o}=e.code,s=o(r,n);return t.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,ae._)`${o.code==="new RegExp"?vw:(0,pw.useFunc)(t,o)}(${r}, ${n})`})}re.usePattern=xw;function bw(t){let{gen:e,data:r,keyword:n,it:o}=t,s=e.name("valid");if(o.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(s,!0),i(()=>e.break()),s;function i(a){let c=e.const("len",(0,ae._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:Iu.Type.Num},s),e.if((0,ae.not)(s),a)})}}re.validateArray=bw;function $w(t){let{gen:e,schema:r,keyword:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,Iu.alwaysValidSchema)(o,c))&&!o.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,ae._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,ae.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}re.validateUnion=$w});var km=z(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.validateKeywordUsage=yt.validSchemaType=yt.funcKeywordCode=yt.macroKeywordCode=void 0;var Ze=V(),Pr=It(),ww=tt(),kw=eo();function Sw(t,e){let{gen:r,keyword:n,schema:o,parentSchema:s,it:i}=t,a=e.macro.call(i.self,o,s,i),c=wm(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:Ze.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}yt.macroKeywordCode=Sw;function zw(t,e){var r;let{gen:n,keyword:o,schema:s,parentSchema:i,$data:a,it:c}=t;Pw(c,e);let u=!a&&e.compile?e.compile.call(c.self,s,i,c):e.validate,l=wm(n,o,u),d=n.let("valid");t.block$data(d,h),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function h(){if(e.errors===!1)m(),e.modifying&&$m(t),g(()=>t.error());else{let v=e.async?f():p();e.modifying&&$m(t),g(()=>Tw(t,v))}}function f(){let v=n.let("ruleErrs",null);return n.try(()=>m((0,Ze._)`await `),x=>n.assign(d,!1).if((0,Ze._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(v,(0,Ze._)`${x}.errors`),()=>n.throw(x))),v}function p(){let v=(0,Ze._)`${l}.errors`;return n.assign(v,null),m(Ze.nil),v}function m(v=e.async?(0,Ze._)`await `:Ze.nil){let x=c.opts.passContext?Pr.default.this:Pr.default.self,b=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,Ze._)`${v}${(0,ww.callValidateCode)(t,l,x,b)}`,e.modifying)}function g(v){var x;n.if((0,Ze.not)((x=e.valid)!==null&&x!==void 0?x:d),v)}}yt.funcKeywordCode=zw;function $m(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Ze._)`${n.parentData}[${n.parentDataProperty}]`))}function Tw(t,e){let{gen:r}=t;r.if((0,Ze._)`Array.isArray(${e})`,()=>{r.assign(Pr.default.vErrors,(0,Ze._)`${Pr.default.vErrors} === null ? ${e} : ${Pr.default.vErrors}.concat(${e})`).assign(Pr.default.errors,(0,Ze._)`${Pr.default.vErrors}.length`),(0,kw.extendErrors)(t)},()=>t.error())}function Pw({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function wm(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Ze.stringify)(r)})}function Ew(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}yt.validSchemaType=Ew;function Iw({schema:t,opts:e,self:r,errSchemaPath:n},o,s){if(Array.isArray(o.keyword)?!o.keyword.includes(s):o.keyword!==s)throw new Error("ajv implementation error");let i=o.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${s}: ${i.join(",")}`);if(o.validateSchema&&!o.validateSchema(t[s])){let c=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(o.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}yt.validateKeywordUsage=Iw});var zm=z(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.extendSubschemaMode=Bt.extendSubschemaData=Bt.getSubschema=void 0;var _t=V(),Sm=Q();function Cw(t,{keyword:e,schemaProp:r,schema:n,schemaPath:o,errSchemaPath:s,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,_t._)`${t.schemaPath}${(0,_t.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,_t._)`${t.schemaPath}${(0,_t.getProperty)(e)}${(0,_t.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,Sm.escapeFragment)(r)}`}}if(n!==void 0){if(o===void 0||s===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:o,topSchemaRef:i,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}Bt.getSubschema=Cw;function Rw(t,e,{dataProp:r,dataPropType:n,data:o,dataTypes:s,propertyName:i}){if(o!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,h=a.let("data",(0,_t._)`${e.data}${(0,_t.getProperty)(r)}`,!0);c(h),t.errorPath=(0,_t.str)`${u}${(0,Sm.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,_t._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(o!==void 0){let u=o instanceof _t.Name?o:a.let("data",o,!0);c(u),i!==void 0&&(t.propertyName=i)}s&&(t.dataTypes=s);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Bt.extendSubschemaData=Rw;function Nw(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:o,allErrors:s}){n!==void 0&&(t.compositeRule=n),o!==void 0&&(t.createErrors=o),s!==void 0&&(t.allErrors=s),t.jtdDiscriminator=e,t.jtdMetadata=r}Bt.extendSubschemaMode=Nw});var Nu=z((qR,Tm)=>{"use strict";Tm.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var i=s[o];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var Em=z((LR,Pm)=>{"use strict";var Gt=Pm.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},o=r.post||function(){};Zs(e,n,o,t,"",t)};Gt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Gt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Gt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Gt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Zs(t,e,r,n,o,s,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,o,s,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Gt.arrayKeywords)for(var h=0;h<d.length;h++)Zs(t,e,r,d[h],o+"/"+l+"/"+h,s,o,l,n,h)}else if(l in Gt.propsKeywords){if(d&&typeof d=="object")for(var f in d)Zs(t,e,r,d[f],o+"/"+l+"/"+Ow(f),s,o,l,n,f)}else(l in Gt.keywords||t.allKeys&&!(l in Gt.skipKeywords))&&Zs(t,e,r,d,o+"/"+l,s,o,l,n)}r(n,o,s,i,a,c,u)}}function Ow(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var ro=z(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.getSchemaRefs=Ve.resolveUrl=Ve.normalizeId=Ve._getFullPath=Ve.getFullPath=Ve.inlineRef=void 0;var jw=Q(),Zw=Nu(),Aw=Em(),Mw=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function Dw(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Ou(t):e?Im(t)<=e:!1}Ve.inlineRef=Dw;var qw=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Ou(t){for(let e in t){if(qw.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Ou)||typeof r=="object"&&Ou(r))return!0}return!1}function Im(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!Mw.has(r)&&(typeof t[r]=="object"&&(0,jw.eachItem)(t[r],n=>e+=Im(n)),e===1/0))return 1/0}return e}function Cm(t,e="",r){r!==!1&&(e=on(e));let n=t.parse(e);return Rm(t,n)}Ve.getFullPath=Cm;function Rm(t,e){return t.serialize(e).split("#")[0]+"#"}Ve._getFullPath=Rm;var Lw=/#\/?$/;function on(t){return t?t.replace(Lw,""):""}Ve.normalizeId=on;function Uw(t,e,r){return r=on(r),t.resolve(e,r)}Ve.resolveUrl=Uw;var Vw=/^[a-z_][-a-z0-9._]*$/i;function Fw(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,o=on(t[r]||e),s={"":o},i=Cm(n,o,!1),a={},c=new Set;return Aw(t,{allKeys:!0},(d,h,f,p)=>{if(p===void 0)return;let m=i+h,g=s[p];typeof d[r]=="string"&&(g=v.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),s[h]=g;function v(b){let k=this.opts.uriResolver.resolve;if(b=on(g?k(g,b):b),c.has(b))throw l(b);c.add(b);let N=this.refs[b];return typeof N=="string"&&(N=this.refs[N]),typeof N=="object"?u(d,N.schema,b):b!==on(m)&&(b[0]==="#"?(u(d,a[b],b),a[b]=d):this.refs[b]=m),b}function x(b){if(typeof b=="string"){if(!Vw.test(b))throw new Error(`invalid anchor "${b}"`);v.call(this,`#${b}`)}}}),a;function u(d,h,f){if(h!==void 0&&!Zw(d,h))throw l(f)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}Ve.getSchemaRefs=Fw});var so=z(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.getData=Jt.KeywordCxt=Jt.validateFunctionCode=void 0;var Am=pm(),Nm=to(),Zu=zu(),As=to(),Kw=vm(),oo=km(),ju=zm(),R=V(),D=It(),Hw=ro(),Ct=Q(),no=eo();function Bw(t){if(qm(t)&&(Lm(t),Dm(t))){Ww(t);return}Mm(t,()=>(0,Am.topBoolOrEmptySchema)(t))}Jt.validateFunctionCode=Bw;function Mm({gen:t,validateName:e,schema:r,schemaEnv:n,opts:o},s){o.code.es5?t.func(e,(0,R._)`${D.default.data}, ${D.default.valCxt}`,n.$async,()=>{t.code((0,R._)`"use strict"; ${Om(r,o)}`),Jw(t,o),t.code(s)}):t.func(e,(0,R._)`${D.default.data}, ${Gw(o)}`,n.$async,()=>t.code(Om(r,o)).code(s))}function Gw(t){return(0,R._)`{${D.default.instancePath}="", ${D.default.parentData}, ${D.default.parentDataProperty}, ${D.default.rootData}=${D.default.data}${t.dynamicRef?(0,R._)`, ${D.default.dynamicAnchors}={}`:R.nil}}={}`}function Jw(t,e){t.if(D.default.valCxt,()=>{t.var(D.default.instancePath,(0,R._)`${D.default.valCxt}.${D.default.instancePath}`),t.var(D.default.parentData,(0,R._)`${D.default.valCxt}.${D.default.parentData}`),t.var(D.default.parentDataProperty,(0,R._)`${D.default.valCxt}.${D.default.parentDataProperty}`),t.var(D.default.rootData,(0,R._)`${D.default.valCxt}.${D.default.rootData}`),e.dynamicRef&&t.var(D.default.dynamicAnchors,(0,R._)`${D.default.valCxt}.${D.default.dynamicAnchors}`)},()=>{t.var(D.default.instancePath,(0,R._)`""`),t.var(D.default.parentData,(0,R._)`undefined`),t.var(D.default.parentDataProperty,(0,R._)`undefined`),t.var(D.default.rootData,D.default.data),e.dynamicRef&&t.var(D.default.dynamicAnchors,(0,R._)`{}`)})}function Ww(t){let{schema:e,opts:r,gen:n}=t;Mm(t,()=>{r.$comment&&e.$comment&&Vm(t),t0(t),n.let(D.default.vErrors,null),n.let(D.default.errors,0),r.unevaluated&&Xw(t),Um(t),o0(t)})}function Xw(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,R._)`${r}.evaluated`),e.if((0,R._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,R._)`${t.evaluated}.props`,(0,R._)`undefined`)),e.if((0,R._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,R._)`${t.evaluated}.items`,(0,R._)`undefined`))}function Om(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,R._)`/*# sourceURL=${r} */`:R.nil}function Yw(t,e){if(qm(t)&&(Lm(t),Dm(t))){Qw(t,e);return}(0,Am.boolOrEmptySchema)(t,e)}function Dm({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function qm(t){return typeof t.schema!="boolean"}function Qw(t,e){let{schema:r,gen:n,opts:o}=t;o.$comment&&r.$comment&&Vm(t),r0(t),n0(t);let s=n.const("_errs",D.default.errors);Um(t,s),n.var(e,(0,R._)`${s} === ${D.default.errors}`)}function Lm(t){(0,Ct.checkUnknownRules)(t),e0(t)}function Um(t,e){if(t.opts.jtd)return jm(t,[],!1,e);let r=(0,Nm.getSchemaTypes)(t.schema),n=(0,Nm.coerceAndCheckDataType)(t,r);jm(t,r,!n,e)}function e0(t){let{schema:e,errSchemaPath:r,opts:n,self:o}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,Ct.schemaHasRulesButRef)(e,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function t0(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Ct.checkStrictMode)(t,"default is ignored in the schema root")}function r0(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,Hw.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function n0(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function Vm({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:o}){let s=r.$comment;if(o.$comment===!0)t.code((0,R._)`${D.default.self}.logger.log(${s})`);else if(typeof o.$comment=="function"){let i=(0,R.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,R._)`${D.default.self}.opts.$comment(${s}, ${i}, ${a}.schema)`)}}function o0(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:o,opts:s}=t;r.$async?e.if((0,R._)`${D.default.errors} === 0`,()=>e.return(D.default.data),()=>e.throw((0,R._)`new ${o}(${D.default.vErrors})`)):(e.assign((0,R._)`${n}.errors`,D.default.vErrors),s.unevaluated&&s0(t),e.return((0,R._)`${D.default.errors} === 0`))}function s0({gen:t,evaluated:e,props:r,items:n}){r instanceof R.Name&&t.assign((0,R._)`${e}.props`,r),n instanceof R.Name&&t.assign((0,R._)`${e}.items`,n)}function jm(t,e,r,n){let{gen:o,schema:s,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(s.$ref&&(c.ignoreKeywordsWithRef||!(0,Ct.schemaHasRulesButRef)(s,l))){o.block(()=>Km(t,"$ref",l.all.$ref.definition));return}c.jtd||i0(t,e),o.block(()=>{for(let h of l.rules)d(h);d(l.post)});function d(h){(0,Zu.shouldUseGroup)(s,h)&&(h.type?(o.if((0,As.checkDataType)(h.type,i,c.strictNumbers)),Zm(t,h),e.length===1&&e[0]===h.type&&r&&(o.else(),(0,As.reportTypeError)(t)),o.endIf()):Zm(t,h),a||o.if((0,R._)`${D.default.errors} === ${n||0}`))}}function Zm(t,e){let{gen:r,schema:n,opts:{useDefaults:o}}=t;o&&(0,Kw.assignDefaults)(t,e.type),r.block(()=>{for(let s of e.rules)(0,Zu.shouldUseRule)(n,s)&&Km(t,s.keyword,s.definition,e.type)})}function i0(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(a0(t,e),t.opts.allowUnionTypes||c0(t,e),u0(t,t.dataTypes))}function a0(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{Fm(t.dataTypes,r)||Au(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),d0(t,e)}}function c0(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Au(t,"use allowUnionTypes to allow union type keyword")}function u0(t,e){let r=t.self.RULES.all;for(let n in r){let o=r[n];if(typeof o=="object"&&(0,Zu.shouldUseRule)(t.schema,o)){let{type:s}=o.definition;s.length&&!s.some(i=>l0(e,i))&&Au(t,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function l0(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function Fm(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function d0(t,e){let r=[];for(let n of t.dataTypes)Fm(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function Au(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Ct.checkStrictMode)(t,e,t.opts.strictTypes)}var Ms=class{constructor(e,r,n){if((0,oo.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Ct.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",Hm(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,oo.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",D.default.errors))}result(e,r,n){this.failResult((0,R.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,R.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,R._)`${r} !== undefined && (${(0,R.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?no.reportExtraError:no.reportError)(this,this.def.error,r)}$dataError(){(0,no.reportError)(this,this.def.$dataError||no.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,no.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=R.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=R.nil,r=R.nil){if(!this.$data)return;let{gen:n,schemaCode:o,schemaType:s,def:i}=this;n.if((0,R.or)((0,R._)`${o} === undefined`,r)),e!==R.nil&&n.assign(e,!0),(s.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==R.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:o,it:s}=this;return(0,R.or)(i(),a());function i(){if(n.length){if(!(r instanceof R.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,R._)`${(0,As.checkDataTypes)(c,r,s.opts.strictNumbers,As.DataType.Wrong)}`}return R.nil}function a(){if(o.validateSchema){let c=e.scopeValue("validate$data",{ref:o.validateSchema});return(0,R._)`!${c}(${r})`}return R.nil}}subschema(e,r){let n=(0,ju.getSubschema)(this.it,e);(0,ju.extendSubschemaData)(n,this.it,e),(0,ju.extendSubschemaMode)(n,e);let o={...this.it,...n,items:void 0,props:void 0};return Yw(o,r),o}mergeEvaluated(e,r){let{it:n,gen:o}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=Ct.mergeEvaluated.props(o,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=Ct.mergeEvaluated.items(o,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:o}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return o.if(r,()=>this.mergeEvaluated(e,R.Name)),!0}};Jt.KeywordCxt=Ms;function Km(t,e,r,n){let o=new Ms(t,r,e);"code"in r?r.code(o,n):o.$data&&r.validate?(0,oo.funcKeywordCode)(o,r):"macro"in r?(0,oo.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,oo.funcKeywordCode)(o,r)}var p0=/^\/(?:[^~]|~0|~1)*$/,f0=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Hm(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let o,s;if(t==="")return D.default.rootData;if(t[0]==="/"){if(!p0.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);o=t,s=D.default.rootData}else{let u=f0.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(o=u[2],o==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(s=r[e-l],!o)return s}let i=s,a=o.split("/");for(let u of a)u&&(s=(0,R._)`${s}${(0,R.getProperty)((0,Ct.unescapeJsonPointer)(u))}`,i=(0,R._)`${i} && ${s}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}Jt.getData=Hm});var Ds=z(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});var Mu=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Du.default=Mu});var io=z(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});var qu=ro(),Lu=class extends Error{constructor(e,r,n,o){super(o||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,qu.resolveUrl)(e,r,n),this.missingSchema=(0,qu.normalizeId)((0,qu.getFullPath)(e,this.missingRef))}};Uu.default=Lu});var Ls=z(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});rt.resolveSchema=rt.getCompilingSchema=rt.resolveRef=rt.compileSchema=rt.SchemaEnv=void 0;var ut=V(),m0=Ds(),Er=It(),lt=ro(),Bm=Q(),h0=so(),sn=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,lt.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};rt.SchemaEnv=sn;function Fu(t){let e=Gm.call(this,t);if(e)return e;let r=(0,lt.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:o}=this.opts.code,{ownProperties:s}=this.opts,i=new ut.CodeGen(this.scope,{es5:n,lines:o,ownProperties:s}),a;t.$async&&(a=i.scopeValue("Error",{ref:m0.default,code:(0,ut._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:Er.default.data,parentData:Er.default.parentData,parentDataProperty:Er.default.parentDataProperty,dataNames:[Er.default.data],dataPathArr:[ut.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,ut.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:ut.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,ut._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,h0.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(Er.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let f=new Function(`${Er.default.self}`,`${Er.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:p,items:m}=u;f.evaluated={props:p instanceof ut.Name?void 0:p,items:m instanceof ut.Name?void 0:m,dynamicProps:p instanceof ut.Name,dynamicItems:m instanceof ut.Name},f.source&&(f.source.evaluated=(0,ut.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}rt.compileSchema=Fu;function g0(t,e,r){var n;r=(0,lt.resolveUrl)(this.opts.uriResolver,e,r);let o=t.refs[r];if(o)return o;let s=v0.call(this,t,r);if(s===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(s=new sn({schema:i,schemaId:a,root:t,baseId:e}))}if(s!==void 0)return t.refs[r]=y0.call(this,s)}rt.resolveRef=g0;function y0(t){return(0,lt.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Fu.call(this,t)}function Gm(t){for(let e of this._compilations)if(_0(e,t))return e}rt.getCompilingSchema=Gm;function _0(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function v0(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||qs.call(this,t,e)}function qs(t,e){let r=this.opts.uriResolver.parse(e),n=(0,lt._getFullPath)(this.opts.uriResolver,r),o=(0,lt.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===o)return Vu.call(this,r,t);let s=(0,lt.normalizeId)(n),i=this.refs[s]||this.schemas[s];if(typeof i=="string"){let a=qs.call(this,t,i);return typeof a?.schema!="object"?void 0:Vu.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Fu.call(this,i),s===(0,lt.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(o=(0,lt.resolveUrl)(this.opts.uriResolver,o,u)),new sn({schema:a,schemaId:c,root:t,baseId:o})}return Vu.call(this,r,i)}}rt.resolveSchema=qs;var x0=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Vu(t,{baseId:e,schema:r,root:n}){var o;if(((o=t.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,Bm.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!x0.has(a)&&u&&(e=(0,lt.resolveUrl)(this.opts.uriResolver,e,u))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,Bm.schemaHasRulesButRef)(r,this.RULES)){let a=(0,lt.resolveUrl)(this.opts.uriResolver,e,r.$ref);s=qs.call(this,n,a)}let{schemaId:i}=this.opts;if(s=s||new sn({schema:r,schemaId:i,root:n,baseId:e}),s.schema!==s.root.schema)return s}});var Jm=z((BR,b0)=>{b0.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Hu=z((GR,Qm)=>{"use strict";var $0=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),Xm=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Ku(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var w0=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function Wm(t){return t.length=0,!0}function k0(t,e,r){if(t.length){let n=Ku(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function S0(t){let e=0,r={error:!1,address:"",zone:""},n=[],o=[],s=!1,i=!1,a=k0;for(let c=0;c<t.length;c++){let u=t[c];if(!(u==="["||u==="]"))if(u===":"){if(s===!0&&(i=!0),!a(o,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(s=!0),n.push(":");continue}else if(u==="%"){if(!a(o,n,r))break;a=Wm}else{o.push(u);continue}}return o.length&&(a===Wm?r.zone=o.join(""):i?n.push(o.join("")):n.push(Ku(o))),r.address=n.join(""),r}function Ym(t){if(z0(t,":")<2)return{host:t,isIPV6:!1};let e=S0(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function z0(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function T0(t){let e=t,r=[],n=-1,o=0;for(;o=e.length;){if(o===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(o===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(o===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function P0(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function E0(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!Xm(r)){let n=Ym(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}Qm.exports={nonSimpleDomain:w0,recomposeAuthority:E0,normalizeComponentEncoding:P0,removeDotSegments:T0,isIPv4:Xm,isUUID:$0,normalizeIPv6:Ym,stringArrayToHexStripped:Ku}});var oh=z((JR,nh)=>{"use strict";var{isUUID:I0}=Hu(),C0=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,R0=["http","https","ws","wss","urn","urn:uuid"];function N0(t){return R0.indexOf(t)!==-1}function Bu(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function eh(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function th(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function O0(t){return t.secure=Bu(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function j0(t){if((t.port===(Bu(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function Z0(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(C0);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let o=`${n}:${e.nid||t.nid}`,s=Gu(o);t.path=void 0,s&&(t=s.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function A0(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),o=`${r}:${e.nid||n}`,s=Gu(o);s&&(t=s.serialize(t,e));let i=t,a=t.nss;return i.path=`${n||e.nid}:${a}`,e.skipEscape=!0,i}function M0(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!I0(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function D0(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var rh={scheme:"http",domainHost:!0,parse:eh,serialize:th},q0={scheme:"https",domainHost:rh.domainHost,parse:eh,serialize:th},Us={scheme:"ws",domainHost:!0,parse:O0,serialize:j0},L0={scheme:"wss",domainHost:Us.domainHost,parse:Us.parse,serialize:Us.serialize},U0={scheme:"urn",parse:Z0,serialize:A0,skipNormalize:!0},V0={scheme:"urn:uuid",parse:M0,serialize:D0,skipNormalize:!0},Vs={http:rh,https:q0,ws:Us,wss:L0,urn:U0,"urn:uuid":V0};Object.setPrototypeOf(Vs,null);function Gu(t){return t&&(Vs[t]||Vs[t.toLowerCase()])||void 0}nh.exports={wsIsSecure:Bu,SCHEMES:Vs,isValidSchemeName:N0,getSchemeHandler:Gu}});var ah=z((WR,Ks)=>{"use strict";var{normalizeIPv6:F0,removeDotSegments:ao,recomposeAuthority:K0,normalizeComponentEncoding:Fs,isIPv4:H0,nonSimpleDomain:B0}=Hu(),{SCHEMES:G0,getSchemeHandler:sh}=oh();function J0(t,e){return typeof t=="string"?t=vt(Rt(t,e),e):typeof t=="object"&&(t=Rt(vt(t,e),e)),t}function W0(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},o=ih(Rt(t,n),Rt(e,n),n,!0);return n.skipEscape=!0,vt(o,n)}function ih(t,e,r,n){let o={};return n||(t=Rt(vt(t,r),r),e=Rt(vt(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(o.scheme=e.scheme,o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=ao(e.path||""),o.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=ao(e.path||""),o.query=e.query):(e.path?(e.path[0]==="/"?o.path=ao(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?o.path="/"+e.path:t.path?o.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:o.path=e.path,o.path=ao(o.path)),o.query=e.query):(o.path=t.path,e.query!==void 0?o.query=e.query:o.query=t.query),o.userinfo=t.userinfo,o.host=t.host,o.port=t.port),o.scheme=t.scheme),o.fragment=e.fragment,o}function X0(t,e,r){return typeof t=="string"?(t=unescape(t),t=vt(Fs(Rt(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=vt(Fs(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=vt(Fs(Rt(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=vt(Fs(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function vt(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),o=[],s=sh(n.scheme||r.scheme);s&&s.serialize&&s.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&o.push(r.scheme,":");let i=K0(r);if(i!==void 0&&(n.reference!=="suffix"&&o.push("//"),o.push(i),r.path&&r.path[0]!=="/"&&o.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!s||!s.absolutePath)&&(a=ao(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),o.push(a)}return r.query!==void 0&&o.push("?",r.query),r.fragment!==void 0&&o.push("#",r.fragment),o.join("")}var Y0=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Rt(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},o=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let s=t.match(Y0);if(s){if(n.scheme=s[1],n.userinfo=s[3],n.host=s[4],n.port=parseInt(s[5],10),n.path=s[6]||"",n.query=s[7],n.fragment=s[8],isNaN(n.port)&&(n.port=s[5]),n.host)if(H0(n.host)===!1){let c=F0(n.host);n.host=c.host.toLowerCase(),o=c.isIPV6}else o=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=sh(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&o===!1&&B0(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Ju={SCHEMES:G0,normalize:J0,resolve:W0,resolveComponent:ih,equal:X0,serialize:vt,parse:Rt};Ks.exports=Ju;Ks.exports.default=Ju;Ks.exports.fastUri=Ju});var uh=z(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});var ch=ah();ch.code='require("ajv/dist/runtime/uri").default';Wu.default=ch});var yh=z(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});ze.CodeGen=ze.Name=ze.nil=ze.stringify=ze.str=ze._=ze.KeywordCxt=void 0;var Q0=so();Object.defineProperty(ze,"KeywordCxt",{enumerable:!0,get:function(){return Q0.KeywordCxt}});var an=V();Object.defineProperty(ze,"_",{enumerable:!0,get:function(){return an._}});Object.defineProperty(ze,"str",{enumerable:!0,get:function(){return an.str}});Object.defineProperty(ze,"stringify",{enumerable:!0,get:function(){return an.stringify}});Object.defineProperty(ze,"nil",{enumerable:!0,get:function(){return an.nil}});Object.defineProperty(ze,"Name",{enumerable:!0,get:function(){return an.Name}});Object.defineProperty(ze,"CodeGen",{enumerable:!0,get:function(){return an.CodeGen}});var ek=Ds(),mh=io(),tk=Su(),co=Ls(),rk=V(),uo=ro(),Hs=to(),Yu=Q(),lh=Jm(),nk=uh(),hh=(t,e)=>new RegExp(t,e);hh.code="new RegExp";var ok=["removeAdditional","useDefaults","coerceTypes"],sk=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),ik={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},ak={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},dh=200;function ck(t){var e,r,n,o,s,i,a,c,u,l,d,h,f,p,m,g,v,x,b,k,N,he,xe,Ge,gn;let Qt=t.strict,yn=(e=t.code)===null||e===void 0?void 0:e.optimize,ko=yn===!0||yn===void 0?1:yn||0,_n=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:hh,ay=(o=t.uriResolver)!==null&&o!==void 0?o:nk.default;return{strictSchema:(i=(s=t.strictSchema)!==null&&s!==void 0?s:Qt)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:Qt)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:Qt)!==null&&l!==void 0?l:"log",strictTuples:(h=(d=t.strictTuples)!==null&&d!==void 0?d:Qt)!==null&&h!==void 0?h:"log",strictRequired:(p=(f=t.strictRequired)!==null&&f!==void 0?f:Qt)!==null&&p!==void 0?p:!1,code:t.code?{...t.code,optimize:ko,regExp:_n}:{optimize:ko,regExp:_n},loopRequired:(m=t.loopRequired)!==null&&m!==void 0?m:dh,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:dh,meta:(v=t.meta)!==null&&v!==void 0?v:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:(b=t.inlineRefs)!==null&&b!==void 0?b:!0,schemaId:(k=t.schemaId)!==null&&k!==void 0?k:"$id",addUsedSchema:(N=t.addUsedSchema)!==null&&N!==void 0?N:!0,validateSchema:(he=t.validateSchema)!==null&&he!==void 0?he:!0,validateFormats:(xe=t.validateFormats)!==null&&xe!==void 0?xe:!0,unicodeRegExp:(Ge=t.unicodeRegExp)!==null&&Ge!==void 0?Ge:!0,int32range:(gn=t.int32range)!==null&&gn!==void 0?gn:!0,uriResolver:ay}}var lo=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...ck(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new rk.ValueScope({scope:{},prefixes:sk,es5:r,lines:n}),this.logger=mk(e.logger);let o=e.validateFormats;e.validateFormats=!1,this.RULES=(0,tk.getRules)(),ph.call(this,ik,e,"NOT SUPPORTED"),ph.call(this,ak,e,"DEPRECATED","warn"),this._metaOpts=pk.call(this),e.formats&&lk.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&dk.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),uk.call(this),e.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,o=lh;n==="id"&&(o={...lh},o.id=o.$id,delete o.$id),r&&e&&this.addMetaSchema(o,o[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let o=n(r);return"$async"in n||(this.errors=n.errors),o}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return o.call(this,e,r);async function o(l,d){await s.call(this,l.$schema);let h=this._addSchema(l,d);return h.validate||i.call(this,h)}async function s(l){l&&!this.getSchema(l)&&await o.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof mh.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await s.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,o=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,o);return this}let s;if(typeof e=="object"){let{schemaId:i}=this.opts;if(s=e[i],s!==void 0&&typeof s!="string")throw new Error(`schema ${i} must be string`)}return r=(0,uo.normalizeId)(r||s),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,o,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let o=this.validate(n,e);if(!o&&r){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return o}getSchema(e){let r;for(;typeof(r=fh.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,o=new co.SchemaEnv({schema:{},schemaId:n});if(r=co.resolveSchema.call(this,o,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=fh.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,uo.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(gk.call(this,n,r),!r)return(0,Yu.eachItem)(n,s=>Xu.call(this,s)),this;_k.call(this,r);let o={...r,type:(0,Hs.getJSONTypes)(r.type),schemaType:(0,Hs.getJSONTypes)(r.schemaType)};return(0,Yu.eachItem)(n,o.type.length===0?s=>Xu.call(this,s,o):s=>o.type.forEach(i=>Xu.call(this,s,o,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let o=n.rules.findIndex(s=>s.keyword===e);o>=0&&n.rules.splice(o,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(o=>`${n}${o.instancePath} ${o.message}`).reduce((o,s)=>o+r+s)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let o of r){let s=o.split("/").slice(1),i=e;for(let a of s)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=gh(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let o=e[n];(!r||r.test(n))&&(typeof o=="string"?delete e[n]:o&&!o.meta&&(this._cache.delete(o.schema),delete e[n]))}}_addSchema(e,r,n,o=this.opts.validateSchema,s=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,uo.normalizeId)(i||n);let u=uo.getSchemaRefs.call(this,e,n);return c=new co.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),s&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),o&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):co.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{co.compileSchema.call(this,e)}finally{this.opts=r}}};lo.ValidationError=ek.default;lo.MissingRefError=mh.default;ze.default=lo;function ph(t,e,r,n="error"){for(let o in t){let s=o;s in e&&this.logger[n](`${r}: option ${o}. ${t[s]}`)}}function fh(t){return t=(0,uo.normalizeId)(t),this.schemas[t]||this.refs[t]}function uk(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function lk(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function dk(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function pk(){let t={...this.opts};for(let e of ok)delete t[e];return t}var fk={log(){},warn(){},error(){}};function mk(t){if(t===!1)return fk;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var hk=/^[a-z_$][a-z0-9_$:-]*$/i;function gk(t,e){let{RULES:r}=this;if((0,Yu.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!hk.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Xu(t,e,r){var n;let o=e?.post;if(r&&o)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,i=o?s.post:s.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},s.rules.push(i)),s.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Hs.getJSONTypes)(e.type),schemaType:(0,Hs.getJSONTypes)(e.schemaType)}};e.before?yk.call(this,i,a,e.before):i.rules.push(a),s.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function yk(t,e,r){let n=t.rules.findIndex(o=>o.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function _k(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=gh(e)),t.validateSchema=this.compile(e,!0))}var vk={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function gh(t){return{anyOf:[t,vk]}}});var _h=z(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});var xk={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Qu.default=xk});var $h=z(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.callRef=Ir.getValidate=void 0;var bk=io(),vh=tt(),Fe=V(),cn=It(),xh=Ls(),Bs=Q(),$k={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:o,schemaEnv:s,validateName:i,opts:a,self:c}=n,{root:u}=s;if((r==="#"||r==="#/")&&o===u.baseId)return d();let l=xh.resolveRef.call(c,u,o,r);if(l===void 0)throw new bk.default(n.opts.uriResolver,o,r);if(l instanceof xh.SchemaEnv)return h(l);return f(l);function d(){if(s===u)return Gs(t,i,s,s.$async);let p=e.scopeValue("root",{ref:u});return Gs(t,(0,Fe._)`${p}.validate`,u,u.$async)}function h(p){let m=bh(t,p);Gs(t,m,p,p.$async)}function f(p){let m=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,Fe.stringify)(p)}:{ref:p}),g=e.name("valid"),v=t.subschema({schema:p,dataTypes:[],schemaPath:Fe.nil,topSchemaRef:m,errSchemaPath:r},g);t.mergeEvaluated(v),t.ok(g)}}};function bh(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,Fe._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Ir.getValidate=bh;function Gs(t,e,r,n){let{gen:o,it:s}=t,{allErrors:i,schemaEnv:a,opts:c}=s,u=c.passContext?cn.default.this:Fe.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let p=o.let("valid");o.try(()=>{o.code((0,Fe._)`await ${(0,vh.callValidateCode)(t,e,u)}`),f(e),i||o.assign(p,!0)},m=>{o.if((0,Fe._)`!(${m} instanceof ${s.ValidationError})`,()=>o.throw(m)),h(m),i||o.assign(p,!1)}),t.ok(p)}function d(){t.result((0,vh.callValidateCode)(t,e,u),()=>f(e),()=>h(e))}function h(p){let m=(0,Fe._)`${p}.errors`;o.assign(cn.default.vErrors,(0,Fe._)`${cn.default.vErrors} === null ? ${m} : ${cn.default.vErrors}.concat(${m})`),o.assign(cn.default.errors,(0,Fe._)`${cn.default.vErrors}.length`)}function f(p){var m;if(!s.opts.unevaluated)return;let g=(m=r?.validate)===null||m===void 0?void 0:m.evaluated;if(s.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(s.props=Bs.mergeEvaluated.props(o,g.props,s.props));else{let v=o.var("props",(0,Fe._)`${p}.evaluated.props`);s.props=Bs.mergeEvaluated.props(o,v,s.props,Fe.Name)}if(s.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(s.items=Bs.mergeEvaluated.items(o,g.items,s.items));else{let v=o.var("items",(0,Fe._)`${p}.evaluated.items`);s.items=Bs.mergeEvaluated.items(o,v,s.items,Fe.Name)}}}Ir.callRef=Gs;Ir.default=$k});var wh=z(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});var wk=_h(),kk=$h(),Sk=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",wk.default,kk.default];el.default=Sk});var kh=z(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});var Js=V(),Wt=Js.operators,Ws={maximum:{okStr:"<=",ok:Wt.LTE,fail:Wt.GT},minimum:{okStr:">=",ok:Wt.GTE,fail:Wt.LT},exclusiveMaximum:{okStr:"<",ok:Wt.LT,fail:Wt.GTE},exclusiveMinimum:{okStr:">",ok:Wt.GT,fail:Wt.LTE}},zk={message:({keyword:t,schemaCode:e})=>(0,Js.str)`must be ${Ws[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Js._)`{comparison: ${Ws[t].okStr}, limit: ${e}}`},Tk={keyword:Object.keys(Ws),type:"number",schemaType:"number",$data:!0,error:zk,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,Js._)`${r} ${Ws[e].fail} ${n} || isNaN(${r})`)}};tl.default=Tk});var Sh=z(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});var po=V(),Pk={message:({schemaCode:t})=>(0,po.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,po._)`{multipleOf: ${t}}`},Ek={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Pk,code(t){let{gen:e,data:r,schemaCode:n,it:o}=t,s=o.opts.multipleOfPrecision,i=e.let("res"),a=s?(0,po._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${s}`:(0,po._)`${i} !== parseInt(${i})`;t.fail$data((0,po._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};rl.default=Ek});var Th=z(nl=>{"use strict";Object.defineProperty(nl,"__esModule",{value:!0});function zh(t){let e=t.length,r=0,n=0,o;for(;n<e;)r++,o=t.charCodeAt(n++),o>=55296&&o<=56319&&n<e&&(o=t.charCodeAt(n),(o&64512)===56320&&n++);return r}nl.default=zh;zh.code='require("ajv/dist/runtime/ucs2length").default'});var Ph=z(ol=>{"use strict";Object.defineProperty(ol,"__esModule",{value:!0});var Cr=V(),Ik=Q(),Ck=Th(),Rk={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Cr.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Cr._)`{limit: ${t}}`},Nk={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Rk,code(t){let{keyword:e,data:r,schemaCode:n,it:o}=t,s=e==="maxLength"?Cr.operators.GT:Cr.operators.LT,i=o.opts.unicode===!1?(0,Cr._)`${r}.length`:(0,Cr._)`${(0,Ik.useFunc)(t.gen,Ck.default)}(${r})`;t.fail$data((0,Cr._)`${i} ${s} ${n}`)}};ol.default=Nk});var Eh=z(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});var Ok=tt(),Xs=V(),jk={message:({schemaCode:t})=>(0,Xs.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,Xs._)`{pattern: ${t}}`},Zk={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:jk,code(t){let{data:e,$data:r,schema:n,schemaCode:o,it:s}=t,i=s.opts.unicodeRegExp?"u":"",a=r?(0,Xs._)`(new RegExp(${o}, ${i}))`:(0,Ok.usePattern)(t,n);t.fail$data((0,Xs._)`!${a}.test(${e})`)}};sl.default=Zk});var Ih=z(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});var fo=V(),Ak={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,fo.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,fo._)`{limit: ${t}}`},Mk={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Ak,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxProperties"?fo.operators.GT:fo.operators.LT;t.fail$data((0,fo._)`Object.keys(${r}).length ${o} ${n}`)}};il.default=Mk});var Ch=z(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});var mo=tt(),ho=V(),Dk=Q(),qk={message:({params:{missingProperty:t}})=>(0,ho.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,ho._)`{missingProperty: ${t}}`},Lk={keyword:"required",type:"object",schemaType:"array",$data:!0,error:qk,code(t){let{gen:e,schema:r,schemaCode:n,data:o,$data:s,it:i}=t,{opts:a}=i;if(!s&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let f=t.parentSchema.properties,{definedProperties:p}=t.it;for(let m of r)if(f?.[m]===void 0&&!p.has(m)){let g=i.schemaEnv.baseId+i.errSchemaPath,v=`required property "${m}" is not defined at "${g}" (strictRequired)`;(0,Dk.checkStrictMode)(i,v,i.opts.strictRequired)}}function u(){if(c||s)t.block$data(ho.nil,d);else for(let f of r)(0,mo.checkReportMissingProp)(t,f)}function l(){let f=e.let("missing");if(c||s){let p=e.let("valid",!0);t.block$data(p,()=>h(f,p)),t.ok(p)}else e.if((0,mo.checkMissingProp)(t,r,f)),(0,mo.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,mo.noPropertyInData)(e,o,f,a.ownProperties),()=>t.error())})}function h(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,mo.propertyInData)(e,o,f,a.ownProperties)),e.if((0,ho.not)(p),()=>{t.error(),e.break()})},ho.nil)}}};al.default=Lk});var Rh=z(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});var go=V(),Uk={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,go.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,go._)`{limit: ${t}}`},Vk={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Uk,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxItems"?go.operators.GT:go.operators.LT;t.fail$data((0,go._)`${r}.length ${o} ${n}`)}};cl.default=Vk});var Ys=z(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});var Nh=Nu();Nh.code='require("ajv/dist/runtime/equal").default';ul.default=Nh});var Oh=z(dl=>{"use strict";Object.defineProperty(dl,"__esModule",{value:!0});var ll=to(),Te=V(),Fk=Q(),Kk=Ys(),Hk={message:({params:{i:t,j:e}})=>(0,Te.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Te._)`{i: ${t}, j: ${e}}`},Bk={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Hk,code(t){let{gen:e,data:r,$data:n,schema:o,parentSchema:s,schemaCode:i,it:a}=t;if(!n&&!o)return;let c=e.let("valid"),u=s.items?(0,ll.getSchemaTypes)(s.items):[];t.block$data(c,l,(0,Te._)`${i} === false`),t.ok(c);function l(){let p=e.let("i",(0,Te._)`${r}.length`),m=e.let("j");t.setParams({i:p,j:m}),e.assign(c,!0),e.if((0,Te._)`${p} > 1`,()=>(d()?h:f)(p,m))}function d(){return u.length>0&&!u.some(p=>p==="object"||p==="array")}function h(p,m){let g=e.name("item"),v=(0,ll.checkDataTypes)(u,g,a.opts.strictNumbers,ll.DataType.Wrong),x=e.const("indices",(0,Te._)`{}`);e.for((0,Te._)`;${p}--;`,()=>{e.let(g,(0,Te._)`${r}[${p}]`),e.if(v,(0,Te._)`continue`),u.length>1&&e.if((0,Te._)`typeof ${g} == "string"`,(0,Te._)`${g} += "_"`),e.if((0,Te._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(m,(0,Te._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,Te._)`${x}[${g}] = ${p}`)})}function f(p,m){let g=(0,Fk.useFunc)(e,Kk.default),v=e.name("outer");e.label(v).for((0,Te._)`;${p}--;`,()=>e.for((0,Te._)`${m} = ${p}; ${m}--;`,()=>e.if((0,Te._)`${g}(${r}[${p}], ${r}[${m}])`,()=>{t.error(),e.assign(c,!1).break(v)})))}}};dl.default=Bk});var jh=z(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0});var pl=V(),Gk=Q(),Jk=Ys(),Wk={message:"must be equal to constant",params:({schemaCode:t})=>(0,pl._)`{allowedValue: ${t}}`},Xk={keyword:"const",$data:!0,error:Wk,code(t){let{gen:e,data:r,$data:n,schemaCode:o,schema:s}=t;n||s&&typeof s=="object"?t.fail$data((0,pl._)`!${(0,Gk.useFunc)(e,Jk.default)}(${r}, ${o})`):t.fail((0,pl._)`${s} !== ${r}`)}};fl.default=Xk});var Zh=z(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0});var yo=V(),Yk=Q(),Qk=Ys(),eS={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,yo._)`{allowedValues: ${t}}`},tS={keyword:"enum",schemaType:"array",$data:!0,error:eS,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:s,it:i}=t;if(!n&&o.length===0)throw new Error("enum must have non-empty array");let a=o.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,Yk.useFunc)(e,Qk.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(o))throw new Error("ajv implementation error");let f=e.const("vSchema",s);l=(0,yo.or)(...o.map((p,m)=>h(f,m)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",s,f=>e.if((0,yo._)`${u()}(${r}, ${f})`,()=>e.assign(l,!0).break()))}function h(f,p){let m=o[p];return typeof m=="object"&&m!==null?(0,yo._)`${u()}(${r}, ${f}[${p}])`:(0,yo._)`${r} === ${m}`}}};ml.default=tS});var Ah=z(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});var rS=kh(),nS=Sh(),oS=Ph(),sS=Eh(),iS=Ih(),aS=Ch(),cS=Rh(),uS=Oh(),lS=jh(),dS=Zh(),pS=[rS.default,nS.default,oS.default,sS.default,iS.default,aS.default,cS.default,uS.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},lS.default,dS.default];hl.default=pS});var yl=z(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.validateAdditionalItems=void 0;var Rr=V(),gl=Q(),fS={message:({params:{len:t}})=>(0,Rr.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Rr._)`{limit: ${t}}`},mS={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:fS,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,gl.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Mh(t,n)}};function Mh(t,e){let{gen:r,schema:n,data:o,keyword:s,it:i}=t;i.items=!0;let a=r.const("len",(0,Rr._)`${o}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Rr._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,gl.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,Rr._)`${a} <= ${e.length}`);r.if((0,Rr.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:s,dataProp:l,dataPropType:gl.Type.Num},u),i.allErrors||r.if((0,Rr.not)(u),()=>r.break())})}}_o.validateAdditionalItems=Mh;_o.default=mS});var _l=z(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.validateTuple=void 0;var Dh=V(),Qs=Q(),hS=tt(),gS={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return qh(t,"additionalItems",e);r.items=!0,!(0,Qs.alwaysValidSchema)(r,e)&&t.ok((0,hS.validateArray)(t))}};function qh(t,e,r=t.schema){let{gen:n,parentSchema:o,data:s,keyword:i,it:a}=t;l(o),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Qs.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,Dh._)`${s}.length`);r.forEach((d,h)=>{(0,Qs.alwaysValidSchema)(a,d)||(n.if((0,Dh._)`${u} > ${h}`,()=>t.subschema({keyword:i,schemaProp:h,dataProp:h},c)),t.ok(c))});function l(d){let{opts:h,errSchemaPath:f}=a,p=r.length,m=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(h.strictTuples&&!m){let g=`"${i}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,Qs.checkStrictMode)(a,g,h.strictTuples)}}}vo.validateTuple=qh;vo.default=gS});var Lh=z(vl=>{"use strict";Object.defineProperty(vl,"__esModule",{value:!0});var yS=_l(),_S={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,yS.validateTuple)(t,"items")};vl.default=_S});var Vh=z(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});var Uh=V(),vS=Q(),xS=tt(),bS=yl(),$S={message:({params:{len:t}})=>(0,Uh.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Uh._)`{limit: ${t}}`},wS={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:$S,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:o}=r;n.items=!0,!(0,vS.alwaysValidSchema)(n,e)&&(o?(0,bS.validateAdditionalItems)(t,o):t.ok((0,xS.validateArray)(t)))}};xl.default=wS});var Fh=z(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});var nt=V(),ei=Q(),kS={message:({params:{min:t,max:e}})=>e===void 0?(0,nt.str)`must contain at least ${t} valid item(s)`:(0,nt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,nt._)`{minContains: ${t}}`:(0,nt._)`{minContains: ${t}, maxContains: ${e}}`},SS={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:kS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t,i,a,{minContains:c,maxContains:u}=n;s.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,nt._)`${o}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,ei.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,ei.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,ei.alwaysValidSchema)(s,r)){let m=(0,nt._)`${l} >= ${i}`;a!==void 0&&(m=(0,nt._)`${m} && ${l} <= ${a}`),t.pass(m);return}s.items=!0;let d=e.name("valid");a===void 0&&i===1?f(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,nt._)`${o}.length > 0`,h)):(e.let(d,!1),h()),t.result(d,()=>t.reset());function h(){let m=e.name("_valid"),g=e.let("count",0);f(m,()=>e.if(m,()=>p(g)))}function f(m,g){e.forRange("i",0,l,v=>{t.subschema({keyword:"contains",dataProp:v,dataPropType:ei.Type.Num,compositeRule:!0},m),g()})}function p(m){e.code((0,nt._)`${m}++`),a===void 0?e.if((0,nt._)`${m} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,nt._)`${m} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,nt._)`${m} >= ${i}`,()=>e.assign(d,!0)))}}};bl.default=SS});var Bh=z(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.validateSchemaDeps=xt.validatePropertyDeps=xt.error=void 0;var $l=V(),zS=Q(),xo=tt();xt.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,$l.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,$l._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var TS={keyword:"dependencies",type:"object",schemaType:"object",error:xt.error,code(t){let[e,r]=PS(t);Kh(t,e),Hh(t,r)}};function PS({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let o=Array.isArray(t[n])?e:r;o[n]=t[n]}return[e,r]}function Kh(t,e=t.schema){let{gen:r,data:n,it:o}=t;if(Object.keys(e).length===0)return;let s=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,xo.propertyInData)(r,n,i,o.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),o.allErrors?r.if(c,()=>{for(let u of a)(0,xo.checkReportMissingProp)(t,u)}):(r.if((0,$l._)`${c} && (${(0,xo.checkMissingProp)(t,a,s)})`),(0,xo.reportMissingProp)(t,s),r.else())}}xt.validatePropertyDeps=Kh;function Hh(t,e=t.schema){let{gen:r,data:n,keyword:o,it:s}=t,i=r.name("valid");for(let a in e)(0,zS.alwaysValidSchema)(s,e[a])||(r.if((0,xo.propertyInData)(r,n,a,s.opts.ownProperties),()=>{let c=t.subschema({keyword:o,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}xt.validateSchemaDeps=Hh;xt.default=TS});var Jh=z(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});var Gh=V(),ES=Q(),IS={message:"property name must be valid",params:({params:t})=>(0,Gh._)`{propertyName: ${t.propertyName}}`},CS={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:IS,code(t){let{gen:e,schema:r,data:n,it:o}=t;if((0,ES.alwaysValidSchema)(o,r))return;let s=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},s),e.if((0,Gh.not)(s),()=>{t.error(!0),o.allErrors||e.break()})}),t.ok(s)}};wl.default=CS});var Sl=z(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});var ti=tt(),dt=V(),RS=It(),ri=Q(),NS={message:"must NOT have additional properties",params:({params:t})=>(0,dt._)`{additionalProperty: ${t.additionalProperty}}`},OS={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:NS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,errsCount:s,it:i}=t;if(!s)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,ri.alwaysValidSchema)(i,r))return;let u=(0,ti.allSchemaProperties)(n.properties),l=(0,ti.allSchemaProperties)(n.patternProperties);d(),t.ok((0,dt._)`${s} === ${RS.default.errors}`);function d(){e.forIn("key",o,g=>{!u.length&&!l.length?p(g):e.if(h(g),()=>p(g))})}function h(g){let v;if(u.length>8){let x=(0,ri.schemaRefOrVal)(i,n.properties,"properties");v=(0,ti.isOwnProperty)(e,x,g)}else u.length?v=(0,dt.or)(...u.map(x=>(0,dt._)`${g} === ${x}`)):v=dt.nil;return l.length&&(v=(0,dt.or)(v,...l.map(x=>(0,dt._)`${(0,ti.usePattern)(t,x)}.test(${g})`))),(0,dt.not)(v)}function f(g){e.code((0,dt._)`delete ${o}[${g}]`)}function p(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,ri.alwaysValidSchema)(i,r)){let v=e.name("valid");c.removeAdditional==="failing"?(m(g,v,!1),e.if((0,dt.not)(v),()=>{t.reset(),f(g)})):(m(g,v),a||e.if((0,dt.not)(v),()=>e.break()))}}function m(g,v,x){let b={keyword:"additionalProperties",dataProp:g,dataPropType:ri.Type.Str};x===!1&&Object.assign(b,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(b,v)}}};kl.default=OS});var Yh=z(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});var jS=so(),Wh=tt(),zl=Q(),Xh=Sl(),ZS={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Xh.default.code(new jS.KeywordCxt(s,Xh.default,"additionalProperties"));let i=(0,Wh.allSchemaProperties)(r);for(let d of i)s.definedProperties.add(d);s.opts.unevaluated&&i.length&&s.props!==!0&&(s.props=zl.mergeEvaluated.props(e,(0,zl.toHash)(i),s.props));let a=i.filter(d=>!(0,zl.alwaysValidSchema)(s,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,Wh.propertyInData)(e,o,d,s.opts.ownProperties)),l(d),s.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return s.opts.useDefaults&&!s.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};Tl.default=ZS});var rg=z(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});var Qh=tt(),ni=V(),eg=Q(),tg=Q(),AS={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:o,it:s}=t,{opts:i}=s,a=(0,Qh.allSchemaProperties)(r),c=a.filter(m=>(0,eg.alwaysValidSchema)(s,r[m]));if(a.length===0||c.length===a.length&&(!s.opts.unevaluated||s.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&o.properties,l=e.name("valid");s.props!==!0&&!(s.props instanceof ni.Name)&&(s.props=(0,tg.evaluatedPropsToName)(e,s.props));let{props:d}=s;h();function h(){for(let m of a)u&&f(m),s.allErrors?p(m):(e.var(l,!0),p(m),e.if(l))}function f(m){for(let g in u)new RegExp(m).test(g)&&(0,eg.checkStrictMode)(s,`property ${g} matches pattern ${m} (use allowMatchingProperties)`)}function p(m){e.forIn("key",n,g=>{e.if((0,ni._)`${(0,Qh.usePattern)(t,m)}.test(${g})`,()=>{let v=c.includes(m);v||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:g,dataPropType:tg.Type.Str},l),s.opts.unevaluated&&d!==!0?e.assign((0,ni._)`${d}[${g}]`,!0):!v&&!s.allErrors&&e.if((0,ni.not)(l),()=>e.break())})})}}};Pl.default=AS});var ng=z(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});var MS=Q(),DS={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,MS.alwaysValidSchema)(n,r)){t.fail();return}let o=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),t.failResult(o,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};El.default=DS});var og=z(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});var qS=tt(),LS={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:qS.validateUnion,error:{message:"must match a schema in anyOf"}};Il.default=LS});var sg=z(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});var oi=V(),US=Q(),VS={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,oi._)`{passingSchemas: ${t.passing}}`},FS={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:VS,code(t){let{gen:e,schema:r,parentSchema:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(o.opts.discriminator&&n.discriminator)return;let s=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){s.forEach((l,d)=>{let h;(0,US.alwaysValidSchema)(o,l)?e.var(c,!0):h=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,oi._)`${c} && ${i}`).assign(i,!1).assign(a,(0,oi._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),h&&t.mergeEvaluated(h,oi.Name)})})}}};Cl.default=FS});var ig=z(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});var KS=Q(),HS={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let o=e.name("valid");r.forEach((s,i)=>{if((0,KS.alwaysValidSchema)(n,s))return;let a=t.subschema({keyword:"allOf",schemaProp:i},o);t.ok(o),t.mergeEvaluated(a)})}};Rl.default=HS});var ug=z(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});var si=V(),cg=Q(),BS={message:({params:t})=>(0,si.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,si._)`{failingKeyword: ${t.ifClause}}`},GS={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:BS,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,cg.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let o=ag(n,"then"),s=ag(n,"else");if(!o&&!s)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),o&&s){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else o?e.if(a,u("then")):e.if((0,si.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let h=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(h,i),d?e.assign(d,(0,si._)`${l}`):t.setParams({ifClause:l})}}}};function ag(t,e){let r=t.schema[e];return r!==void 0&&!(0,cg.alwaysValidSchema)(t,r)}Nl.default=GS});var lg=z(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});var JS=Q(),WS={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,JS.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};Ol.default=WS});var dg=z(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});var XS=yl(),YS=Lh(),QS=_l(),ez=Vh(),tz=Fh(),rz=Bh(),nz=Jh(),oz=Sl(),sz=Yh(),iz=rg(),az=ng(),cz=og(),uz=sg(),lz=ig(),dz=ug(),pz=lg();function fz(t=!1){let e=[az.default,cz.default,uz.default,lz.default,dz.default,pz.default,nz.default,oz.default,rz.default,sz.default,iz.default];return t?e.push(YS.default,ez.default):e.push(XS.default,QS.default),e.push(tz.default),e}jl.default=fz});var pg=z(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});var ge=V(),mz={message:({schemaCode:t})=>(0,ge.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,ge._)`{format: ${t}}`},hz={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:mz,code(t,e){let{gen:r,data:n,$data:o,schema:s,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;o?h():f();function h(){let p=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),m=r.const("fDef",(0,ge._)`${p}[${i}]`),g=r.let("fType"),v=r.let("format");r.if((0,ge._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>r.assign(g,(0,ge._)`${m}.type || "string"`).assign(v,(0,ge._)`${m}.validate`),()=>r.assign(g,(0,ge._)`"string"`).assign(v,m)),t.fail$data((0,ge.or)(x(),b()));function x(){return c.strictSchema===!1?ge.nil:(0,ge._)`${i} && !${v}`}function b(){let k=l.$async?(0,ge._)`(${m}.async ? await ${v}(${n}) : ${v}(${n}))`:(0,ge._)`${v}(${n})`,N=(0,ge._)`(typeof ${v} == "function" ? ${k} : ${v}.test(${n}))`;return(0,ge._)`${v} && ${v} !== true && ${g} === ${e} && !${N}`}}function f(){let p=d.formats[s];if(!p){x();return}if(p===!0)return;let[m,g,v]=b(p);m===e&&t.pass(k());function x(){if(c.strictSchema===!1){d.logger.warn(N());return}throw new Error(N());function N(){return`unknown format "${s}" ignored in schema at path "${u}"`}}function b(N){let he=N instanceof RegExp?(0,ge.regexpCode)(N):c.code.formats?(0,ge._)`${c.code.formats}${(0,ge.getProperty)(s)}`:void 0,xe=r.scopeValue("formats",{key:s,ref:N,code:he});return typeof N=="object"&&!(N instanceof RegExp)?[N.type||"string",N.validate,(0,ge._)`${xe}.validate`]:["string",N,xe]}function k(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!l.$async)throw new Error("async format in sync schema");return(0,ge._)`await ${v}(${n})`}return typeof g=="function"?(0,ge._)`${v}(${n})`:(0,ge._)`${v}.test(${n})`}}}};Zl.default=hz});var fg=z(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});var gz=pg(),yz=[gz.default];Al.default=yz});var mg=z(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.contentVocabulary=un.metadataVocabulary=void 0;un.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];un.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var gg=z(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});var _z=wh(),vz=Ah(),xz=dg(),bz=fg(),hg=mg(),$z=[_z.default,vz.default,(0,xz.default)(),bz.default,hg.metadataVocabulary,hg.contentVocabulary];Ml.default=$z});var _g=z(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.DiscrError=void 0;var yg;(function(t){t.Tag="tag",t.Mapping="mapping"})(yg||(ii.DiscrError=yg={}))});var xg=z(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});var ln=V(),Dl=_g(),vg=Ls(),wz=io(),kz=Q(),Sz={message:({params:{discrError:t,tagName:e}})=>t===Dl.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,ln._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},zz={keyword:"discriminator",type:"object",schemaType:"object",error:Sz,code(t){let{gen:e,data:r,schema:n,parentSchema:o,it:s}=t,{oneOf:i}=o;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,ln._)`${r}${(0,ln.getProperty)(a)}`);e.if((0,ln._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:Dl.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let f=h();e.if(!1);for(let p in f)e.elseIf((0,ln._)`${u} === ${p}`),e.assign(c,d(f[p]));e.else(),t.error(!1,{discrError:Dl.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(f){let p=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(m,ln.Name),p}function h(){var f;let p={},m=v(o),g=!0;for(let k=0;k<i.length;k++){let N=i[k];if(N?.$ref&&!(0,kz.schemaHasRulesButRef)(N,s.self.RULES)){let xe=N.$ref;if(N=vg.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,xe),N instanceof vg.SchemaEnv&&(N=N.schema),N===void 0)throw new wz.default(s.opts.uriResolver,s.baseId,xe)}let he=(f=N?.properties)===null||f===void 0?void 0:f[a];if(typeof he!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(m||v(N)),x(he,k)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return p;function v({required:k}){return Array.isArray(k)&&k.includes(a)}function x(k,N){if(k.const)b(k.const,N);else if(k.enum)for(let he of k.enum)b(he,N);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function b(k,N){if(typeof k!="string"||k in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[k]=N}}}};ql.default=zz});var bg=z((MN,Tz)=>{Tz.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Ul=z((ce,Ll)=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.MissingRefError=ce.ValidationError=ce.CodeGen=ce.Name=ce.nil=ce.stringify=ce.str=ce._=ce.KeywordCxt=ce.Ajv=void 0;var Pz=yh(),Ez=gg(),Iz=xg(),$g=bg(),Cz=["/properties"],ai="http://json-schema.org/draft-07/schema",dn=class extends Pz.default{_addVocabularies(){super._addVocabularies(),Ez.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(Iz.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema($g,Cz):$g;this.addMetaSchema(e,ai,!1),this.refs["http://json-schema.org/schema"]=ai}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(ai)?ai:void 0)}};ce.Ajv=dn;Ll.exports=ce=dn;Ll.exports.Ajv=dn;Object.defineProperty(ce,"__esModule",{value:!0});ce.default=dn;var Rz=so();Object.defineProperty(ce,"KeywordCxt",{enumerable:!0,get:function(){return Rz.KeywordCxt}});var pn=V();Object.defineProperty(ce,"_",{enumerable:!0,get:function(){return pn._}});Object.defineProperty(ce,"str",{enumerable:!0,get:function(){return pn.str}});Object.defineProperty(ce,"stringify",{enumerable:!0,get:function(){return pn.stringify}});Object.defineProperty(ce,"nil",{enumerable:!0,get:function(){return pn.nil}});Object.defineProperty(ce,"Name",{enumerable:!0,get:function(){return pn.Name}});Object.defineProperty(ce,"CodeGen",{enumerable:!0,get:function(){return pn.CodeGen}});var Nz=Ds();Object.defineProperty(ce,"ValidationError",{enumerable:!0,get:function(){return Nz.default}});var Oz=io();Object.defineProperty(ce,"MissingRefError",{enumerable:!0,get:function(){return Oz.default}})});var Ig=z($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.formatNames=$t.fastFormats=$t.fullFormats=void 0;function bt(t,e){return{validate:t,compare:e}}$t.fullFormats={date:bt(zg,Hl),time:bt(Fl(!0),Bl),"date-time":bt(wg(!0),Pg),"iso-time":bt(Fl(),Tg),"iso-date-time":bt(wg(),Eg),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:qz,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:Bz,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Lz,int32:{type:"number",validate:Fz},int64:{type:"number",validate:Kz},float:{type:"number",validate:Sg},double:{type:"number",validate:Sg},password:!0,binary:!0};$t.fastFormats={...$t.fullFormats,date:bt(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,Hl),time:bt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Bl),"date-time":bt(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Pg),"iso-time":bt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Tg),"iso-date-time":bt(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Eg),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};$t.formatNames=Object.keys($t.fullFormats);function jz(t){return t%4===0&&(t%100!==0||t%400===0)}var Zz=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Az=[0,31,28,31,30,31,30,31,31,30,31,30,31];function zg(t){let e=Zz.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],o=+e[3];return n>=1&&n<=12&&o>=1&&o<=(n===2&&jz(r)?29:Az[n])}function Hl(t,e){if(t&&e)return t>e?1:t<e?-1:0}var Vl=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Fl(t){return function(r){let n=Vl.exec(r);if(!n)return!1;let o=+n[1],s=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),l=+(n[7]||0);if(u>23||l>59||t&&!a)return!1;if(o<=23&&s<=59&&i<60)return!0;let d=s-l*c,h=o-u*c-(d<0?1:0);return(h===23||h===-1)&&(d===59||d===-1)&&i<61}}function Bl(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function Tg(t,e){if(!(t&&e))return;let r=Vl.exec(t),n=Vl.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var Kl=/t|\s/i;function wg(t){let e=Fl(t);return function(n){let o=n.split(Kl);return o.length===2&&zg(o[0])&&e(o[1])}}function Pg(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function Eg(t,e){if(!(t&&e))return;let[r,n]=t.split(Kl),[o,s]=e.split(Kl),i=Hl(r,o);if(i!==void 0)return i||Bl(n,s)}var Mz=/\/|:/,Dz=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function qz(t){return Mz.test(t)&&Dz.test(t)}var kg=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Lz(t){return kg.lastIndex=0,kg.test(t)}var Uz=-(2**31),Vz=2**31-1;function Fz(t){return Number.isInteger(t)&&t<=Vz&&t>=Uz}function Kz(t){return Number.isInteger(t)}function Sg(){return!0}var Hz=/[^\\]\\Z/;function Bz(t){if(Hz.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Cg=z(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.formatLimitDefinition=void 0;var Gz=Ul(),pt=V(),Xt=pt.operators,ci={formatMaximum:{okStr:"<=",ok:Xt.LTE,fail:Xt.GT},formatMinimum:{okStr:">=",ok:Xt.GTE,fail:Xt.LT},formatExclusiveMaximum:{okStr:"<",ok:Xt.LT,fail:Xt.GTE},formatExclusiveMinimum:{okStr:">",ok:Xt.GT,fail:Xt.LTE}},Jz={message:({keyword:t,schemaCode:e})=>(0,pt.str)`should be ${ci[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,pt._)`{comparison: ${ci[t].okStr}, limit: ${e}}`};fn.formatLimitDefinition={keyword:Object.keys(ci),type:"string",schemaType:"string",$data:!0,error:Jz,code(t){let{gen:e,data:r,schemaCode:n,keyword:o,it:s}=t,{opts:i,self:a}=s;if(!i.validateFormats)return;let c=new Gz.KeywordCxt(s,a.RULES.all.format.definition,"format");c.$data?u():l();function u(){let h=e.scopeValue("formats",{ref:a.formats,code:i.code.formats}),f=e.const("fmt",(0,pt._)`${h}[${c.schemaCode}]`);t.fail$data((0,pt.or)((0,pt._)`typeof ${f} != "object"`,(0,pt._)`${f} instanceof RegExp`,(0,pt._)`typeof ${f}.compare != "function"`,d(f)))}function l(){let h=c.schema,f=a.formats[h];if(!f||f===!0)return;if(typeof f!="object"||f instanceof RegExp||typeof f.compare!="function")throw new Error(`"${o}": format "${h}" does not define "compare" function`);let p=e.scopeValue("formats",{key:h,ref:f,code:i.code.formats?(0,pt._)`${i.code.formats}${(0,pt.getProperty)(h)}`:void 0});t.fail$data(d(p))}function d(h){return(0,pt._)`${h}.compare(${r}, ${n}) ${ci[o].fail} 0`}},dependencies:["format"]};var Wz=t=>(t.addKeyword(fn.formatLimitDefinition),t);fn.default=Wz});var jg=z((bo,Og)=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});var mn=Ig(),Xz=Cg(),Gl=V(),Rg=new Gl.Name("fullFormats"),Yz=new Gl.Name("fastFormats"),Jl=(t,e={keywords:!0})=>{if(Array.isArray(e))return Ng(t,e,mn.fullFormats,Rg),t;let[r,n]=e.mode==="fast"?[mn.fastFormats,Yz]:[mn.fullFormats,Rg],o=e.formats||mn.formatNames;return Ng(t,o,r,n),e.keywords&&(0,Xz.default)(t),t};Jl.get=(t,e="full")=>{let n=(e==="fast"?mn.fastFormats:mn.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function Ng(t,e,r,n){var o,s;(o=(s=t.opts.code).formats)!==null&&o!==void 0||(s.formats=(0,Gl._)`require("ajv-formats/dist/formats").${n}`);for(let i of e)t.addFormat(i,r[i])}Og.exports=bo=Jl;Object.defineProperty(bo,"__esModule",{value:!0});bo.default=Jl});var A={};bi(A,{BRAND:()=>Dy,DIRTY:()=>er,EMPTY_PATH:()=>yy,INVALID:()=>j,NEVER:()=>$_,OK:()=>Pe,ParseStatus:()=>be,Schema:()=>U,ZodAny:()=>Zt,ZodArray:()=>zt,ZodBigInt:()=>rr,ZodBoolean:()=>nr,ZodBranded:()=>xn,ZodCatch:()=>mr,ZodDate:()=>or,ZodDefault:()=>fr,ZodDiscriminatedUnion:()=>Po,ZodEffects:()=>We,ZodEnum:()=>dr,ZodError:()=>Ae,ZodFirstPartyTypeKind:()=>w,ZodFunction:()=>Io,ZodIntersection:()=>cr,ZodIssueCode:()=>$,ZodLazy:()=>ur,ZodLiteral:()=>lr,ZodMap:()=>Lr,ZodNaN:()=>Vr,ZodNativeEnum:()=>pr,ZodNever:()=>ot,ZodNull:()=>ir,ZodNullable:()=>ht,ZodNumber:()=>tr,ZodObject:()=>De,ZodOptional:()=>Me,ZodParsedType:()=>T,ZodPipeline:()=>bn,ZodPromise:()=>At,ZodReadonly:()=>hr,ZodRecord:()=>Eo,ZodSchema:()=>U,ZodSet:()=>Ur,ZodString:()=>jt,ZodSymbol:()=>Dr,ZodTransformer:()=>We,ZodTuple:()=>mt,ZodType:()=>U,ZodUndefined:()=>sr,ZodUnion:()=>ar,ZodUnknown:()=>St,ZodVoid:()=>qr,addIssueToContext:()=>S,any:()=>Gy,array:()=>Yy,bigint:()=>Vy,boolean:()=>pd,coerce:()=>b_,custom:()=>ud,date:()=>Fy,datetimeRegex:()=>ad,defaultErrorMap:()=>wt,discriminatedUnion:()=>t_,effect:()=>f_,enum:()=>l_,function:()=>a_,getErrorMap:()=>Zr,getParsedType:()=>ft,instanceof:()=>Ly,intersection:()=>r_,isAborted:()=>zo,isAsync:()=>Ar,isDirty:()=>To,isValid:()=>Ot,late:()=>qy,lazy:()=>c_,literal:()=>u_,makeIssue:()=>vn,map:()=>s_,nan:()=>Uy,nativeEnum:()=>d_,never:()=>Wy,null:()=>By,nullable:()=>h_,number:()=>dd,object:()=>Si,objectUtil:()=>$i,oboolean:()=>x_,onumber:()=>v_,optional:()=>m_,ostring:()=>__,pipeline:()=>y_,preprocess:()=>g_,promise:()=>p_,quotelessJson:()=>my,record:()=>o_,set:()=>i_,setErrorMap:()=>gy,strictObject:()=>Qy,string:()=>ld,symbol:()=>Ky,transformer:()=>f_,tuple:()=>n_,undefined:()=>Hy,union:()=>e_,unknown:()=>Jy,util:()=>H,void:()=>Xy});var H;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function r(o){throw new Error}t.assertNever=r,t.arrayToEnum=o=>{let s={};for(let i of o)s[i]=i;return s},t.getValidEnumValues=o=>{let s=t.objectKeys(o).filter(a=>typeof o[o[a]]!="number"),i={};for(let a of s)i[a]=o[a];return t.objectValues(i)},t.objectValues=o=>t.objectKeys(o).map(function(s){return o[s]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let s=[];for(let i in o)Object.prototype.hasOwnProperty.call(o,i)&&s.push(i);return s},t.find=(o,s)=>{for(let i of o)if(s(i))return i},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}t.joinValues=n,t.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s})(H||(H={}));var $i;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($i||($i={}));var T=H.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ft=t=>{switch(typeof t){case"undefined":return T.undefined;case"string":return T.string;case"number":return Number.isNaN(t)?T.nan:T.number;case"boolean":return T.boolean;case"function":return T.function;case"bigint":return T.bigint;case"symbol":return T.symbol;case"object":return Array.isArray(t)?T.array:t===null?T.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?T.promise:typeof Map<"u"&&t instanceof Map?T.map:typeof Set<"u"&&t instanceof Set?T.set:typeof Date<"u"&&t instanceof Date?T.date:T.object;default:return T.unknown}};var $=H.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),my=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Ae=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(o);else if(i.code==="invalid_return_type")o(i.returnTypeError);else if(i.code==="invalid_arguments")o(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,H.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let o of this.issues)if(o.path.length>0){let s=o.path[0];r[s]=r[s]||[],r[s].push(e(o))}else n.push(e(o));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ae.create=t=>new Ae(t);var hy=(t,e)=>{let r;switch(t.code){case $.invalid_type:t.received===T.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case $.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,H.jsonStringifyReplacer)}`;break;case $.unrecognized_keys:r=`Unrecognized key(s) in object: ${H.joinValues(t.keys,", ")}`;break;case $.invalid_union:r="Invalid input";break;case $.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${H.joinValues(t.options)}`;break;case $.invalid_enum_value:r=`Invalid enum value. Expected ${H.joinValues(t.options)}, received '${t.received}'`;break;case $.invalid_arguments:r="Invalid function arguments";break;case $.invalid_return_type:r="Invalid function return type";break;case $.invalid_date:r="Invalid date";break;case $.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:H.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case $.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case $.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case $.custom:r="Invalid input";break;case $.invalid_intersection_types:r="Intersection results could not be merged";break;case $.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case $.not_finite:r="Number must be finite";break;default:r=e.defaultError,H.assertNever(t)}return{message:r}},wt=hy;var rd=wt;function gy(t){rd=t}function Zr(){return rd}var vn=t=>{let{data:e,path:r,errorMaps:n,issueData:o}=t,s=[...r,...o.path||[]],i={...o,path:s};if(o.message!==void 0)return{...o,path:s,message:o.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:e,defaultError:a}).message;return{...o,path:s,message:a}},yy=[];function S(t,e){let r=Zr(),n=vn({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===wt?void 0:wt].filter(o=>!!o)});t.common.issues.push(n)}var be=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let o of r){if(o.status==="aborted")return j;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let o of r){let s=await o.key,i=await o.value;n.push({key:s,value:i})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let o of r){let{key:s,value:i}=o;if(s.status==="aborted"||i.status==="aborted")return j;s.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||o.alwaysSet)&&(n[s.value]=i.value)}return{status:e.value,value:n}}},j=Object.freeze({status:"aborted"}),er=t=>({status:"dirty",value:t}),Pe=t=>({status:"valid",value:t}),zo=t=>t.status==="aborted",To=t=>t.status==="dirty",Ot=t=>t.status==="valid",Ar=t=>typeof Promise<"u"&&t instanceof Promise;var E;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(E||(E={}));var Je=class{constructor(e,r,n,o){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},nd=(t,e)=>{if(Ot(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Ae(t.common.issues);return this._error=r,this._error}}};function q(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:o}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(i,a)=>{let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:o}}var U=class{get description(){return this._def.description}_getType(e){return ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new be,ctx:{common:e.parent.common,data:e.data,parsedType:ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Ar(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)},o=this._parseSync({data:e,path:n.path,parent:n});return nd(n,o)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Ot(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Ot(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)},o=this._parse({data:e,path:n.path,parent:n}),s=await(Ar(o)?o:Promise.resolve(o));return nd(n,s)}refine(e,r){let n=o=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,s)=>{let i=e(o),a=()=>s.addIssue({code:$.custom,...n(o)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof r=="function"?r(n,o):r),!1))}_refinement(e){return new We({schema:this,typeName:w.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Me.create(this,this._def)}nullable(){return ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return zt.create(this)}promise(){return At.create(this,this._def)}or(e){return ar.create([this,e],this._def)}and(e){return cr.create(this,e,this._def)}transform(e){return new We({...q(this._def),schema:this,typeName:w.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new fr({...q(this._def),innerType:this,defaultValue:r,typeName:w.ZodDefault})}brand(){return new xn({typeName:w.ZodBranded,type:this,...q(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new mr({...q(this._def),innerType:this,catchValue:r,typeName:w.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return bn.create(this,e)}readonly(){return hr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},_y=/^c[^\s-]{8,}$/i,vy=/^[0-9a-z]+$/,xy=/^[0-9A-HJKMNP-TV-Z]{26}$/i,by=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$y=/^[a-z0-9_-]{21}$/i,wy=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ky=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Sy=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,zy="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",wi,Ty=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Py=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ey=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Iy=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Cy=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ry=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,sd="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ny=new RegExp(`^${sd}$`);function id(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function Oy(t){return new RegExp(`^${id(t)}$`)}function ad(t){let e=`${sd}T${id(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function jy(t,e){return!!((e==="v4"||!e)&&Ty.test(t)||(e==="v6"||!e)&&Ey.test(t))}function Zy(t,e){if(!wy.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function Ay(t,e){return!!((e==="v4"||!e)&&Py.test(t)||(e==="v6"||!e)&&Iy.test(t))}var jt=class t extends U{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==T.string){let s=this._getOrReturnCtx(e);return S(s,{code:$.invalid_type,expected:T.string,received:s.parsedType}),j}let n=new be,o;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(o=this._getOrReturnCtx(e,o),S(o,{code:$.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(o=this._getOrReturnCtx(e,o),S(o,{code:$.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){let i=e.data.length>s.value,a=e.data.length<s.value;(i||a)&&(o=this._getOrReturnCtx(e,o),i?S(o,{code:$.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&S(o,{code:$.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")Sy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"email",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")wi||(wi=new RegExp(zy,"u")),wi.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"emoji",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")by.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"uuid",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")$y.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"nanoid",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")_y.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"cuid",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")vy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"cuid2",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")xy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"ulid",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),S(o,{validation:"url",code:$.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"regex",code:$.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(e,o),S(o,{code:$.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(o=this._getOrReturnCtx(e,o),S(o,{code:$.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(o=this._getOrReturnCtx(e,o),S(o,{code:$.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?ad(s).test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{code:$.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?Ny.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{code:$.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?Oy(s).test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{code:$.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?ky.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"duration",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?jy(e.data,s.version)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"ip",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?Zy(e.data,s.alg)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"jwt",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?Ay(e.data,s.version)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"cidr",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?Cy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"base64",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?Ry.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"base64url",code:$.invalid_string,message:s.message}),n.dirty()):H.assertNever(s);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(o=>e.test(o),{validation:r,code:$.invalid_string,...E.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...E.errToObj(e)})}url(e){return this._addCheck({kind:"url",...E.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...E.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...E.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...E.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...E.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...E.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...E.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...E.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...E.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...E.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...E.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...E.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...E.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...E.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...E.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...E.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...E.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...E.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...E.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...E.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...E.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...E.errToObj(r)})}nonempty(e){return this.min(1,E.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};jt.create=t=>new jt({checks:[],typeName:w.ZodString,coerce:t?.coerce??!1,...q(t)});function My(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}var tr=class t extends U{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==T.number){let s=this._getOrReturnCtx(e);return S(s,{code:$.invalid_type,expected:T.number,received:s.parsedType}),j}let n,o=new be;for(let s of this._def.checks)s.kind==="int"?H.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),S(n,{code:$.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),S(n,{code:$.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),S(n,{code:$.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="multipleOf"?My(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),S(n,{code:$.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),S(n,{code:$.not_finite,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,E.toString(r))}gt(e,r){return this.setLimit("min",e,!1,E.toString(r))}lte(e,r){return this.setLimit("max",e,!0,E.toString(r))}lt(e,r){return this.setLimit("max",e,!1,E.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:E.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:E.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:E.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&H.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};tr.create=t=>new tr({checks:[],typeName:w.ZodNumber,coerce:t?.coerce||!1,...q(t)});var rr=class t extends U{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==T.bigint)return this._getInvalidInput(e);let n,o=new be;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),S(n,{code:$.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),S(n,{code:$.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),S(n,{code:$.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return S(r,{code:$.invalid_type,expected:T.bigint,received:r.parsedType}),j}gte(e,r){return this.setLimit("min",e,!0,E.toString(r))}gt(e,r){return this.setLimit("min",e,!1,E.toString(r))}lte(e,r){return this.setLimit("max",e,!0,E.toString(r))}lt(e,r){return this.setLimit("max",e,!1,E.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:E.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};rr.create=t=>new rr({checks:[],typeName:w.ZodBigInt,coerce:t?.coerce??!1,...q(t)});var nr=class extends U{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==T.boolean){let n=this._getOrReturnCtx(e);return S(n,{code:$.invalid_type,expected:T.boolean,received:n.parsedType}),j}return Pe(e.data)}};nr.create=t=>new nr({typeName:w.ZodBoolean,coerce:t?.coerce||!1,...q(t)});var or=class t extends U{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==T.date){let s=this._getOrReturnCtx(e);return S(s,{code:$.invalid_type,expected:T.date,received:s.parsedType}),j}if(Number.isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return S(s,{code:$.invalid_date}),j}let n=new be,o;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(o=this._getOrReturnCtx(e,o),S(o,{code:$.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(o=this._getOrReturnCtx(e,o),S(o,{code:$.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):H.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:E.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:E.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};or.create=t=>new or({checks:[],coerce:t?.coerce||!1,typeName:w.ZodDate,...q(t)});var Dr=class extends U{_parse(e){if(this._getType(e)!==T.symbol){let n=this._getOrReturnCtx(e);return S(n,{code:$.invalid_type,expected:T.symbol,received:n.parsedType}),j}return Pe(e.data)}};Dr.create=t=>new Dr({typeName:w.ZodSymbol,...q(t)});var sr=class extends U{_parse(e){if(this._getType(e)!==T.undefined){let n=this._getOrReturnCtx(e);return S(n,{code:$.invalid_type,expected:T.undefined,received:n.parsedType}),j}return Pe(e.data)}};sr.create=t=>new sr({typeName:w.ZodUndefined,...q(t)});var ir=class extends U{_parse(e){if(this._getType(e)!==T.null){let n=this._getOrReturnCtx(e);return S(n,{code:$.invalid_type,expected:T.null,received:n.parsedType}),j}return Pe(e.data)}};ir.create=t=>new ir({typeName:w.ZodNull,...q(t)});var Zt=class extends U{constructor(){super(...arguments),this._any=!0}_parse(e){return Pe(e.data)}};Zt.create=t=>new Zt({typeName:w.ZodAny,...q(t)});var St=class extends U{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Pe(e.data)}};St.create=t=>new St({typeName:w.ZodUnknown,...q(t)});var ot=class extends U{_parse(e){let r=this._getOrReturnCtx(e);return S(r,{code:$.invalid_type,expected:T.never,received:r.parsedType}),j}};ot.create=t=>new ot({typeName:w.ZodNever,...q(t)});var qr=class extends U{_parse(e){if(this._getType(e)!==T.undefined){let n=this._getOrReturnCtx(e);return S(n,{code:$.invalid_type,expected:T.void,received:n.parsedType}),j}return Pe(e.data)}};qr.create=t=>new qr({typeName:w.ZodVoid,...q(t)});var zt=class t extends U{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),o=this._def;if(r.parsedType!==T.array)return S(r,{code:$.invalid_type,expected:T.array,received:r.parsedType}),j;if(o.exactLength!==null){let i=r.data.length>o.exactLength.value,a=r.data.length<o.exactLength.value;(i||a)&&(S(r,{code:i?$.too_big:$.too_small,minimum:a?o.exactLength.value:void 0,maximum:i?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(S(r,{code:$.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(S(r,{code:$.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>o.type._parseAsync(new Je(r,i,r.path,a)))).then(i=>be.mergeArray(n,i));let s=[...r.data].map((i,a)=>o.type._parseSync(new Je(r,i,r.path,a)));return be.mergeArray(n,s)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:E.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:E.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:E.toString(r)}})}nonempty(e){return this.min(1,e)}};zt.create=(t,e)=>new zt({type:t,minLength:null,maxLength:null,exactLength:null,typeName:w.ZodArray,...q(e)});function Mr(t){if(t instanceof De){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=Me.create(Mr(n))}return new De({...t._def,shape:()=>e})}else return t instanceof zt?new zt({...t._def,type:Mr(t.element)}):t instanceof Me?Me.create(Mr(t.unwrap())):t instanceof ht?ht.create(Mr(t.unwrap())):t instanceof mt?mt.create(t.items.map(e=>Mr(e))):t}var De=class t extends U{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=H.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==T.object){let u=this._getOrReturnCtx(e);return S(u,{code:$.invalid_type,expected:T.object,received:u.parsedType}),j}let{status:n,ctx:o}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof ot&&this._def.unknownKeys==="strip"))for(let u in o.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let l=s[u],d=o.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Je(o,d,o.path,u)),alwaysSet:u in o.data})}if(this._def.catchall instanceof ot){let u=this._def.unknownKeys;if(u==="passthrough")for(let l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:o.data[l]}});else if(u==="strict")a.length>0&&(S(o,{code:$.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let l of a){let d=o.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Je(o,d,o.path,l)),alwaysSet:l in o.data})}}return o.common.async?Promise.resolve().then(async()=>{let u=[];for(let l of c){let d=await l.key,h=await l.value;u.push({key:d,value:h,alwaysSet:l.alwaysSet})}return u}).then(u=>be.mergeObjectSync(n,u)):be.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return E.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let o=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:E.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:w.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of H.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of H.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Mr(this)}partial(e){let r={};for(let n of H.objectKeys(this.shape)){let o=this.shape[n];e&&!e[n]?r[n]=o:r[n]=o.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of H.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Me;)s=s._def.innerType;r[n]=s}return new t({...this._def,shape:()=>r})}keyof(){return cd(H.objectKeys(this.shape))}};De.create=(t,e)=>new De({shape:()=>t,unknownKeys:"strip",catchall:ot.create(),typeName:w.ZodObject,...q(e)});De.strictCreate=(t,e)=>new De({shape:()=>t,unknownKeys:"strict",catchall:ot.create(),typeName:w.ZodObject,...q(e)});De.lazycreate=(t,e)=>new De({shape:t,unknownKeys:"strip",catchall:ot.create(),typeName:w.ZodObject,...q(e)});var ar=class extends U{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function o(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=s.map(a=>new Ae(a.ctx.common.issues));return S(r,{code:$.invalid_union,unionErrors:i}),j}if(r.common.async)return Promise.all(n.map(async s=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(o);{let s,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!s&&(s={result:l,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let a=i.map(c=>new Ae(c));return S(r,{code:$.invalid_union,unionErrors:a}),j}}get options(){return this._def.options}};ar.create=(t,e)=>new ar({options:t,typeName:w.ZodUnion,...q(e)});var kt=t=>t instanceof ur?kt(t.schema):t instanceof We?kt(t.innerType()):t instanceof lr?[t.value]:t instanceof dr?t.options:t instanceof pr?H.objectValues(t.enum):t instanceof fr?kt(t._def.innerType):t instanceof sr?[void 0]:t instanceof ir?[null]:t instanceof Me?[void 0,...kt(t.unwrap())]:t instanceof ht?[null,...kt(t.unwrap())]:t instanceof xn||t instanceof hr?kt(t.unwrap()):t instanceof mr?kt(t._def.innerType):[],Po=class t extends U{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.object)return S(r,{code:$.invalid_type,expected:T.object,received:r.parsedType}),j;let n=this.discriminator,o=r.data[n],s=this.optionsMap.get(o);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(S(r,{code:$.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),j)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let o=new Map;for(let s of r){let i=kt(s.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(o.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);o.set(a,s)}}return new t({typeName:w.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:o,...q(n)})}};function ki(t,e){let r=ft(t),n=ft(e);if(t===e)return{valid:!0,data:t};if(r===T.object&&n===T.object){let o=H.objectKeys(e),s=H.objectKeys(t).filter(a=>o.indexOf(a)!==-1),i={...t,...e};for(let a of s){let c=ki(t[a],e[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===T.array&&n===T.array){if(t.length!==e.length)return{valid:!1};let o=[];for(let s=0;s<t.length;s++){let i=t[s],a=e[s],c=ki(i,a);if(!c.valid)return{valid:!1};o.push(c.data)}return{valid:!0,data:o}}else return r===T.date&&n===T.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var cr=class extends U{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=(s,i)=>{if(zo(s)||zo(i))return j;let a=ki(s.value,i.value);return a.valid?((To(s)||To(i))&&r.dirty(),{status:r.value,value:a.data}):(S(n,{code:$.invalid_intersection_types}),j)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,i])=>o(s,i)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};cr.create=(t,e,r)=>new cr({left:t,right:e,typeName:w.ZodIntersection,...q(r)});var mt=class t extends U{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.array)return S(n,{code:$.invalid_type,expected:T.array,received:n.parsedType}),j;if(n.data.length<this._def.items.length)return S(n,{code:$.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),j;!this._def.rest&&n.data.length>this._def.items.length&&(S(n,{code:$.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Je(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(s).then(i=>be.mergeArray(r,i)):be.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};mt.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new mt({items:t,typeName:w.ZodTuple,rest:null,...q(e)})};var Eo=class t extends U{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.object)return S(n,{code:$.invalid_type,expected:T.object,received:n.parsedType}),j;let o=[],s=this._def.keyType,i=this._def.valueType;for(let a in n.data)o.push({key:s._parse(new Je(n,a,n.path,a)),value:i._parse(new Je(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?be.mergeObjectAsync(r,o):be.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof U?new t({keyType:e,valueType:r,typeName:w.ZodRecord,...q(n)}):new t({keyType:jt.create(),valueType:e,typeName:w.ZodRecord,...q(r)})}},Lr=class extends U{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.map)return S(n,{code:$.invalid_type,expected:T.map,received:n.parsedType}),j;let o=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:o._parse(new Je(n,a,n.path,[u,"key"])),value:s._parse(new Je(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return j;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return j;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}};Lr.create=(t,e,r)=>new Lr({valueType:e,keyType:t,typeName:w.ZodMap,...q(r)});var Ur=class t extends U{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.set)return S(n,{code:$.invalid_type,expected:T.set,received:n.parsedType}),j;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(S(n,{code:$.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(S(n,{code:$.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());let s=this._def.valueType;function i(c){let u=new Set;for(let l of c){if(l.status==="aborted")return j;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>s._parse(new Je(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:E.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:E.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Ur.create=(t,e)=>new Ur({valueType:t,minSize:null,maxSize:null,typeName:w.ZodSet,...q(e)});var Io=class t extends U{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.function)return S(r,{code:$.invalid_type,expected:T.function,received:r.parsedType}),j;function n(a,c){return vn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Zr(),wt].filter(u=>!!u),issueData:{code:$.invalid_arguments,argumentsError:c}})}function o(a,c){return vn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Zr(),wt].filter(u=>!!u),issueData:{code:$.invalid_return_type,returnTypeError:c}})}let s={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof At){let a=this;return Pe(async function(...c){let u=new Ae([]),l=await a._def.args.parseAsync(c,s).catch(f=>{throw u.addIssue(n(c,f)),u}),d=await Reflect.apply(i,this,l);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw u.addIssue(o(d,f)),u})})}else{let a=this;return Pe(function(...c){let u=a._def.args.safeParse(c,s);if(!u.success)throw new Ae([n(c,u.error)]);let l=Reflect.apply(i,this,u.data),d=a._def.returns.safeParse(l,s);if(!d.success)throw new Ae([o(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:mt.create(e).rest(St.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||mt.create([]).rest(St.create()),returns:r||St.create(),typeName:w.ZodFunction,...q(n)})}},ur=class extends U{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};ur.create=(t,e)=>new ur({getter:t,typeName:w.ZodLazy,...q(e)});var lr=class extends U{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return S(r,{received:r.data,code:$.invalid_literal,expected:this._def.value}),j}return{status:"valid",value:e.data}}get value(){return this._def.value}};lr.create=(t,e)=>new lr({value:t,typeName:w.ZodLiteral,...q(e)});function cd(t,e){return new dr({values:t,typeName:w.ZodEnum,...q(e)})}var dr=class t extends U{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return S(r,{expected:H.joinValues(n),received:r.parsedType,code:$.invalid_type}),j}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return S(r,{received:r.data,code:$.invalid_enum_value,options:n}),j}return Pe(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};dr.create=cd;var pr=class extends U{_parse(e){let r=H.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==T.string&&n.parsedType!==T.number){let o=H.objectValues(r);return S(n,{expected:H.joinValues(o),received:n.parsedType,code:$.invalid_type}),j}if(this._cache||(this._cache=new Set(H.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let o=H.objectValues(r);return S(n,{received:n.data,code:$.invalid_enum_value,options:o}),j}return Pe(e.data)}get enum(){return this._def.values}};pr.create=(t,e)=>new pr({values:t,typeName:w.ZodNativeEnum,...q(e)});var At=class extends U{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.promise&&r.common.async===!1)return S(r,{code:$.invalid_type,expected:T.promise,received:r.parsedType}),j;let n=r.parsedType===T.promise?r.data:Promise.resolve(r.data);return Pe(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};At.create=(t,e)=>new At({type:t,typeName:w.ZodPromise,...q(e)});var We=class extends U{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===w.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=this._def.effect||null,s={addIssue:i=>{S(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){let i=o.transform(n.data,s);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return j;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?j:c.status==="dirty"?er(c.value):r.value==="dirty"?er(c.value):c});{if(r.value==="aborted")return j;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?j:a.status==="dirty"?er(a.value):r.value==="dirty"?er(a.value):a}}if(o.type==="refinement"){let i=a=>{let c=o.refinement(a,s);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?j:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?j:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(o.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ot(i))return j;let a=o.transform(i.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>Ot(i)?Promise.resolve(o.transform(i.value,s)).then(a=>({status:r.value,value:a})):j);H.assertNever(o)}};We.create=(t,e,r)=>new We({schema:t,typeName:w.ZodEffects,effect:e,...q(r)});We.createWithPreprocess=(t,e,r)=>new We({schema:e,effect:{type:"preprocess",transform:t},typeName:w.ZodEffects,...q(r)});var Me=class extends U{_parse(e){return this._getType(e)===T.undefined?Pe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Me.create=(t,e)=>new Me({innerType:t,typeName:w.ZodOptional,...q(e)});var ht=class extends U{_parse(e){return this._getType(e)===T.null?Pe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ht.create=(t,e)=>new ht({innerType:t,typeName:w.ZodNullable,...q(e)});var fr=class extends U{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===T.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};fr.create=(t,e)=>new fr({innerType:t,typeName:w.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...q(e)});var mr=class extends U{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ar(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ae(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Ae(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};mr.create=(t,e)=>new mr({innerType:t,typeName:w.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...q(e)});var Vr=class extends U{_parse(e){if(this._getType(e)!==T.nan){let n=this._getOrReturnCtx(e);return S(n,{code:$.invalid_type,expected:T.nan,received:n.parsedType}),j}return{status:"valid",value:e.data}}};Vr.create=t=>new Vr({typeName:w.ZodNaN,...q(t)});var Dy=Symbol("zod_brand"),xn=class extends U{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},bn=class t extends U{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?j:s.status==="dirty"?(r.dirty(),er(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?j:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:w.ZodPipeline})}},hr=class extends U{_parse(e){let r=this._def.innerType._parse(e),n=o=>(Ot(o)&&(o.value=Object.freeze(o.value)),o);return Ar(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};hr.create=(t,e)=>new hr({innerType:t,typeName:w.ZodReadonly,...q(e)});function od(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function ud(t,e={},r){return t?Zt.create().superRefine((n,o)=>{let s=t(n);if(s instanceof Promise)return s.then(i=>{if(!i){let a=od(e,n),c=a.fatal??r??!0;o.addIssue({code:"custom",...a,fatal:c})}});if(!s){let i=od(e,n),a=i.fatal??r??!0;o.addIssue({code:"custom",...i,fatal:a})}}):Zt.create()}var qy={object:De.lazycreate},w;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(w||(w={}));var Ly=(t,e={message:`Input not instance of ${t.name}`})=>ud(r=>r instanceof t,e),ld=jt.create,dd=tr.create,Uy=Vr.create,Vy=rr.create,pd=nr.create,Fy=or.create,Ky=Dr.create,Hy=sr.create,By=ir.create,Gy=Zt.create,Jy=St.create,Wy=ot.create,Xy=qr.create,Yy=zt.create,Si=De.create,Qy=De.strictCreate,e_=ar.create,t_=Po.create,r_=cr.create,n_=mt.create,o_=Eo.create,s_=Lr.create,i_=Ur.create,a_=Io.create,c_=ur.create,u_=lr.create,l_=dr.create,d_=pr.create,p_=At.create,f_=We.create,m_=Me.create,h_=ht.create,g_=We.createWithPreprocess,y_=bn.create,__=()=>ld().optional(),v_=()=>dd().optional(),x_=()=>pd().optional(),b_={string:(t=>jt.create({...t,coerce:!0})),number:(t=>tr.create({...t,coerce:!0})),boolean:(t=>nr.create({...t,coerce:!0})),bigint:(t=>rr.create({...t,coerce:!0})),date:(t=>or.create({...t,coerce:!0}))};var $_=j;var w_=Object.freeze({status:"aborted"});function _(t,e,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(t),e(a,c);for(let l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}let o=r?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:t});function i(a){var c;let u=r?.Parent?new s:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}var Tt=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Co={};function Ke(t){return t&&Object.assign(Co,t),Co}var B={};bi(B,{BIGINT_FORMAT_RANGES:()=>md,Class:()=>Ti,NUMBER_FORMAT_RANGES:()=>Oi,aborted:()=>yr,allowsEval:()=>Ci,assert:()=>P_,assertEqual:()=>k_,assertIs:()=>z_,assertNever:()=>T_,assertNotEqual:()=>S_,assignProp:()=>Ii,cached:()=>kn,captureStackTrace:()=>No,cleanEnum:()=>L_,cleanRegex:()=>zn,clone:()=>He,createTransparentProxy:()=>O_,defineLazy:()=>oe,esc:()=>gr,escapeRegex:()=>Mt,extend:()=>A_,finalizeIssue:()=>st,floatSafeRemainder:()=>Ei,getElementAtPath:()=>E_,getEnumValues:()=>wn,getLengthableOrigin:()=>Tn,getParsedType:()=>N_,getSizableOrigin:()=>hd,isObject:()=>Fr,isPlainObject:()=>Kr,issue:()=>ji,joinValues:()=>Ro,jsonStringifyReplacer:()=>Pi,merge:()=>M_,normalizeParams:()=>Z,nullish:()=>Sn,numKeys:()=>R_,omit:()=>Z_,optionalKeys:()=>Ni,partial:()=>D_,pick:()=>j_,prefixIssues:()=>gt,primitiveTypes:()=>fd,promiseAllObject:()=>I_,propertyKeyTypes:()=>Ri,randomString:()=>C_,required:()=>q_,stringifyPrimitive:()=>Oo,unwrapMessage:()=>$n});function k_(t){return t}function S_(t){return t}function z_(t){}function T_(t){throw new Error}function P_(t){}function wn(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,o])=>e.indexOf(+n)===-1).map(([n,o])=>o)}function Ro(t,e="|"){return t.map(r=>Oo(r)).join(e)}function Pi(t,e){return typeof e=="bigint"?e.toString():e}function kn(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function Sn(t){return t==null}function zn(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function Ei(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}function oe(t,e,r){Object.defineProperty(t,e,{get(){{let o=r();return t[e]=o,o}throw new Error("cached value already set")},set(o){Object.defineProperty(t,e,{value:o})},configurable:!0})}function Ii(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function E_(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function I_(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let o={};for(let s=0;s<e.length;s++)o[e[s]]=n[s];return o})}function C_(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function gr(t){return JSON.stringify(t)}var No=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Fr(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Ci=kn(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Kr(t){if(Fr(t)===!1)return!1;let e=t.constructor;if(e===void 0)return!0;let r=e.prototype;return!(Fr(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function R_(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var N_=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},Ri=new Set(["string","number","symbol"]),fd=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Mt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function He(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function Z(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function O_(t){let e;return new Proxy({},{get(r,n,o){return e??(e=t()),Reflect.get(e,n,o)},set(r,n,o,s){return e??(e=t()),Reflect.set(e,n,o,s)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,o){return e??(e=t()),Reflect.defineProperty(e,n,o)}})}function Oo(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Ni(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var Oi={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},md={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function j_(t,e){let r={},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&(r[o]=n.shape[o])}return He(t,{...t._zod.def,shape:r,checks:[]})}function Z_(t,e){let r={...t._zod.def.shape},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&delete r[o]}return He(t,{...t._zod.def,shape:r,checks:[]})}function A_(t,e){if(!Kr(e))throw new Error("Invalid input to extend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return Ii(this,"shape",n),n},checks:[]};return He(t,r)}function M_(t,e){return He(t,{...t._zod.def,get shape(){let r={...t._zod.def.shape,...e._zod.def.shape};return Ii(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function D_(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in n))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=t?new t({type:"optional",innerType:n[s]}):n[s])}else for(let s in n)o[s]=t?new t({type:"optional",innerType:n[s]}):n[s];return He(e,{...e._zod.def,shape:o,checks:[]})}function q_(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=new t({type:"nonoptional",innerType:n[s]}))}else for(let s in n)o[s]=new t({type:"nonoptional",innerType:n[s]});return He(e,{...e._zod.def,shape:o,checks:[]})}function yr(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function gt(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function $n(t){return typeof t=="string"?t:t?.message}function st(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let o=$n(t.inst?._zod.def?.error?.(t))??$n(e?.error?.(t))??$n(r.customError?.(t))??$n(r.localeError?.(t))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function hd(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function Tn(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function ji(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function L_(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}var Ti=class{constructor(...e){}};var gd=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,Pi,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},jo=_("$ZodError",gd),Pn=_("$ZodError",gd,{Parent:Error});function Zi(t,e=r=>r.message){let r={},n=[];for(let o of t.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:r}}function Ai(t,e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>o({issues:a}));else if(i.code==="invalid_key")o({issues:i.issues});else if(i.code==="invalid_element")o({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(t),n}var Mi=t=>(e,r,n,o)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new Tt;if(i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>st(c,s,Ke())));throw No(a,o?.callee),a}return i.value},Di=Mi(Pn),qi=t=>async(e,r,n,o)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>st(c,s,Ke())));throw No(a,o?.callee),a}return i.value},Li=qi(Pn),Ui=t=>(e,r,n)=>{let o=n?{...n,async:!1}:{async:!1},s=e._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new Tt;return s.issues.length?{success:!1,error:new(t??jo)(s.issues.map(i=>st(i,o,Ke())))}:{success:!0,data:s.value}},_r=Ui(Pn),Vi=t=>async(e,r,n)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},s=e._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(i=>st(i,o,Ke())))}:{success:!0,data:s.value}},vr=Vi(Pn);var yd=/^[cC][^\s-]{8,}$/,_d=/^[0-9a-z]+$/,vd=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,xd=/^[0-9a-vA-V]{20}$/,bd=/^[A-Za-z0-9]{27}$/,$d=/^[a-zA-Z0-9_-]{21}$/,wd=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var kd=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Fi=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;var Sd=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;var V_="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function zd(){return new RegExp(V_,"u")}var Td=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Pd=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Ed=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Id=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Cd=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Ki=/^[A-Za-z0-9_-]*$/,Rd=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var Nd=/^\+(?:[0-9]){6,14}[0-9]$/,Od="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",jd=new RegExp(`^${Od}$`);function Zd(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Ad(t){return new RegExp(`^${Zd(t)}$`)}function Md(t){let e=Zd({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${Od}T(?:${n})$`)}var Dd=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)};var qd=/^\d+$/,Ld=/^-?\d+(?:\.\d+)?/i,Ud=/true|false/i,Vd=/null/i;var Fd=/^[^A-Z]*$/,Kd=/^[^a-z]*$/;var $e=_("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),Hd={number:"number",bigint:"bigint",object:"date"},Hi=_("$ZodCheckLessThan",(t,e)=>{$e.init(t,e);let r=Hd[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Bi=_("$ZodCheckGreaterThan",(t,e)=>{$e.init(t,e);let r=Hd[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Bd=_("$ZodCheckMultipleOf",(t,e)=>{$e.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):Ei(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),Gd=_("$ZodCheckNumberFormat",(t,e)=>{$e.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[o,s]=Oi[e.format];t._zod.onattach.push(i=>{let a=i._zod.bag;a.format=e.format,a.minimum=o,a.maximum=s,r&&(a.pattern=qd)}),t._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:e.format,code:"invalid_type",input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<o&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!e.abort}),a>s&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:t})}});var Jd=_("$ZodCheckMaxLength",(t,e)=>{var r;$e.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Sn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let o=n.value;if(o.length<=e.maximum)return;let i=Tn(o);n.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),Wd=_("$ZodCheckMinLength",(t,e)=>{var r;$e.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Sn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let o=n.value;if(o.length>=e.minimum)return;let i=Tn(o);n.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),Xd=_("$ZodCheckLengthEquals",(t,e)=>{var r;$e.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!Sn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag;o.minimum=e.length,o.maximum=e.length,o.length=e.length}),t._zod.check=n=>{let o=n.value,s=o.length;if(s===e.length)return;let i=Tn(o),a=s>e.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),En=_("$ZodCheckStringFormat",(t,e)=>{var r,n;$e.init(t,e),t._zod.onattach.push(o=>{let s=o._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=o=>{e.pattern.lastIndex=0,!e.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:e.format,input:o.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),Yd=_("$ZodCheckRegex",(t,e)=>{En.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),Qd=_("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Fd),En.init(t,e)}),ep=_("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Kd),En.init(t,e)}),tp=_("$ZodCheckIncludes",(t,e)=>{$e.init(t,e);let r=Mt(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(o=>{let s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),t._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:t,continue:!e.abort})}}),rp=_("$ZodCheckStartsWith",(t,e)=>{$e.init(t,e);let r=new RegExp(`^${Mt(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),np=_("$ZodCheckEndsWith",(t,e)=>{$e.init(t,e);let r=new RegExp(`.*${Mt(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});var op=_("$ZodCheckOverwrite",(t,e)=>{$e.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var Ao=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(i=>i),o=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(let i of s)this.content.push(i)}compile(){let e=Function,r=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...r,o.join(`
`))}};var ip={major:4,minor:0,patch:0};var te=_("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=ip;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let o of n)for(let s of o._zod.onattach)s(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let o=(s,i,a)=>{let c=yr(s),u;for(let l of i){if(l._zod.def.when){if(!l._zod.def.when(s))continue}else if(c)continue;let d=s.issues.length,h=l._zod.check(s);if(h instanceof Promise&&a?.async===!1)throw new Tt;if(u||h instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await h,s.issues.length!==d&&(c||(c=yr(s,d)))});else{if(s.issues.length===d)continue;c||(c=yr(s,d))}}return u?u.then(()=>s):s};t._zod.run=(s,i)=>{let a=t._zod.parse(s,i);if(a instanceof Promise){if(i.async===!1)throw new Tt;return a.then(c=>o(c,n,i))}return o(a,n,i)}}t["~standard"]={validate:o=>{try{let s=_r(t,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return vr(t,o).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),In=_("$ZodString",(t,e)=>{te.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Dd(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),se=_("$ZodStringFormat",(t,e)=>{En.init(t,e),In.init(t,e)}),Ji=_("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=kd),se.init(t,e)}),Wi=_("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Fi(n))}else e.pattern??(e.pattern=Fi());se.init(t,e)}),Xi=_("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=Sd),se.init(t,e)}),Yi=_("$ZodURL",(t,e)=>{se.init(t,e),t._zod.check=r=>{try{let n=r.value,o=new URL(n),s=o.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Rd.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&s.endsWith("/")?r.value=s.slice(0,-1):r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),Qi=_("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=zd()),se.init(t,e)}),ea=_("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=$d),se.init(t,e)}),ta=_("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=yd),se.init(t,e)}),ra=_("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=_d),se.init(t,e)}),na=_("$ZodULID",(t,e)=>{e.pattern??(e.pattern=vd),se.init(t,e)}),oa=_("$ZodXID",(t,e)=>{e.pattern??(e.pattern=xd),se.init(t,e)}),sa=_("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=bd),se.init(t,e)}),gp=_("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=Md(e)),se.init(t,e)}),yp=_("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=jd),se.init(t,e)}),_p=_("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=Ad(e)),se.init(t,e)}),vp=_("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=wd),se.init(t,e)}),ia=_("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=Td),se.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),aa=_("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Pd),se.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),ca=_("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Ed),se.init(t,e)}),ua=_("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Id),se.init(t,e),t._zod.check=r=>{let[n,o]=r.value.split("/");try{if(!o)throw new Error;let s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function xp(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var la=_("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Cd),se.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{xp(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function F_(t){if(!Ki.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return xp(r)}var da=_("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Ki),se.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{F_(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),pa=_("$ZodE164",(t,e)=>{e.pattern??(e.pattern=Nd),se.init(t,e)});function K_(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}var fa=_("$ZodJWT",(t,e)=>{se.init(t,e),t._zod.check=r=>{K_(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}});var Do=_("$ZodNumber",(t,e)=>{te.init(t,e),t._zod.pattern=t._zod.bag.pattern??Ld,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;let s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...s?{received:s}:{}}),r}}),ma=_("$ZodNumber",(t,e)=>{Gd.init(t,e),Do.init(t,e)}),ha=_("$ZodBoolean",(t,e)=>{te.init(t,e),t._zod.pattern=Ud,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),r}});var ga=_("$ZodNull",(t,e)=>{te.init(t,e),t._zod.pattern=Vd,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:t}),r}});var ya=_("$ZodUnknown",(t,e)=>{te.init(t,e),t._zod.parse=r=>r}),_a=_("$ZodNever",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function ap(t,e,r){t.issues.length&&e.issues.push(...gt(r,t.issues)),e.value[r]=t.value}var va=_("$ZodArray",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),r;r.value=Array(o.length);let s=[];for(let i=0;i<o.length;i++){let a=o[i],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?s.push(c.then(u=>ap(u,r,i))):ap(c,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function Mo(t,e,r){t.issues.length&&e.issues.push(...gt(r,t.issues)),e.value[r]=t.value}function cp(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...gt(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}var qo=_("$ZodObject",(t,e)=>{te.init(t,e);let r=kn(()=>{let d=Object.keys(e.shape);for(let f of d)if(!(e.shape[f]instanceof te))throw new Error(`Invalid element at key "${f}": expected a Zod schema`);let h=Ni(e.shape);return{shape:e.shape,keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(h)}});oe(t._zod,"propValues",()=>{let d=e.shape,h={};for(let f in d){let p=d[f]._zod;if(p.values){h[f]??(h[f]=new Set);for(let m of p.values)h[f].add(m)}}return h});let n=d=>{let h=new Ao(["shape","payload","ctx"]),f=r.value,p=x=>{let b=gr(x);return`shape[${b}]._zod.run({ value: input[${b}], issues: [] }, ctx)`};h.write("const input = payload.value;");let m=Object.create(null),g=0;for(let x of f.keys)m[x]=`key_${g++}`;h.write("const newResult = {}");for(let x of f.keys)if(f.optionalKeys.has(x)){let b=m[x];h.write(`const ${b} = ${p(x)};`);let k=gr(x);h.write(`
        if (${b}.issues.length) {
          if (input[${k}] === undefined) {
            if (${k} in input) {
              newResult[${k}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${b}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${k}, ...iss.path] : [${k}],
              }))
            );
          }
        } else if (${b}.value === undefined) {
          if (${k} in input) newResult[${k}] = undefined;
        } else {
          newResult[${k}] = ${b}.value;
        }
        `)}else{let b=m[x];h.write(`const ${b} = ${p(x)};`),h.write(`
          if (${b}.issues.length) payload.issues = payload.issues.concat(${b}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${gr(x)}, ...iss.path] : [${gr(x)}]
          })));`),h.write(`newResult[${gr(x)}] = ${b}.value`)}h.write("payload.value = newResult;"),h.write("return payload;");let v=h.compile();return(x,b)=>v(d,x,b)},o,s=Fr,i=!Co.jitless,c=i&&Ci.value,u=e.catchall,l;t._zod.parse=(d,h)=>{l??(l=r.value);let f=d.value;if(!s(f))return d.issues.push({expected:"object",code:"invalid_type",input:f,inst:t}),d;let p=[];if(i&&c&&h?.async===!1&&h.jitless!==!0)o||(o=n(e.shape)),d=o(d,h);else{d.value={};let b=l.shape;for(let k of l.keys){let N=b[k],he=N._zod.run({value:f[k],issues:[]},h),xe=N._zod.optin==="optional"&&N._zod.optout==="optional";he instanceof Promise?p.push(he.then(Ge=>xe?cp(Ge,d,k,f):Mo(Ge,d,k))):xe?cp(he,d,k,f):Mo(he,d,k)}}if(!u)return p.length?Promise.all(p).then(()=>d):d;let m=[],g=l.keySet,v=u._zod,x=v.def.type;for(let b of Object.keys(f)){if(g.has(b))continue;if(x==="never"){m.push(b);continue}let k=v.run({value:f[b],issues:[]},h);k instanceof Promise?p.push(k.then(N=>Mo(N,d,b))):Mo(k,d,b)}return m.length&&d.issues.push({code:"unrecognized_keys",keys:m,input:f,inst:t}),p.length?Promise.all(p).then(()=>d):d}});function up(t,e,r,n){for(let o of t)if(o.issues.length===0)return e.value=o.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(o=>o.issues.map(s=>st(s,n,Ke())))}),e}var Lo=_("$ZodUnion",(t,e)=>{te.init(t,e),oe(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),oe(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),oe(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),oe(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){let r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>zn(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let o=!1,s=[];for(let i of e.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)s.push(a),o=!0;else{if(a.issues.length===0)return a;s.push(a)}}return o?Promise.all(s).then(i=>up(i,r,t,n)):up(s,r,t,n)}}),xa=_("$ZodDiscriminatedUnion",(t,e)=>{Lo.init(t,e);let r=t._zod.parse;oe(t._zod,"propValues",()=>{let o={};for(let s of e.options){let i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(let[a,c]of Object.entries(i)){o[a]||(o[a]=new Set);for(let u of c)o[a].add(u)}}return o});let n=kn(()=>{let o=e.options,s=new Map;for(let i of o){let a=i._zod.propValues[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let c of a){if(s.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);s.set(c,i)}}return s});t._zod.parse=(o,s)=>{let i=o.value;if(!Fr(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),o;let a=n.value.get(i?.[e.discriminator]);return a?a._zod.run(o,s):e.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[e.discriminator],inst:t}),o)}}),ba=_("$ZodIntersection",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value,s=e.left._zod.run({value:o,issues:[]},n),i=e.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([c,u])=>lp(r,c,u)):lp(r,s,i)}});function Gi(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Kr(t)&&Kr(e)){let r=Object.keys(e),n=Object.keys(t).filter(s=>r.indexOf(s)!==-1),o={...t,...e};for(let s of n){let i=Gi(t[s],e[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let o=t[n],s=e[n],i=Gi(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function lp(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),yr(t))return t;let n=Gi(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var $a=_("$ZodRecord",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Kr(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:t}),r;let s=[];if(e.keyType._zod.values){let i=e.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=e.valueType._zod.run({value:o[c],issues:[]},n);u instanceof Promise?s.push(u.then(l=>{l.issues.length&&r.issues.push(...gt(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(...gt(c,u.issues)),r.value[c]=u.value)}let a;for(let c in o)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:t,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(o)){if(i==="__proto__")continue;let a=e.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>st(u,n,Ke())),input:i,path:[i],inst:t}),r.value[a.value]=a.value;continue}let c=e.valueType._zod.run({value:o[i],issues:[]},n);c instanceof Promise?s.push(c.then(u=>{u.issues.length&&r.issues.push(...gt(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...gt(i,c.issues)),r.value[a.value]=c.value)}}return s.length?Promise.all(s).then(()=>r):r}});var wa=_("$ZodEnum",(t,e)=>{te.init(t,e);let r=wn(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>Ri.has(typeof n)).map(n=>typeof n=="string"?Mt(n):n.toString()).join("|")})$`),t._zod.parse=(n,o)=>{let s=n.value;return t._zod.values.has(s)||n.issues.push({code:"invalid_value",values:r,input:s,inst:t}),n}}),ka=_("$ZodLiteral",(t,e)=>{te.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?Mt(r):r?r.toString():String(r)).join("|")})$`),t._zod.parse=(r,n)=>{let o=r.value;return t._zod.values.has(o)||r.issues.push({code:"invalid_value",values:e.values,input:o,inst:t}),r}});var Sa=_("$ZodTransform",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=e.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(r.value=i,r));if(o instanceof Promise)throw new Tt;return r.value=o,r}}),za=_("$ZodOptional",(t,e)=>{te.init(t,e),t._zod.optin="optional",t._zod.optout="optional",oe(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),oe(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${zn(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),Ta=_("$ZodNullable",(t,e)=>{te.init(t,e),oe(t._zod,"optin",()=>e.innerType._zod.optin),oe(t._zod,"optout",()=>e.innerType._zod.optout),oe(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${zn(r.source)}|null)$`):void 0}),oe(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),Pa=_("$ZodDefault",(t,e)=>{te.init(t,e),t._zod.optin="optional",oe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>dp(s,e)):dp(o,e)}});function dp(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var Ea=_("$ZodPrefault",(t,e)=>{te.init(t,e),t._zod.optin="optional",oe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),Ia=_("$ZodNonOptional",(t,e)=>{te.init(t,e),oe(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>pp(s,t)):pp(o,t)}});function pp(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var Ca=_("$ZodCatch",(t,e)=>{te.init(t,e),t._zod.optin="optional",oe(t._zod,"optout",()=>e.innerType._zod.optout),oe(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=e.catchValue({...r,error:{issues:s.issues.map(i=>st(i,n,Ke()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(s=>st(s,n,Ke()))},input:r.value}),r.issues=[]),r)}});var Ra=_("$ZodPipe",(t,e)=>{te.init(t,e),oe(t._zod,"values",()=>e.in._zod.values),oe(t._zod,"optin",()=>e.in._zod.optin),oe(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(r,n)=>{let o=e.in._zod.run(r,n);return o instanceof Promise?o.then(s=>fp(s,e,n)):fp(o,e,n)}});function fp(t,e,r){return yr(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}var Na=_("$ZodReadonly",(t,e)=>{te.init(t,e),oe(t._zod,"propValues",()=>e.innerType._zod.propValues),oe(t._zod,"values",()=>e.innerType._zod.values),oe(t._zod,"optin",()=>e.innerType._zod.optin),oe(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(mp):mp(o)}});function mp(t){return t.value=Object.freeze(t.value),t}var Oa=_("$ZodCustom",(t,e)=>{$e.init(t,e),te.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,o=e.fn(n);if(o instanceof Promise)return o.then(s=>hp(s,r,n,t));hp(o,r,n,t)}});function hp(t,e,r,n){if(!t){let o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),e.issues.push(ji(o))}}var H_=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},B_=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${H_(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${Oo(n.values[0])}`:`Invalid option: expected one of ${Ro(n.values,"|")}`;case"too_big":{let o=n.inclusive?"<=":"<",s=e(n.origin);return s?`Too big: expected ${n.origin??"value"} to have ${o}${n.maximum.toString()} ${s.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${o}${n.maximum.toString()}`}case"too_small":{let o=n.inclusive?">=":">",s=e(n.origin);return s?`Too small: expected ${n.origin} to have ${o}${n.minimum.toString()} ${s.unit}`:`Too small: expected ${n.origin} to be ${o}${n.minimum.toString()}`}case"invalid_format":{let o=n;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${Ro(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function bp(){return{localeError:B_()}}var Cn=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function $p(){return new Cn}var Dt=$p();function ja(t,e){return new t({type:"string",...Z(e)})}function Za(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...Z(e)})}function Uo(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...Z(e)})}function Aa(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...Z(e)})}function Ma(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Z(e)})}function Da(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Z(e)})}function qa(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Z(e)})}function La(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...Z(e)})}function Ua(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...Z(e)})}function Va(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...Z(e)})}function Fa(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...Z(e)})}function Ka(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...Z(e)})}function Ha(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...Z(e)})}function Ba(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...Z(e)})}function Ga(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...Z(e)})}function Ja(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...Z(e)})}function Wa(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...Z(e)})}function Xa(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Z(e)})}function Ya(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Z(e)})}function Qa(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...Z(e)})}function ec(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...Z(e)})}function tc(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...Z(e)})}function rc(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...Z(e)})}function wp(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Z(e)})}function kp(t,e){return new t({type:"string",format:"date",check:"string_format",...Z(e)})}function Sp(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...Z(e)})}function zp(t,e){return new t({type:"string",format:"duration",check:"string_format",...Z(e)})}function nc(t,e){return new t({type:"number",checks:[],...Z(e)})}function oc(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...Z(e)})}function sc(t,e){return new t({type:"boolean",...Z(e)})}function ic(t,e){return new t({type:"null",...Z(e)})}function ac(t){return new t({type:"unknown"})}function cc(t,e){return new t({type:"never",...Z(e)})}function Vo(t,e){return new Hi({check:"less_than",...Z(e),value:t,inclusive:!1})}function Rn(t,e){return new Hi({check:"less_than",...Z(e),value:t,inclusive:!0})}function Fo(t,e){return new Bi({check:"greater_than",...Z(e),value:t,inclusive:!1})}function Nn(t,e){return new Bi({check:"greater_than",...Z(e),value:t,inclusive:!0})}function Ko(t,e){return new Bd({check:"multiple_of",...Z(e),value:t})}function Ho(t,e){return new Jd({check:"max_length",...Z(e),maximum:t})}function Hr(t,e){return new Wd({check:"min_length",...Z(e),minimum:t})}function Bo(t,e){return new Xd({check:"length_equals",...Z(e),length:t})}function uc(t,e){return new Yd({check:"string_format",format:"regex",...Z(e),pattern:t})}function lc(t){return new Qd({check:"string_format",format:"lowercase",...Z(t)})}function dc(t){return new ep({check:"string_format",format:"uppercase",...Z(t)})}function pc(t,e){return new tp({check:"string_format",format:"includes",...Z(e),includes:t})}function fc(t,e){return new rp({check:"string_format",format:"starts_with",...Z(e),prefix:t})}function mc(t,e){return new np({check:"string_format",format:"ends_with",...Z(e),suffix:t})}function xr(t){return new op({check:"overwrite",tx:t})}function hc(t){return xr(e=>e.normalize(t))}function gc(){return xr(t=>t.trim())}function yc(){return xr(t=>t.toLowerCase())}function _c(){return xr(t=>t.toUpperCase())}function Tp(t,e,r){return new t({type:"array",element:e,...Z(r)})}function vc(t,e,r){let n=Z(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function xc(t,e,r){return new t({type:"custom",check:"custom",fn:e,...Z(r)})}var Go=class{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??Dt,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,r={path:[],schemaPath:[]}){var n;let o=e._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(e);if(i)return i.count++,r.schemaPath.includes(e)&&(i.cycle=r.path),i.schema;let a={schema:{},count:1,cycle:void 0,path:r.path};this.seen.set(e,a);let c=e._zod.toJSONSchema?.();if(c)a.schema=c;else{let d={...r,schemaPath:[...r.schemaPath,e],path:r.path},h=e._zod.parent;if(h)a.ref=h,this.process(h,d),this.seen.get(h).isParent=!0;else{let f=a.schema;switch(o.type){case"string":{let p=f;p.type="string";let{minimum:m,maximum:g,format:v,patterns:x,contentEncoding:b}=e._zod.bag;if(typeof m=="number"&&(p.minLength=m),typeof g=="number"&&(p.maxLength=g),v&&(p.format=s[v]??v,p.format===""&&delete p.format),b&&(p.contentEncoding=b),x&&x.size>0){let k=[...x];k.length===1?p.pattern=k[0].source:k.length>1&&(a.schema.allOf=[...k.map(N=>({...this.target==="draft-7"?{type:"string"}:{},pattern:N.source}))])}break}case"number":{let p=f,{minimum:m,maximum:g,format:v,multipleOf:x,exclusiveMaximum:b,exclusiveMinimum:k}=e._zod.bag;typeof v=="string"&&v.includes("int")?p.type="integer":p.type="number",typeof k=="number"&&(p.exclusiveMinimum=k),typeof m=="number"&&(p.minimum=m,typeof k=="number"&&(k>=m?delete p.minimum:delete p.exclusiveMinimum)),typeof b=="number"&&(p.exclusiveMaximum=b),typeof g=="number"&&(p.maximum=g,typeof b=="number"&&(b<=g?delete p.maximum:delete p.exclusiveMaximum)),typeof x=="number"&&(p.multipleOf=x);break}case"boolean":{let p=f;p.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{f.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{f.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let p=f,{minimum:m,maximum:g}=e._zod.bag;typeof m=="number"&&(p.minItems=m),typeof g=="number"&&(p.maxItems=g),p.type="array",p.items=this.process(o.element,{...d,path:[...d.path,"items"]});break}case"object":{let p=f;p.type="object",p.properties={};let m=o.shape;for(let x in m)p.properties[x]=this.process(m[x],{...d,path:[...d.path,"properties",x]});let g=new Set(Object.keys(m)),v=new Set([...g].filter(x=>{let b=o.shape[x]._zod;return this.io==="input"?b.optin===void 0:b.optout===void 0}));v.size>0&&(p.required=Array.from(v)),o.catchall?._zod.def.type==="never"?p.additionalProperties=!1:o.catchall?o.catchall&&(p.additionalProperties=this.process(o.catchall,{...d,path:[...d.path,"additionalProperties"]})):this.io==="output"&&(p.additionalProperties=!1);break}case"union":{let p=f;p.anyOf=o.options.map((m,g)=>this.process(m,{...d,path:[...d.path,"anyOf",g]}));break}case"intersection":{let p=f,m=this.process(o.left,{...d,path:[...d.path,"allOf",0]}),g=this.process(o.right,{...d,path:[...d.path,"allOf",1]}),v=b=>"allOf"in b&&Object.keys(b).length===1,x=[...v(m)?m.allOf:[m],...v(g)?g.allOf:[g]];p.allOf=x;break}case"tuple":{let p=f;p.type="array";let m=o.items.map((x,b)=>this.process(x,{...d,path:[...d.path,"prefixItems",b]}));if(this.target==="draft-2020-12"?p.prefixItems=m:p.items=m,o.rest){let x=this.process(o.rest,{...d,path:[...d.path,"items"]});this.target==="draft-2020-12"?p.items=x:p.additionalItems=x}o.rest&&(p.items=this.process(o.rest,{...d,path:[...d.path,"items"]}));let{minimum:g,maximum:v}=e._zod.bag;typeof g=="number"&&(p.minItems=g),typeof v=="number"&&(p.maxItems=v);break}case"record":{let p=f;p.type="object",p.propertyNames=this.process(o.keyType,{...d,path:[...d.path,"propertyNames"]}),p.additionalProperties=this.process(o.valueType,{...d,path:[...d.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let p=f,m=wn(o.entries);m.every(g=>typeof g=="number")&&(p.type="number"),m.every(g=>typeof g=="string")&&(p.type="string"),p.enum=m;break}case"literal":{let p=f,m=[];for(let g of o.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");m.push(Number(g))}else m.push(g);if(m.length!==0)if(m.length===1){let g=m[0];p.type=g===null?"null":typeof g,p.const=g}else m.every(g=>typeof g=="number")&&(p.type="number"),m.every(g=>typeof g=="string")&&(p.type="string"),m.every(g=>typeof g=="boolean")&&(p.type="string"),m.every(g=>g===null)&&(p.type="null"),p.enum=m;break}case"file":{let p=f,m={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:v,mime:x}=e._zod.bag;g!==void 0&&(m.minLength=g),v!==void 0&&(m.maxLength=v),x?x.length===1?(m.contentMediaType=x[0],Object.assign(p,m)):p.anyOf=x.map(b=>({...m,contentMediaType:b})):Object.assign(p,m);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let p=this.process(o.innerType,d);f.anyOf=[p,{type:"null"}];break}case"nonoptional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"success":{let p=f;p.type="boolean";break}case"default":{this.process(o.innerType,d),a.ref=o.innerType,f.default=JSON.parse(JSON.stringify(o.defaultValue));break}case"prefault":{this.process(o.innerType,d),a.ref=o.innerType,this.io==="input"&&(f._prefault=JSON.parse(JSON.stringify(o.defaultValue)));break}case"catch":{this.process(o.innerType,d),a.ref=o.innerType;let p;try{p=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}f.default=p;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let p=f,m=e._zod.pattern;if(!m)throw new Error("Pattern not found in template literal");p.type="string",p.pattern=m.source;break}case"pipe":{let p=this.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;this.process(p,d),a.ref=p;break}case"readonly":{this.process(o.innerType,d),a.ref=o.innerType,f.readOnly=!0;break}case"promise":{this.process(o.innerType,d),a.ref=o.innerType;break}case"optional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"lazy":{let p=e._zod.innerType;this.process(p,d),a.ref=p;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}default:}}}let u=this.metadataRegistry.get(e);return u&&Object.assign(a.schema,u),this.io==="input"&&ye(e)&&(delete a.schema.examples,delete a.schema.default),this.io==="input"&&a.schema._prefault&&((n=a.schema).default??(n.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(e).schema}emit(e,r){let n={cycles:r?.cycles??"ref",reused:r?.reused??"inline",external:r?.external??void 0},o=this.seen.get(e);if(!o)throw new Error("Unprocessed schema. This is a bug in Zod.");let s=l=>{let d=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){let m=n.external.registry.get(l[0])?.id,g=n.external.uri??(x=>x);if(m)return{ref:g(m)};let v=l[1].defId??l[1].schema.id??`schema${this.counter++}`;return l[1].defId=v,{defId:v,ref:`${g("__shared")}#/${d}/${v}`}}if(l[1]===o)return{ref:"#"};let f=`#/${d}/`,p=l[1].schema.id??`__schema${this.counter++}`;return{defId:p,ref:f+p}},i=l=>{if(l[1].schema.$ref)return;let d=l[1],{ref:h,defId:f}=s(l);d.def={...d.schema},f&&(d.defId=f);let p=d.schema;for(let m in p)delete p[m];p.$ref=h};if(n.cycles==="throw")for(let l of this.seen.entries()){let d=l[1];if(d.cycle)throw new Error(`Cycle detected: #/${d.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let l of this.seen.entries()){let d=l[1];if(e===l[0]){i(l);continue}if(n.external){let f=n.external.registry.get(l[0])?.id;if(e!==l[0]&&f){i(l);continue}}if(this.metadataRegistry.get(l[0])?.id){i(l);continue}if(d.cycle){i(l);continue}if(d.count>1&&n.reused==="ref"){i(l);continue}}let a=(l,d)=>{let h=this.seen.get(l),f=h.def??h.schema,p={...f};if(h.ref===null)return;let m=h.ref;if(h.ref=null,m){a(m,d);let g=this.seen.get(m).schema;g.$ref&&d.target==="draft-7"?(f.allOf=f.allOf??[],f.allOf.push(g)):(Object.assign(f,g),Object.assign(f,p))}h.isParent||this.override({zodSchema:l,jsonSchema:f,path:h.path??[]})};for(let l of[...this.seen.entries()].reverse())a(l[0],{target:this.target});let c={};if(this.target==="draft-2020-12"?c.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?c.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),n.external?.uri){let l=n.external.registry.get(e)?.id;if(!l)throw new Error("Schema is missing an `id` property");c.$id=n.external.uri(l)}Object.assign(c,o.def);let u=n.external?.defs??{};for(let l of this.seen.entries()){let d=l[1];d.def&&d.defId&&(u[d.defId]=d.def)}n.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?c.$defs=u:c.definitions=u);try{return JSON.parse(JSON.stringify(c))}catch{throw new Error("Error converting schema to JSON.")}}};function bc(t,e){if(t instanceof Cn){let n=new Go(e),o={};for(let a of t._idmap.entries()){let[c,u]=a;n.process(u)}let s={},i={registry:t,uri:e?.uri,defs:o};for(let a of t._idmap.entries()){let[c,u]=a;s[c]=n.emit(u,{...e,external:i})}if(Object.keys(o).length>0){let a=n.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[a]:o}}return{schemas:s}}let r=new Go(e);return r.process(t),r.emit(t,e)}function ye(t,e){let r=e??{seen:new Set};if(r.seen.has(t))return!1;r.seen.add(t);let o=t._zod.def;switch(o.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return ye(o.element,r);case"object":{for(let s in o.shape)if(ye(o.shape[s],r))return!0;return!1}case"union":{for(let s of o.options)if(ye(s,r))return!0;return!1}case"intersection":return ye(o.left,r)||ye(o.right,r);case"tuple":{for(let s of o.items)if(ye(s,r))return!0;return!!(o.rest&&ye(o.rest,r))}case"record":return ye(o.keyType,r)||ye(o.valueType,r);case"map":return ye(o.keyType,r)||ye(o.valueType,r);case"set":return ye(o.valueType,r);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return ye(o.innerType,r);case"lazy":return ye(o.getter(),r);case"default":return ye(o.innerType,r);case"prefault":return ye(o.innerType,r);case"custom":return!1;case"transform":return!0;case"pipe":return ye(o.in,r)||ye(o.out,r);case"success":return!1;case"catch":return!1;default:}throw new Error(`Unknown schema type: ${o.type}`)}var Pv=_("ZodMiniType",(t,e)=>{if(!t._zod)throw new Error("Uninitialized schema in ZodMiniType.");te.init(t,e),t.def=e,t.parse=(r,n)=>Di(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>_r(t,r,n),t.parseAsync=async(r,n)=>Li(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>vr(t,r,n),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>He(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t))});var Ev=_("ZodMiniObject",(t,e)=>{qo.init(t,e),Pv.init(t,e),B.defineLazy(t,"shape",()=>e.shape)});function $c(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new Ev(r)}function Xe(t){return!!t._zod}function $r(t){let e=Object.values(t);if(e.length===0)return $c({});let r=e.every(Xe),n=e.every(o=>!Xe(o));if(r)return $c(t);if(n)return Si(t);throw new Error("Mixed Zod versions detected in object shape.")}function qt(t,e){return Xe(t)?_r(t,e):t.safeParse(e)}async function Jo(t,e){return Xe(t)?await vr(t,e):await t.safeParseAsync(e)}function Lt(t){if(!t)return;let e;if(Xe(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function Br(t){if(t){if(typeof t=="object"){let e=t,r=t;if(!e._def&&!r._zod){let n=Object.values(t);if(n.length>0&&n.every(o=>typeof o=="object"&&o!==null&&(o._def!==void 0||o._zod!==void 0||typeof o.parse=="function")))return $r(t)}}if(Xe(t)){let r=t._zod?.def;if(r&&(r.type==="object"||r.shape!==void 0))return t}else if(t.shape!==void 0)return t}}function Wo(t){if(t&&typeof t=="object"){if("message"in t&&typeof t.message=="string")return t.message;if("issues"in t&&Array.isArray(t.issues)&&t.issues.length>0){let e=t.issues[0];if(e&&typeof e=="object"&&"message"in e)return String(e.message)}try{return JSON.stringify(t)}catch{return String(t)}}return String(t)}function Ep(t){return t.description}function Ip(t){if(Xe(t))return t._zod?.def?.type==="optional";let e=t;return typeof t.isOptional=="function"?t.isOptional():e._def?.typeName==="ZodOptional"}function Xo(t){if(Xe(t)){let s=t._zod?.def;if(s){if(s.value!==void 0)return s.value;if(Array.isArray(s.values)&&s.values.length>0)return s.values[0]}}let r=t._def;if(r){if(r.value!==void 0)return r.value;if(Array.isArray(r.values)&&r.values.length>0)return r.values[0]}let n=t.value;if(n!==void 0)return n}var On={};bi(On,{ZodISODate:()=>Rp,ZodISODateTime:()=>Cp,ZodISODuration:()=>Op,ZodISOTime:()=>Np,date:()=>kc,datetime:()=>wc,duration:()=>zc,time:()=>Sc});var Cp=_("ZodISODateTime",(t,e)=>{gp.init(t,e),ue.init(t,e)});function wc(t){return wp(Cp,t)}var Rp=_("ZodISODate",(t,e)=>{yp.init(t,e),ue.init(t,e)});function kc(t){return kp(Rp,t)}var Np=_("ZodISOTime",(t,e)=>{_p.init(t,e),ue.init(t,e)});function Sc(t){return Sp(Np,t)}var Op=_("ZodISODuration",(t,e)=>{vp.init(t,e),ue.init(t,e)});function zc(t){return zp(Op,t)}var jp=(t,e)=>{jo.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>Ai(t,r)},flatten:{value:r=>Zi(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},eE=_("ZodError",jp),jn=_("ZodError",jp,{Parent:Error});var Zp=Mi(jn),Ap=qi(jn),Mp=Ui(jn),Dp=Vi(jn);var me=_("ZodType",(t,e)=>(te.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>He(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>Zp(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Mp(t,r,n),t.parseAsync=async(r,n)=>Ap(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>Dp(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(zx(r,n)),t.superRefine=r=>t.check(Tx(r)),t.overwrite=r=>t.check(xr(r)),t.optional=()=>fe(t),t.nullable=()=>Up(t),t.nullish=()=>fe(Up(t)),t.nonoptional=r=>vx(t,r),t.array=()=>G(t),t.or=r=>ie([t,r]),t.and=r=>Qo(t,r),t.transform=r=>Pc(t,Bp(r)),t.default=r=>gx(t,r),t.prefault=r=>_x(t,r),t.catch=r=>bx(t,r),t.pipe=r=>Pc(t,r),t.readonly=()=>kx(t),t.describe=r=>{let n=t.clone();return Dt.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return Dt.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return Dt.get(t);let n=t.clone();return Dt.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Vp=_("_ZodString",(t,e)=>{In.init(t,e),me.init(t,e);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(uc(...n)),t.includes=(...n)=>t.check(pc(...n)),t.startsWith=(...n)=>t.check(fc(...n)),t.endsWith=(...n)=>t.check(mc(...n)),t.min=(...n)=>t.check(Hr(...n)),t.max=(...n)=>t.check(Ho(...n)),t.length=(...n)=>t.check(Bo(...n)),t.nonempty=(...n)=>t.check(Hr(1,...n)),t.lowercase=n=>t.check(lc(n)),t.uppercase=n=>t.check(dc(n)),t.trim=()=>t.check(gc()),t.normalize=(...n)=>t.check(hc(...n)),t.toLowerCase=()=>t.check(yc()),t.toUpperCase=()=>t.check(_c())}),Mv=_("ZodString",(t,e)=>{In.init(t,e),Vp.init(t,e),t.email=r=>t.check(Za(Dv,r)),t.url=r=>t.check(La(qv,r)),t.jwt=r=>t.check(rc(tx,r)),t.emoji=r=>t.check(Ua(Lv,r)),t.guid=r=>t.check(Uo(qp,r)),t.uuid=r=>t.check(Aa(Yo,r)),t.uuidv4=r=>t.check(Ma(Yo,r)),t.uuidv6=r=>t.check(Da(Yo,r)),t.uuidv7=r=>t.check(qa(Yo,r)),t.nanoid=r=>t.check(Va(Uv,r)),t.guid=r=>t.check(Uo(qp,r)),t.cuid=r=>t.check(Fa(Vv,r)),t.cuid2=r=>t.check(Ka(Fv,r)),t.ulid=r=>t.check(Ha(Kv,r)),t.base64=r=>t.check(Qa(Yv,r)),t.base64url=r=>t.check(ec(Qv,r)),t.xid=r=>t.check(Ba(Hv,r)),t.ksuid=r=>t.check(Ga(Bv,r)),t.ipv4=r=>t.check(Ja(Gv,r)),t.ipv6=r=>t.check(Wa(Jv,r)),t.cidrv4=r=>t.check(Xa(Wv,r)),t.cidrv6=r=>t.check(Ya(Xv,r)),t.e164=r=>t.check(tc(ex,r)),t.datetime=r=>t.check(wc(r)),t.date=r=>t.check(kc(r)),t.time=r=>t.check(Sc(r)),t.duration=r=>t.check(zc(r))});function y(t){return ja(Mv,t)}var ue=_("ZodStringFormat",(t,e)=>{se.init(t,e),Vp.init(t,e)}),Dv=_("ZodEmail",(t,e)=>{Xi.init(t,e),ue.init(t,e)});var qp=_("ZodGUID",(t,e)=>{Ji.init(t,e),ue.init(t,e)});var Yo=_("ZodUUID",(t,e)=>{Wi.init(t,e),ue.init(t,e)});var qv=_("ZodURL",(t,e)=>{Yi.init(t,e),ue.init(t,e)});var Lv=_("ZodEmoji",(t,e)=>{Qi.init(t,e),ue.init(t,e)});var Uv=_("ZodNanoID",(t,e)=>{ea.init(t,e),ue.init(t,e)});var Vv=_("ZodCUID",(t,e)=>{ta.init(t,e),ue.init(t,e)});var Fv=_("ZodCUID2",(t,e)=>{ra.init(t,e),ue.init(t,e)});var Kv=_("ZodULID",(t,e)=>{na.init(t,e),ue.init(t,e)});var Hv=_("ZodXID",(t,e)=>{oa.init(t,e),ue.init(t,e)});var Bv=_("ZodKSUID",(t,e)=>{sa.init(t,e),ue.init(t,e)});var Gv=_("ZodIPv4",(t,e)=>{ia.init(t,e),ue.init(t,e)});var Jv=_("ZodIPv6",(t,e)=>{aa.init(t,e),ue.init(t,e)});var Wv=_("ZodCIDRv4",(t,e)=>{ca.init(t,e),ue.init(t,e)});var Xv=_("ZodCIDRv6",(t,e)=>{ua.init(t,e),ue.init(t,e)});var Yv=_("ZodBase64",(t,e)=>{la.init(t,e),ue.init(t,e)});var Qv=_("ZodBase64URL",(t,e)=>{da.init(t,e),ue.init(t,e)});var ex=_("ZodE164",(t,e)=>{pa.init(t,e),ue.init(t,e)});var tx=_("ZodJWT",(t,e)=>{fa.init(t,e),ue.init(t,e)});var Fp=_("ZodNumber",(t,e)=>{Do.init(t,e),me.init(t,e),t.gt=(n,o)=>t.check(Fo(n,o)),t.gte=(n,o)=>t.check(Nn(n,o)),t.min=(n,o)=>t.check(Nn(n,o)),t.lt=(n,o)=>t.check(Vo(n,o)),t.lte=(n,o)=>t.check(Rn(n,o)),t.max=(n,o)=>t.check(Rn(n,o)),t.int=n=>t.check(Lp(n)),t.safe=n=>t.check(Lp(n)),t.positive=n=>t.check(Fo(0,n)),t.nonnegative=n=>t.check(Nn(0,n)),t.negative=n=>t.check(Vo(0,n)),t.nonpositive=n=>t.check(Rn(0,n)),t.multipleOf=(n,o)=>t.check(Ko(n,o)),t.step=(n,o)=>t.check(Ko(n,o)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function ee(t){return nc(Fp,t)}var rx=_("ZodNumberFormat",(t,e)=>{ma.init(t,e),Fp.init(t,e)});function Lp(t){return oc(rx,t)}var nx=_("ZodBoolean",(t,e)=>{ha.init(t,e),me.init(t,e)});function ve(t){return sc(nx,t)}var ox=_("ZodNull",(t,e)=>{ga.init(t,e),me.init(t,e)});function Ec(t){return ic(ox,t)}var sx=_("ZodUnknown",(t,e)=>{ya.init(t,e),me.init(t,e)});function le(){return ac(sx)}var ix=_("ZodNever",(t,e)=>{_a.init(t,e),me.init(t,e)});function ax(t){return cc(ix,t)}var cx=_("ZodArray",(t,e)=>{va.init(t,e),me.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Hr(r,n)),t.nonempty=r=>t.check(Hr(1,r)),t.max=(r,n)=>t.check(Ho(r,n)),t.length=(r,n)=>t.check(Bo(r,n)),t.unwrap=()=>t.element});function G(t,e){return Tp(cx,t,e)}var Kp=_("ZodObject",(t,e)=>{qo.init(t,e),me.init(t,e),B.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>qe(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:le()}),t.loose=()=>t.clone({...t._zod.def,catchall:le()}),t.strict=()=>t.clone({...t._zod.def,catchall:ax()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>B.extend(t,r),t.merge=r=>B.merge(t,r),t.pick=r=>B.pick(t,r),t.omit=r=>B.omit(t,r),t.partial=(...r)=>B.partial(Gp,t,r[0]),t.required=(...r)=>B.required(Jp,t,r[0])});function P(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new Kp(r)}function Ne(t,e){return new Kp({type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},catchall:le(),...B.normalizeParams(e)})}var Hp=_("ZodUnion",(t,e)=>{Lo.init(t,e),me.init(t,e),t.options=e.options});function ie(t,e){return new Hp({type:"union",options:t,...B.normalizeParams(e)})}var ux=_("ZodDiscriminatedUnion",(t,e)=>{Hp.init(t,e),xa.init(t,e)});function Ic(t,e,r){return new ux({type:"union",options:e,discriminator:t,...B.normalizeParams(r)})}var lx=_("ZodIntersection",(t,e)=>{ba.init(t,e),me.init(t,e)});function Qo(t,e){return new lx({type:"intersection",left:t,right:e})}var dx=_("ZodRecord",(t,e)=>{$a.init(t,e),me.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function de(t,e,r){return new dx({type:"record",keyType:t,valueType:e,...B.normalizeParams(r)})}var Tc=_("ZodEnum",(t,e)=>{wa.init(t,e),me.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,o)=>{let s={};for(let i of n)if(r.has(i))s[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new Tc({...e,checks:[],...B.normalizeParams(o),entries:s})},t.exclude=(n,o)=>{let s={...e.entries};for(let i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new Tc({...e,checks:[],...B.normalizeParams(o),entries:s})}});function qe(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new Tc({type:"enum",entries:r,...B.normalizeParams(e)})}var px=_("ZodLiteral",(t,e)=>{ka.init(t,e),me.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function C(t,e){return new px({type:"literal",values:Array.isArray(t)?t:[t],...B.normalizeParams(e)})}var fx=_("ZodTransform",(t,e)=>{Sa.init(t,e),me.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=s=>{if(typeof s=="string")r.issues.push(B.issue(s,r.value,e));else{let i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=t),i.continue??(i.continue=!0),r.issues.push(B.issue(i))}};let o=e.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});function Bp(t){return new fx({type:"transform",transform:t})}var Gp=_("ZodOptional",(t,e)=>{za.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType});function fe(t){return new Gp({type:"optional",innerType:t})}var mx=_("ZodNullable",(t,e)=>{Ta.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Up(t){return new mx({type:"nullable",innerType:t})}var hx=_("ZodDefault",(t,e)=>{Pa.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function gx(t,e){return new hx({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var yx=_("ZodPrefault",(t,e)=>{Ea.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType});function _x(t,e){return new yx({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var Jp=_("ZodNonOptional",(t,e)=>{Ia.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType});function vx(t,e){return new Jp({type:"nonoptional",innerType:t,...B.normalizeParams(e)})}var xx=_("ZodCatch",(t,e)=>{Ca.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function bx(t,e){return new xx({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var $x=_("ZodPipe",(t,e)=>{Ra.init(t,e),me.init(t,e),t.in=e.in,t.out=e.out});function Pc(t,e){return new $x({type:"pipe",in:t,out:e})}var wx=_("ZodReadonly",(t,e)=>{Na.init(t,e),me.init(t,e)});function kx(t){return new wx({type:"readonly",innerType:t})}var Wp=_("ZodCustom",(t,e)=>{Oa.init(t,e),me.init(t,e)});function Sx(t){let e=new $e({check:"custom"});return e._zod.check=t,e}function Xp(t,e){return vc(Wp,t??(()=>!0),e)}function zx(t,e={}){return xc(Wp,t,e)}function Tx(t){let e=Sx(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(B.issue(n,r.value,e._zod.def));else{let o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=e),o.continue??(o.continue=!e._zod.def.abort),r.issues.push(B.issue(o))}},t(r.value,r)));return e}function Cc(t,e){return Pc(Bp(t),e)}Ke(bp());var Nc="2025-11-25";var Yp=[Nc,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Ut="io.modelcontextprotocol/related-task",ts="2.0",we=Xp(t=>t!==null&&(typeof t=="object"||typeof t=="function")),Qp=ie([y(),ee().int()]),ef=y(),mE=Ne({ttl:ie([ee(),Ec()]).optional(),pollInterval:ee().optional()}),Px=P({ttl:ee().optional()}),Ex=P({taskId:y()}),Oc=Ne({progressToken:Qp.optional(),[Ut]:Ex.optional()}),Be=P({_meta:Oc.optional()}),Zn=Be.extend({task:Px.optional()}),tf=t=>Zn.safeParse(t).success,ke=P({method:y(),params:Be.loose().optional()}),Ye=P({_meta:Oc.optional()}),Qe=P({method:y(),params:Ye.loose().optional()}),Se=Ne({_meta:Oc.optional()}),rs=ie([y(),ee().int()]),rf=P({jsonrpc:C(ts),id:rs,...ke.shape}).strict(),jc=t=>rf.safeParse(t).success,nf=P({jsonrpc:C(ts),...Qe.shape}).strict(),of=t=>nf.safeParse(t).success,Zc=P({jsonrpc:C(ts),id:rs,result:Se}).strict(),An=t=>Zc.safeParse(t).success;var O;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(O||(O={}));var Ac=P({jsonrpc:C(ts),id:rs.optional(),error:P({code:ee().int(),message:y(),data:le().optional()})}).strict();var sf=t=>Ac.safeParse(t).success;var af=ie([rf,nf,Zc,Ac]),hE=ie([Zc,Ac]),ns=Se.strict(),Ix=Ye.extend({requestId:rs.optional(),reason:y().optional()}),os=Qe.extend({method:C("notifications/cancelled"),params:Ix}),Cx=P({src:y(),mimeType:y().optional(),sizes:G(y()).optional(),theme:qe(["light","dark"]).optional()}),Mn=P({icons:G(Cx).optional()}),Gr=P({name:y(),title:y().optional()}),cf=Gr.extend({...Gr.shape,...Mn.shape,version:y(),websiteUrl:y().optional(),description:y().optional()}),Rx=Qo(P({applyDefaults:ve().optional()}),de(y(),le())),Nx=Cc(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,Qo(P({form:Rx.optional(),url:we.optional()}),de(y(),le()).optional())),Ox=Ne({list:we.optional(),cancel:we.optional(),requests:Ne({sampling:Ne({createMessage:we.optional()}).optional(),elicitation:Ne({create:we.optional()}).optional()}).optional()}),jx=Ne({list:we.optional(),cancel:we.optional(),requests:Ne({tools:Ne({call:we.optional()}).optional()}).optional()}),Zx=P({experimental:de(y(),we).optional(),sampling:P({context:we.optional(),tools:we.optional()}).optional(),elicitation:Nx.optional(),roots:P({listChanged:ve().optional()}).optional(),tasks:Ox.optional()}),Ax=Be.extend({protocolVersion:y(),capabilities:Zx,clientInfo:cf}),Mc=ke.extend({method:C("initialize"),params:Ax});var Mx=P({experimental:de(y(),we).optional(),logging:we.optional(),completions:we.optional(),prompts:P({listChanged:ve().optional()}).optional(),resources:P({subscribe:ve().optional(),listChanged:ve().optional()}).optional(),tools:P({listChanged:ve().optional()}).optional(),tasks:jx.optional()}),Dx=Se.extend({protocolVersion:y(),capabilities:Mx,serverInfo:cf,instructions:y().optional()}),Dc=Qe.extend({method:C("notifications/initialized"),params:Ye.optional()});var ss=ke.extend({method:C("ping"),params:Be.optional()}),qx=P({progress:ee(),total:fe(ee()),message:fe(y())}),Lx=P({...Ye.shape,...qx.shape,progressToken:Qp}),is=Qe.extend({method:C("notifications/progress"),params:Lx}),Ux=Be.extend({cursor:ef.optional()}),Dn=ke.extend({params:Ux.optional()}),qn=Se.extend({nextCursor:ef.optional()}),Vx=qe(["working","input_required","completed","failed","cancelled"]),Ln=P({taskId:y(),status:Vx,ttl:ie([ee(),Ec()]),createdAt:y(),lastUpdatedAt:y(),pollInterval:fe(ee()),statusMessage:fe(y())}),Jr=Se.extend({task:Ln}),Fx=Ye.merge(Ln),Un=Qe.extend({method:C("notifications/tasks/status"),params:Fx}),as=ke.extend({method:C("tasks/get"),params:Be.extend({taskId:y()})}),cs=Se.merge(Ln),us=ke.extend({method:C("tasks/result"),params:Be.extend({taskId:y()})}),gE=Se.loose(),ls=Dn.extend({method:C("tasks/list")}),ds=qn.extend({tasks:G(Ln)}),ps=ke.extend({method:C("tasks/cancel"),params:Be.extend({taskId:y()})}),uf=Se.merge(Ln),lf=P({uri:y(),mimeType:fe(y()),_meta:de(y(),le()).optional()}),df=lf.extend({text:y()}),qc=y().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),pf=lf.extend({blob:qc}),Vn=qe(["user","assistant"]),Wr=P({audience:G(Vn).optional(),priority:ee().min(0).max(1).optional(),lastModified:On.datetime({offset:!0}).optional()}),ff=P({...Gr.shape,...Mn.shape,uri:y(),description:fe(y()),mimeType:fe(y()),annotations:Wr.optional(),_meta:fe(Ne({}))}),Kx=P({...Gr.shape,...Mn.shape,uriTemplate:y(),description:fe(y()),mimeType:fe(y()),annotations:Wr.optional(),_meta:fe(Ne({}))}),fs=Dn.extend({method:C("resources/list")}),Hx=qn.extend({resources:G(ff)}),ms=Dn.extend({method:C("resources/templates/list")}),Bx=qn.extend({resourceTemplates:G(Kx)}),Lc=Be.extend({uri:y()}),Gx=Lc,hs=ke.extend({method:C("resources/read"),params:Gx}),Jx=Se.extend({contents:G(ie([df,pf]))}),Wx=Qe.extend({method:C("notifications/resources/list_changed"),params:Ye.optional()}),Xx=Lc,Yx=ke.extend({method:C("resources/subscribe"),params:Xx}),Qx=Lc,eb=ke.extend({method:C("resources/unsubscribe"),params:Qx}),tb=Ye.extend({uri:y()}),rb=Qe.extend({method:C("notifications/resources/updated"),params:tb}),nb=P({name:y(),description:fe(y()),required:fe(ve())}),ob=P({...Gr.shape,...Mn.shape,description:fe(y()),arguments:fe(G(nb)),_meta:fe(Ne({}))}),gs=Dn.extend({method:C("prompts/list")}),sb=qn.extend({prompts:G(ob)}),ib=Be.extend({name:y(),arguments:de(y(),y()).optional()}),ys=ke.extend({method:C("prompts/get"),params:ib}),Uc=P({type:C("text"),text:y(),annotations:Wr.optional(),_meta:de(y(),le()).optional()}),Vc=P({type:C("image"),data:qc,mimeType:y(),annotations:Wr.optional(),_meta:de(y(),le()).optional()}),Fc=P({type:C("audio"),data:qc,mimeType:y(),annotations:Wr.optional(),_meta:de(y(),le()).optional()}),ab=P({type:C("tool_use"),name:y(),id:y(),input:de(y(),le()),_meta:de(y(),le()).optional()}),cb=P({type:C("resource"),resource:ie([df,pf]),annotations:Wr.optional(),_meta:de(y(),le()).optional()}),ub=ff.extend({type:C("resource_link")}),Kc=ie([Uc,Vc,Fc,ub,cb]),lb=P({role:Vn,content:Kc}),db=Se.extend({description:y().optional(),messages:G(lb)}),pb=Qe.extend({method:C("notifications/prompts/list_changed"),params:Ye.optional()}),fb=P({title:y().optional(),readOnlyHint:ve().optional(),destructiveHint:ve().optional(),idempotentHint:ve().optional(),openWorldHint:ve().optional()}),mb=P({taskSupport:qe(["required","optional","forbidden"]).optional()}),mf=P({...Gr.shape,...Mn.shape,description:y().optional(),inputSchema:P({type:C("object"),properties:de(y(),we).optional(),required:G(y()).optional()}).catchall(le()),outputSchema:P({type:C("object"),properties:de(y(),we).optional(),required:G(y()).optional()}).catchall(le()).optional(),annotations:fb.optional(),execution:mb.optional(),_meta:de(y(),le()).optional()}),_s=Dn.extend({method:C("tools/list")}),hb=qn.extend({tools:G(mf)}),vs=Se.extend({content:G(Kc).default([]),structuredContent:de(y(),le()).optional(),isError:ve().optional()}),yE=vs.or(Se.extend({toolResult:le()})),gb=Zn.extend({name:y(),arguments:de(y(),le()).optional()}),Xr=ke.extend({method:C("tools/call"),params:gb}),yb=Qe.extend({method:C("notifications/tools/list_changed"),params:Ye.optional()}),_E=P({autoRefresh:ve().default(!0),debounceMs:ee().int().nonnegative().default(300)}),Fn=qe(["debug","info","notice","warning","error","critical","alert","emergency"]),_b=Be.extend({level:Fn}),Hc=ke.extend({method:C("logging/setLevel"),params:_b}),vb=Ye.extend({level:Fn,logger:y().optional(),data:le()}),xb=Qe.extend({method:C("notifications/message"),params:vb}),bb=P({name:y().optional()}),$b=P({hints:G(bb).optional(),costPriority:ee().min(0).max(1).optional(),speedPriority:ee().min(0).max(1).optional(),intelligencePriority:ee().min(0).max(1).optional()}),wb=P({mode:qe(["auto","required","none"]).optional()}),kb=P({type:C("tool_result"),toolUseId:y().describe("The unique identifier for the corresponding tool call."),content:G(Kc).default([]),structuredContent:P({}).loose().optional(),isError:ve().optional(),_meta:de(y(),le()).optional()}),Sb=Ic("type",[Uc,Vc,Fc]),es=Ic("type",[Uc,Vc,Fc,ab,kb]),zb=P({role:Vn,content:ie([es,G(es)]),_meta:de(y(),le()).optional()}),Tb=Zn.extend({messages:G(zb),modelPreferences:$b.optional(),systemPrompt:y().optional(),includeContext:qe(["none","thisServer","allServers"]).optional(),temperature:ee().optional(),maxTokens:ee().int(),stopSequences:G(y()).optional(),metadata:we.optional(),tools:G(mf).optional(),toolChoice:wb.optional()}),Pb=ke.extend({method:C("sampling/createMessage"),params:Tb}),Bc=Se.extend({model:y(),stopReason:fe(qe(["endTurn","stopSequence","maxTokens"]).or(y())),role:Vn,content:Sb}),Gc=Se.extend({model:y(),stopReason:fe(qe(["endTurn","stopSequence","maxTokens","toolUse"]).or(y())),role:Vn,content:ie([es,G(es)])}),Eb=P({type:C("boolean"),title:y().optional(),description:y().optional(),default:ve().optional()}),Ib=P({type:C("string"),title:y().optional(),description:y().optional(),minLength:ee().optional(),maxLength:ee().optional(),format:qe(["email","uri","date","date-time"]).optional(),default:y().optional()}),Cb=P({type:qe(["number","integer"]),title:y().optional(),description:y().optional(),minimum:ee().optional(),maximum:ee().optional(),default:ee().optional()}),Rb=P({type:C("string"),title:y().optional(),description:y().optional(),enum:G(y()),default:y().optional()}),Nb=P({type:C("string"),title:y().optional(),description:y().optional(),oneOf:G(P({const:y(),title:y()})),default:y().optional()}),Ob=P({type:C("string"),title:y().optional(),description:y().optional(),enum:G(y()),enumNames:G(y()).optional(),default:y().optional()}),jb=ie([Rb,Nb]),Zb=P({type:C("array"),title:y().optional(),description:y().optional(),minItems:ee().optional(),maxItems:ee().optional(),items:P({type:C("string"),enum:G(y())}),default:G(y()).optional()}),Ab=P({type:C("array"),title:y().optional(),description:y().optional(),minItems:ee().optional(),maxItems:ee().optional(),items:P({anyOf:G(P({const:y(),title:y()}))}),default:G(y()).optional()}),Mb=ie([Zb,Ab]),Db=ie([Ob,jb,Mb]),qb=ie([Db,Eb,Ib,Cb]),Lb=Zn.extend({mode:C("form").optional(),message:y(),requestedSchema:P({type:C("object"),properties:de(y(),qb),required:G(y()).optional()})}),Ub=Zn.extend({mode:C("url"),message:y(),elicitationId:y(),url:y().url()}),Vb=ie([Lb,Ub]),Fb=ke.extend({method:C("elicitation/create"),params:Vb}),Kb=Ye.extend({elicitationId:y()}),Hb=Qe.extend({method:C("notifications/elicitation/complete"),params:Kb}),xs=Se.extend({action:qe(["accept","decline","cancel"]),content:Cc(t=>t===null?void 0:t,de(y(),ie([y(),ee(),ve(),G(y())])).optional())}),Bb=P({type:C("ref/resource"),uri:y()});var Gb=P({type:C("ref/prompt"),name:y()}),Jb=Be.extend({ref:ie([Gb,Bb]),argument:P({name:y(),value:y()}),context:P({arguments:de(y(),y()).optional()}).optional()}),bs=ke.extend({method:C("completion/complete"),params:Jb});function hf(t){if(t.params.ref.type!=="ref/prompt")throw new TypeError(`Expected CompleteRequestPrompt, but got ${t.params.ref.type}`)}function gf(t){if(t.params.ref.type!=="ref/resource")throw new TypeError(`Expected CompleteRequestResourceTemplate, but got ${t.params.ref.type}`)}var Wb=Se.extend({completion:Ne({values:G(y()).max(100),total:fe(ee().int()),hasMore:fe(ve())})}),Xb=P({uri:y().startsWith("file://"),name:y().optional(),_meta:de(y(),le()).optional()}),Yb=ke.extend({method:C("roots/list"),params:Be.optional()}),Jc=Se.extend({roots:G(Xb)}),Qb=Qe.extend({method:C("notifications/roots/list_changed"),params:Ye.optional()}),vE=ie([ss,Mc,bs,Hc,ys,gs,fs,ms,hs,Yx,eb,Xr,_s,as,us,ls,ps]),xE=ie([os,is,Dc,Qb,Un]),bE=ie([ns,Bc,Gc,xs,Jc,cs,ds,Jr]),$E=ie([ss,Pb,Fb,Yb,as,us,ls,ps]),wE=ie([os,is,xb,rb,Wx,yb,pb,Un,Hb]),kE=ie([ns,Dx,Wb,db,sb,Hx,Bx,Jx,vs,hb,cs,ds,Jr]),I=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===O.UrlElicitationRequired&&n){let o=n;if(o.elicitations)return new Rc(o.elicitations,r)}return new t(e,r,n)}},Rc=class extends I{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(O.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}};function Vt(t){return t==="completed"||t==="failed"||t==="cancelled"}var _f=Symbol("Let zodToJsonSchema decide on which parser to use");var yf={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},vf=t=>typeof t=="string"?{...yf,name:t}:{...yf,...t};var xf=t=>{let e=vf(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,o])=>[o._def,{def:o._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Wc(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function J(t,e,r,n,o){t[e]=r,Wc(t,e,n,o)}var $s=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")};function pe(t){if(t.target!=="openAi")return{};let e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?$s(e,t.currentPath):e.join("/")}}function bf(t,e){let r={type:"array"};return t.type?._def&&t.type?._def?.typeName!==w.ZodAny&&(r.items=M(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&J(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&J(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(J(r,"minItems",t.exactLength.value,t.exactLength.message,e),J(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function $f(t,e){let r={type:"integer",format:"int64"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?J(r,"minimum",n.value,n.message,e):J(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),J(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?J(r,"maximum",n.value,n.message,e):J(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),J(r,"maximum",n.value,n.message,e));break;case"multipleOf":J(r,"multipleOf",n.value,n.message,e);break}return r}function wf(){return{type:"boolean"}}function ws(t,e){return M(t.type._def,e)}var kf=(t,e)=>M(t.innerType._def,e);function Xc(t,e,r){let n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((o,s)=>Xc(t,e,o))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return e$(t,e)}}var e$=(t,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let n of t.checks)switch(n.kind){case"min":J(r,"minimum",n.value,n.message,e);break;case"max":J(r,"maximum",n.value,n.message,e);break}return r};function Sf(t,e){return{...M(t.innerType._def,e),default:t.defaultValue()}}function zf(t,e){return e.effectStrategy==="input"?M(t.schema._def,e):pe(e)}function Tf(t){return{type:"string",enum:Array.from(t.values)}}var t$=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function Pf(t,e){let r=[M(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),M(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,o=[];return r.forEach(s=>{if(t$(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else{let i=s;if("additionalProperties"in s&&s.additionalProperties===!1){let{additionalProperties:a,...c}=s;i=c}else n=void 0;o.push(i)}}),o.length?{allOf:o,...n}:void 0}function Ef(t,e){let r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}var Yc,it={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Yc===void 0&&(Yc=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Yc),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function ks(t,e){let r={type:"string"};if(t.checks)for(let n of t.checks)switch(n.kind){case"min":J(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e);break;case"max":J(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":at(r,"email",n.message,e);break;case"format:idn-email":at(r,"idn-email",n.message,e);break;case"pattern:zod":Oe(r,it.email,n.message,e);break}break;case"url":at(r,"uri",n.message,e);break;case"uuid":at(r,"uuid",n.message,e);break;case"regex":Oe(r,n.regex,n.message,e);break;case"cuid":Oe(r,it.cuid,n.message,e);break;case"cuid2":Oe(r,it.cuid2,n.message,e);break;case"startsWith":Oe(r,RegExp(`^${Qc(n.value,e)}`),n.message,e);break;case"endsWith":Oe(r,RegExp(`${Qc(n.value,e)}$`),n.message,e);break;case"datetime":at(r,"date-time",n.message,e);break;case"date":at(r,"date",n.message,e);break;case"time":at(r,"time",n.message,e);break;case"duration":at(r,"duration",n.message,e);break;case"length":J(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e),J(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"includes":{Oe(r,RegExp(Qc(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&at(r,"ipv4",n.message,e),n.version!=="v4"&&at(r,"ipv6",n.message,e);break}case"base64url":Oe(r,it.base64url,n.message,e);break;case"jwt":Oe(r,it.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&Oe(r,it.ipv4Cidr,n.message,e),n.version!=="v4"&&Oe(r,it.ipv6Cidr,n.message,e);break}case"emoji":Oe(r,it.emoji(),n.message,e);break;case"ulid":{Oe(r,it.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{at(r,"binary",n.message,e);break}case"contentEncoding:base64":{J(r,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{Oe(r,it.base64,n.message,e);break}}break}case"nanoid":Oe(r,it.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function Qc(t,e){return e.patternStrategy==="escape"?n$(t):t}var r$=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function n$(t){let e="";for(let r=0;r<t.length;r++)r$.has(t[r])||(e+="\\"),e+=t[r];return e}function at(t,e,r,n){t.format||t.anyOf?.some(o=>o.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):J(t,"format",e,r,n)}function Oe(t,e,r,n){t.pattern||t.allOf?.some(o=>o.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:If(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):J(t,"pattern",If(e,n),r,n)}function If(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;let r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},n=r.i?t.source.toLowerCase():t.source,o="",s=!1,i=!1,a=!1;for(let c=0;c<n.length;c++){if(s){o+=n[c],s=!1;continue}if(r.i){if(i){if(n[c].match(/[a-z]/)){a?(o+=n[c],o+=`${n[c-2]}-${n[c]}`.toUpperCase(),a=!1):n[c+1]==="-"&&n[c+2]?.match(/[a-z]/)?(o+=n[c],a=!0):o+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){o+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(r.m){if(n[c]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&n[c]==="."){o+=i?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}o+=n[c],n[c]==="\\"?s=!0:i&&n[c]==="]"?i=!1:!i&&n[c]==="["&&(i=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return o}function Ss(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===w.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((n,o)=>({...n,[o]:M(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",o]})??pe(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let r={type:"object",additionalProperties:M(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===w.ZodString&&t.keyType._def.checks?.length){let{type:n,...o}=ks(t.keyType._def,e);return{...r,propertyNames:o}}else{if(t.keyType?._def.typeName===w.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===w.ZodBranded&&t.keyType._def.type._def.typeName===w.ZodString&&t.keyType._def.type._def.checks?.length){let{type:n,...o}=ws(t.keyType._def,e);return{...r,propertyNames:o}}}return r}function Cf(t,e){if(e.mapStrategy==="record")return Ss(t,e);let r=M(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||pe(e),n=M(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||pe(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function Rf(t){let e=t.values,n=Object.keys(t.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),o=Array.from(new Set(n.map(s=>typeof s)));return{type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:n}}function Nf(t){return t.target==="openAi"?void 0:{not:pe({...t,currentPath:[...t.currentPath,"not"]})}}function Of(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Kn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Zf(t,e){if(e.target==="openApi3")return jf(t,e);let r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in Kn&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((o,s)=>{let i=Kn[s._def.typeName];return i&&!o.includes(i)?[...o,i]:o},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((o,s)=>{let i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...o,i];case"bigint":return[...o,"integer"];case"object":if(s._def.value===null)return[...o,"null"];default:return o}},[]);if(n.length===r.length){let o=n.filter((s,i,a)=>a.indexOf(s)===i);return{type:o.length>1?o:o[0],enum:r.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,o)=>[...n,...o._def.values.filter(s=>!n.includes(s))],[])};return jf(t,e)}var jf=(t,e)=>{let r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,o)=>M(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${o}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function Af(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Kn[t.innerType._def.typeName],nullable:!0}:{type:[Kn[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=M(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let r=M(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function Mf(t,e){let r={type:"number"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"int":r.type="integer",Wc(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?J(r,"minimum",n.value,n.message,e):J(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),J(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?J(r,"maximum",n.value,n.message,e):J(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),J(r,"maximum",n.value,n.message,e));break;case"multipleOf":J(r,"multipleOf",n.value,n.message,e);break}return r}function Df(t,e){let r=e.target==="openAi",n={type:"object",properties:{}},o=[],s=t.shape();for(let a in s){let c=s[a];if(c===void 0||c._def===void 0)continue;let u=s$(c);u&&r&&(c._def.typeName==="ZodOptional"&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);let l=M(c._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});l!==void 0&&(n.properties[a]=l,u||o.push(a))}o.length&&(n.required=o);let i=o$(t,e);return i!==void 0&&(n.additionalProperties=i),n}function o$(t,e){if(t.catchall._def.typeName!=="ZodNever")return M(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function s$(t){try{return t.isOptional()}catch{return!0}}var qf=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return M(t.innerType._def,e);let r=M(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:pe(e)},r]}:pe(e)};var Lf=(t,e)=>{if(e.pipeStrategy==="input")return M(t.in._def,e);if(e.pipeStrategy==="output")return M(t.out._def,e);let r=M(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=M(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(o=>o!==void 0)}};function Uf(t,e){return M(t.type._def,e)}function Vf(t,e){let n={type:"array",uniqueItems:!0,items:M(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&J(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&J(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function Ff(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>M(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:M(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>M(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function Kf(t){return{not:pe(t)}}function Hf(t){return pe(t)}var Bf=(t,e)=>M(t.innerType._def,e);var Gf=(t,e,r)=>{switch(e){case w.ZodString:return ks(t,r);case w.ZodNumber:return Mf(t,r);case w.ZodObject:return Df(t,r);case w.ZodBigInt:return $f(t,r);case w.ZodBoolean:return wf();case w.ZodDate:return Xc(t,r);case w.ZodUndefined:return Kf(r);case w.ZodNull:return Of(r);case w.ZodArray:return bf(t,r);case w.ZodUnion:case w.ZodDiscriminatedUnion:return Zf(t,r);case w.ZodIntersection:return Pf(t,r);case w.ZodTuple:return Ff(t,r);case w.ZodRecord:return Ss(t,r);case w.ZodLiteral:return Ef(t,r);case w.ZodEnum:return Tf(t);case w.ZodNativeEnum:return Rf(t);case w.ZodNullable:return Af(t,r);case w.ZodOptional:return qf(t,r);case w.ZodMap:return Cf(t,r);case w.ZodSet:return Vf(t,r);case w.ZodLazy:return()=>t.getter()._def;case w.ZodPromise:return Uf(t,r);case w.ZodNaN:case w.ZodNever:return Nf(r);case w.ZodEffects:return zf(t,r);case w.ZodAny:return pe(r);case w.ZodUnknown:return Hf(r);case w.ZodDefault:return Sf(t,r);case w.ZodBranded:return ws(t,r);case w.ZodReadonly:return Bf(t,r);case w.ZodCatch:return kf(t,r);case w.ZodPipeline:return Lf(t,r);case w.ZodFunction:case w.ZodVoid:case w.ZodSymbol:return;default:return(n=>{})(e)}};function M(t,e,r=!1){let n=e.seen.get(t);if(e.override){let a=e.override?.(t,e,n,r);if(a!==_f)return a}if(n&&!r){let a=i$(n,e);if(a!==void 0)return a}let o={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,o);let s=Gf(t,t.typeName,e),i=typeof s=="function"?M(s(),e):s;if(i&&a$(t,e,i),e.postProcess){let a=e.postProcess(i,t,e);return o.jsonSchema=i,a}return o.jsonSchema=i,i}var i$=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:$s(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),pe(e)):e.$refStrategy==="seen"?pe(e):void 0}},a$=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r);var eu=(t,e)=>{let r=xf(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((c,[u,l])=>({...c,[u]:M(l._def,{...r,currentPath:[...r.basePath,r.definitionPath,u]},!0)??pe(r)}),{}):void 0,o=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=M(t._def,o===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,o]},!1)??pe(r),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(s.title=i),r.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[r.openAiAnyTypeName]||(n[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let a=o===void 0?n?{...s,[r.definitionPath]:n}:s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:{...n,[o]:s}};return r.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a};function c$(t){return!t||t==="jsonSchema7"||t==="draft-7"?"draft-7":t==="jsonSchema2019-09"||t==="draft-2020-12"?"draft-2020-12":"draft-7"}function tu(t,e){return Xe(t)?bc(t,{target:c$(e?.target),io:e?.pipeStrategy??"input"}):eu(t,{strictUnions:e?.strictUnions??!0,pipeStrategy:e?.pipeStrategy??"input"})}function ru(t){let r=Lt(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Xo(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function nu(t,e){let r=qt(t,e);if(!r.success)throw r.error;return r.data}var u$=6e4,zs=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(os,r=>{this._oncancel(r)}),this.setNotificationHandler(is,r=>{this._onprogress(r)}),this.setRequestHandler(ss,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(as,async(r,n)=>{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new I(O.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(us,async(r,n)=>{let o=async()=>{let s=r.params.taskId;if(this._taskMessageQueue){let a;for(;a=await this._taskMessageQueue.dequeue(s,n.sessionId);){if(a.type==="response"||a.type==="error"){let c=a.message,u=c.id,l=this._requestResolvers.get(u);if(l)if(this._requestResolvers.delete(u),a.type==="response")l(c);else{let d=c,h=new I(d.error.code,d.error.message,d.error.data);l(h)}else{let d=a.type==="response"?"Response":"Error";this._onerror(new Error(`${d} handler missing for request ${u}`))}continue}await this._transport?.send(a.message,{relatedRequestId:n.requestId})}}let i=await this._taskStore.getTask(s,n.sessionId);if(!i)throw new I(O.InvalidParams,`Task not found: ${s}`);if(!Vt(i.status))return await this._waitForTaskUpdate(s,n.signal),await o();if(Vt(i.status)){let a=await this._taskStore.getTaskResult(s,n.sessionId);return this._clearTaskQueue(s),{...a,_meta:{...a._meta,[Ut]:{taskId:s}}}}return await o()};return await o()}),this.setRequestHandler(ls,async(r,n)=>{try{let{tasks:o,nextCursor:s}=await this._taskStore.listTasks(r.params?.cursor,n.sessionId);return{tasks:o,nextCursor:s,_meta:{}}}catch(o){throw new I(O.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(ps,async(r,n)=>{try{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new I(O.InvalidParams,`Task not found: ${r.params.taskId}`);if(Vt(o.status))throw new I(O.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new I(O.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof I?o:new I(O.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.abort(e.params.reason)}_setupTimeout(e,r,n,o,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),I.fromError(O.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){if(this._transport)throw new Error("Already connected to a transport. Call close() before connecting to a new transport, or use a separate Protocol instance per connection.");this._transport=e;let r=this.transport?.onclose;this._transport.onclose=()=>{r?.(),this._onclose()};let n=this.transport?.onerror;this._transport.onerror=s=>{n?.(s),this._onerror(s)};let o=this._transport?.onmessage;this._transport.onmessage=(s,i)=>{o?.(s,i),An(s)||sf(s)?this._onresponse(s):jc(s)?this._onrequest(s,i):of(s)?this._onnotification(s):this._onerror(new Error(`Unknown message type: ${JSON.stringify(s)}`))},await this._transport.start()}_onclose(){let e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();for(let n of this._requestHandlerAbortControllers.values())n.abort();this._requestHandlerAbortControllers.clear();let r=I.fromError(O.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let n of e.values())n(r)}_onerror(e){this.onerror?.(e)}_onnotification(e){let r=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;r!==void 0&&Promise.resolve().then(()=>r(e)).catch(n=>this._onerror(new Error(`Uncaught error in notification handler: ${n}`)))}_onrequest(e,r){let n=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,o=this._transport,s=e.params?._meta?.[Ut]?.taskId;if(n===void 0){let l={jsonrpc:"2.0",id:e.id,error:{code:O.MethodNotFound,message:"Method not found"}};s&&this._taskMessageQueue?this._enqueueTaskMessage(s,{type:"error",message:l,timestamp:Date.now()},o?.sessionId).catch(d=>this._onerror(new Error(`Failed to enqueue error response: ${d}`))):o?.send(l).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);let a=tf(e.params)?e.params.task:void 0,c=this._taskStore?this.requestTaskStore(e,o?.sessionId):void 0,u={signal:i.signal,sessionId:o?.sessionId,_meta:e.params?._meta,sendNotification:async l=>{if(i.signal.aborted)return;let d={relatedRequestId:e.id};s&&(d.relatedTask={taskId:s}),await this.notification(l,d)},sendRequest:async(l,d,h)=>{if(i.signal.aborted)throw new I(O.ConnectionClosed,"Request was cancelled");let f={...h,relatedRequestId:e.id};s&&!f.relatedTask&&(f.relatedTask={taskId:s});let p=f.relatedTask?.taskId??s;return p&&c&&await c.updateTaskStatus(p,"input_required"),await this.request(l,d,f)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:s,taskStore:c,taskRequestedTtl:a?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{a&&this.assertTaskHandlerCapability(e.method)}).then(()=>n(e,u)).then(async l=>{if(i.signal.aborted)return;let d={result:l,jsonrpc:"2.0",id:e.id};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"response",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)},async l=>{if(i.signal.aborted)return;let d={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(l.code)?l.code:O.InternalError,message:l.message??"Internal error",...l.data!==void 0&&{data:l.data}}};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"error",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)}).catch(l=>this._onerror(new Error(`Failed to send response: ${l}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,o=Number(r),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),i(c);return}s(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),An(e))n(e);else{let i=new I(e.error.code,e.error.message,e.error.data);n(i)}return}let o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let s=!1;if(An(e)&&e.result&&typeof e.result=="object"){let i=e.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(s=!0,this._taskProgressTokens.set(a.taskId,r))}}if(s||this._progressHandlers.delete(r),An(e))o(e);else{let i=I.fromError(e.error.code,e.error.message,e.error.data);o(i)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(e,r,n){let{task:o}=n??{};if(!o){try{yield{type:"result",result:await this.request(e,r,n)}}catch(i){yield{type:"error",error:i instanceof I?i:new I(O.InternalError,String(i))}}return}let s;try{let i=await this.request(e,Jr,n);if(i.task)s=i.task.taskId,yield{type:"taskCreated",task:i.task};else throw new I(O.InternalError,"Task creation did not return a task");for(;;){let a=await this.getTask({taskId:s},n);if(yield{type:"taskStatus",task:a},Vt(a.status)){a.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)}:a.status==="failed"?yield{type:"error",error:new I(O.InternalError,`Task ${s} failed`)}:a.status==="cancelled"&&(yield{type:"error",error:new I(O.InternalError,`Task ${s} was cancelled`)});return}if(a.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)};return}let c=a.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(u=>setTimeout(u,c)),n?.signal?.throwIfAborted()}}catch(i){yield{type:"error",error:i instanceof I?i:new I(O.InternalError,String(i))}}}request(e,r,n){let{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{let d=x=>{l(x)};if(!this._transport){d(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(x){d(x);return}n?.signal?.throwIfAborted();let h=this._requestMessageId++,f={...e,jsonrpc:"2.0",id:h};n?.onprogress&&(this._progressHandlers.set(h,n.onprogress),f.params={...e.params,_meta:{...e.params?._meta||{},progressToken:h}}),a&&(f.params={...f.params,task:a}),c&&(f.params={...f.params,_meta:{...f.params?._meta||{},[Ut]:c}});let p=x=>{this._responseHandlers.delete(h),this._progressHandlers.delete(h),this._cleanupTimeout(h),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:h,reason:String(x)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(k=>this._onerror(new Error(`Failed to send cancellation: ${k}`)));let b=x instanceof I?x:new I(O.RequestTimeout,String(x));l(b)};this._responseHandlers.set(h,x=>{if(!n?.signal?.aborted){if(x instanceof Error)return l(x);try{let b=qt(r,x.result);b.success?u(b.data):l(b.error)}catch(b){l(b)}}}),n?.signal?.addEventListener("abort",()=>{p(n?.signal?.reason)});let m=n?.timeout??u$,g=()=>p(I.fromError(O.RequestTimeout,"Request timed out",{timeout:m}));this._setupTimeout(h,m,n?.maxTotalTimeout,g,n?.resetTimeoutOnProgress??!1);let v=c?.taskId;if(v){let x=b=>{let k=this._responseHandlers.get(h);k?k(b):this._onerror(new Error(`Response handler missing for side-channeled request ${h}`))};this._requestResolvers.set(h,x),this._enqueueTaskMessage(v,{type:"request",message:f,timestamp:Date.now()}).catch(b=>{this._cleanupTimeout(h),l(b)})}else this._transport.send(f,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(x=>{this._cleanupTimeout(h),l(x)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},cs,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},ds,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},uf,r)}async notification(e,r){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let n=r?.relatedTask?.taskId;if(n){let a={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Ut]:r.relatedTask}}};await this._enqueueTaskMessage(n,{type:"notification",message:a,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let a={...e,jsonrpc:"2.0"};r?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[Ut]:r.relatedTask}}}),this._transport?.send(a,r).catch(c=>this._onerror(c))});return}let i={...e,jsonrpc:"2.0"};r?.relatedTask&&(i={...i,params:{...i.params,_meta:{...i.params?._meta||{},[Ut]:r.relatedTask}}}),await this._transport.send(i,r)}setRequestHandler(e,r){let n=ru(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,s)=>{let i=nu(e,o);return Promise.resolve(r(i,s))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=ru(e);this._notificationHandlers.set(n,o=>{let s=nu(e,o);return Promise.resolve(r(s))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let o of n)if(o.type==="request"&&jc(o.message)){let s=o.message.id,i=this._requestResolvers.get(s);i?(i(new I(O.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){let n=this._options?.defaultTaskPollInterval??1e3;try{let o=await this._taskStore?.getTask(e);o?.pollInterval&&(n=o.pollInterval)}catch{}return new Promise((o,s)=>{if(r.aborted){s(new I(O.InvalidRequest,"Request cancelled"));return}let i=setTimeout(o,n);r.addEventListener("abort",()=>{clearTimeout(i),s(new I(O.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!e)throw new Error("No request provided");return await n.createTask(o,e.id,{method:e.method,params:e.params},r)},getTask:async o=>{let s=await n.getTask(o,r);if(!s)throw new I(O.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,i)=>{await n.storeTaskResult(o,s,i,r);let a=await n.getTask(o,r);if(a){let c=Un.parse({method:"notifications/tasks/status",params:a});await this.notification(c),Vt(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,s,i)=>{let a=await n.getTask(o,r);if(!a)throw new I(O.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(Vt(a.status))throw new I(O.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,s,i,r);let c=await n.getTask(o,r);if(c){let u=Un.parse({method:"notifications/tasks/status",params:c});await this.notification(u),Vt(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}};function Jf(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Wf(t,e){let r={...t};for(let n in e){let o=n,s=e[o];if(s===void 0)continue;let i=r[o];Jf(i)&&Jf(s)?r[o]={...i,...s}:r[o]=s}return r}var Zg=So(Ul(),1),Ag=So(jg(),1);function Qz(){let t=new Zg.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,Ag.default)(t),t}var ui=class{constructor(e){this._ajv=e??Qz()}getValidator(e){let r="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return n=>r(n)?{valid:!0,data:n,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(r.errors)}}};var li=class{constructor(e){this._server=e}requestStream(e,r,n){return this._server.requestStream(e,r,n)}async getTask(e,r){return this._server.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._server.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._server.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._server.cancelTask({taskId:e},r)}};function Mg(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function Dg(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}var di=class extends zs{constructor(e,r){super(r),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Fn.options.map((n,o)=>[n,o])),this.isMessageIgnored=(n,o)=>{let s=this._loggingLevels.get(o);return s?this.LOG_LEVEL_SEVERITY.get(n)<this.LOG_LEVEL_SEVERITY.get(s):!1},this._capabilities=r?.capabilities??{},this._instructions=r?.instructions,this._jsonSchemaValidator=r?.jsonSchemaValidator??new ui,this.setRequestHandler(Mc,n=>this._oninitialize(n)),this.setNotificationHandler(Dc,()=>this.oninitialized?.()),this._capabilities.logging&&this.setRequestHandler(Hc,async(n,o)=>{let s=o.sessionId||o.requestInfo?.headers["mcp-session-id"]||void 0,{level:i}=n.params,a=Fn.safeParse(i);return a.success&&this._loggingLevels.set(s,a.data),{}})}get experimental(){return this._experimental||(this._experimental={tasks:new li(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Wf(this._capabilities,e)}setRequestHandler(e,r){let o=Lt(e)?.method;if(!o)throw new Error("Schema is missing a method literal");let s;if(Xe(o)){let a=o;s=a._zod?.def?.value??a.value}else{let a=o;s=a._def?.value??a.value}if(typeof s!="string")throw new Error("Schema method literal must be a string");if(s==="tools/call"){let a=async(c,u)=>{let l=qt(Xr,c);if(!l.success){let p=l.error instanceof Error?l.error.message:String(l.error);throw new I(O.InvalidParams,`Invalid tools/call request: ${p}`)}let{params:d}=l.data,h=await Promise.resolve(r(c,u));if(d.task){let p=qt(Jr,h);if(!p.success){let m=p.error instanceof Error?p.error.message:String(p.error);throw new I(O.InvalidParams,`Invalid task creation result: ${m}`)}return p.data}let f=qt(vs,h);if(!f.success){let p=f.error instanceof Error?f.error.message:String(f.error);throw new I(O.InvalidParams,`Invalid tools/call result: ${p}`)}return f.data};return super.setRequestHandler(e,a)}return super.setRequestHandler(e,r)}assertCapabilityForMethod(e){switch(e){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw new Error(`Client does not support URL elicitation (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"completion/complete":if(!this._capabilities.completions)throw new Error(`Server does not support completions (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Server does not support tasks capability (required for ${e})`);break;case"ping":case"initialize":break}}assertTaskCapability(e){Dg(this._clientCapabilities?.tasks?.requests,e,"Client")}assertTaskHandlerCapability(e){this._capabilities&&Mg(this._capabilities.tasks?.requests,e,"Server")}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Yp.includes(r)?r:Nc,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},ns)}async createMessage(e,r){if((e.tools||e.toolChoice)&&!this._clientCapabilities?.sampling?.tools)throw new Error("Client does not support sampling tools capability.");if(e.messages.length>0){let n=e.messages[e.messages.length-1],o=Array.isArray(n.content)?n.content:[n.content],s=o.some(u=>u.type==="tool_result"),i=e.messages.length>1?e.messages[e.messages.length-2]:void 0,a=i?Array.isArray(i.content)?i.content:[i.content]:[],c=a.some(u=>u.type==="tool_use");if(s){if(o.some(u=>u.type!=="tool_result"))throw new Error("The last message must contain only tool_result content if any is present");if(!c)throw new Error("tool_result blocks are not matching any tool_use from the previous message")}if(c){let u=new Set(a.filter(d=>d.type==="tool_use").map(d=>d.id)),l=new Set(o.filter(d=>d.type==="tool_result").map(d=>d.toolUseId));if(u.size!==l.size||![...u].every(d=>l.has(d)))throw new Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}return e.tools?this.request({method:"sampling/createMessage",params:e},Gc,r):this.request({method:"sampling/createMessage",params:e},Bc,r)}async elicitInput(e,r){switch(e.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support url elicitation.");let o=e;return this.request({method:"elicitation/create",params:o},xs,r)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw new Error("Client does not support form elicitation.");let o=e.mode==="form"?e:{...e,mode:"form"},s=await this.request({method:"elicitation/create",params:o},xs,r);if(s.action==="accept"&&s.content&&o.requestedSchema)try{let a=this._jsonSchemaValidator.getValidator(o.requestedSchema)(s.content);if(!a.valid)throw new I(O.InvalidParams,`Elicitation response content does not match requested schema: ${a.errorMessage}`)}catch(i){throw i instanceof I?i:new I(O.InternalError,`Error validating elicitation response: ${i instanceof Error?i.message:String(i)}`)}return s}}}createElicitationCompletionNotifier(e,r){if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:e}},r)}async listRoots(e,r){return this.request({method:"roots/list",params:e},Jc,r)}async sendLoggingMessage(e,r){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,r))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var Lg=Symbol.for("mcp.completable");function Wl(t){return!!t&&typeof t=="object"&&Lg in t}function Ug(t){return t[Lg]?.complete}var qg;(function(t){t.Completable="McpCompletable"})(qg||(qg={}));var eT=/^[A-Za-z0-9._-]{1,128}$/;function tT(t){let e=[];if(t.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(t.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${t.length})`]};if(t.includes(" ")&&e.push("Tool name contains spaces, which may cause parsing issues"),t.includes(",")&&e.push("Tool name contains commas, which may cause parsing issues"),(t.startsWith("-")||t.endsWith("-"))&&e.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts"),(t.startsWith(".")||t.endsWith("."))&&e.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts"),!eT.test(t)){let r=t.split("").filter(n=>!/[A-Za-z0-9._-]/.test(n)).filter((n,o,s)=>s.indexOf(n)===o);return e.push(`Tool name contains invalid characters: ${r.map(n=>`"${n}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:e}}return{isValid:!0,warnings:e}}function rT(t,e){if(e.length>0){console.warn(`Tool name validation warning for "${t}":`);for(let r of e)console.warn(`  - ${r}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function Xl(t){let e=tT(t);return rT(t,e.warnings),e.isValid}var pi=class{constructor(e){this._mcpServer=e}registerToolTask(e,r,n){let o={taskSupport:"required",...r.execution};if(o.taskSupport==="forbidden")throw new Error(`Cannot register task-based tool '${e}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(e,r.title,r.description,r.inputSchema,r.outputSchema,r.annotations,o,r._meta,n)}};var fi=class{constructor(e,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new di(e,r)}get experimental(){return this._experimental||(this._experimental={tasks:new pi(this)}),this._experimental}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(_s)),this.server.assertCanSetRequestHandler(Yt(Xr)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(_s,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,r])=>{let n={name:e,title:r.title,description:r.description,inputSchema:(()=>{let o=Br(r.inputSchema);return o?tu(o,{strictUnions:!0,pipeStrategy:"input"}):nT})(),annotations:r.annotations,execution:r.execution,_meta:r._meta};if(r.outputSchema){let o=Br(r.outputSchema);o&&(n.outputSchema=tu(o,{strictUnions:!0,pipeStrategy:"output"}))}return n})})),this.server.setRequestHandler(Xr,async(e,r)=>{try{let n=this._registeredTools[e.params.name];if(!n)throw new I(O.InvalidParams,`Tool ${e.params.name} not found`);if(!n.enabled)throw new I(O.InvalidParams,`Tool ${e.params.name} disabled`);let o=!!e.params.task,s=n.execution?.taskSupport,i="createTask"in n.handler;if((s==="required"||s==="optional")&&!i)throw new I(O.InternalError,`Tool ${e.params.name} has taskSupport '${s}' but was not registered with registerToolTask`);if(s==="required"&&!o)throw new I(O.MethodNotFound,`Tool ${e.params.name} requires task augmentation (taskSupport: 'required')`);if(s==="optional"&&!o&&i)return await this.handleAutomaticTaskPolling(n,e,r);let a=await this.validateToolInput(n,e.params.arguments,e.params.name),c=await this.executeToolHandler(n,a,r);return o||await this.validateToolOutput(n,c,e.params.name),c}catch(n){if(n instanceof I&&n.code===O.UrlElicitationRequired)throw n;return this.createToolError(n instanceof Error?n.message:String(n))}}),this._toolHandlersInitialized=!0)}createToolError(e){return{content:[{type:"text",text:e}],isError:!0}}async validateToolInput(e,r,n){if(!e.inputSchema)return;let s=Br(e.inputSchema)??e.inputSchema,i=await Jo(s,r);if(!i.success){let a="error"in i?i.error:"Unknown error",c=Wo(a);throw new I(O.InvalidParams,`Input validation error: Invalid arguments for tool ${n}: ${c}`)}return i.data}async validateToolOutput(e,r,n){if(!e.outputSchema||!("content"in r)||r.isError)return;if(!r.structuredContent)throw new I(O.InvalidParams,`Output validation error: Tool ${n} has an output schema but no structured content was provided`);let o=Br(e.outputSchema),s=await Jo(o,r.structuredContent);if(!s.success){let i="error"in s?s.error:"Unknown error",a=Wo(i);throw new I(O.InvalidParams,`Output validation error: Invalid structured content for tool ${n}: ${a}`)}}async executeToolHandler(e,r,n){let o=e.handler;if("createTask"in o){if(!n.taskStore)throw new Error("No task store provided.");let i={...n,taskStore:n.taskStore};if(e.inputSchema){let a=o;return await Promise.resolve(a.createTask(r,i))}else{let a=o;return await Promise.resolve(a.createTask(i))}}if(e.inputSchema){let i=o;return await Promise.resolve(i(r,n))}else{let i=o;return await Promise.resolve(i(n))}}async handleAutomaticTaskPolling(e,r,n){if(!n.taskStore)throw new Error("No task store provided for task-capable tool.");let o=await this.validateToolInput(e,r.params.arguments,r.params.name),s=e.handler,i={...n,taskStore:n.taskStore},a=o?await Promise.resolve(s.createTask(o,i)):await Promise.resolve(s.createTask(i)),c=a.task.taskId,u=a.task,l=u.pollInterval??5e3;for(;u.status!=="completed"&&u.status!=="failed"&&u.status!=="cancelled";){await new Promise(h=>setTimeout(h,l));let d=await n.taskStore.getTask(c);if(!d)throw new I(O.InternalError,`Task ${c} not found during polling`);u=d}return await n.taskStore.getTaskResult(c)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Yt(bs)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(bs,async e=>{switch(e.params.ref.type){case"ref/prompt":return hf(e),this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return gf(e),this.handleResourceCompletion(e,e.params.ref);default:throw new I(O.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,r){let n=this._registeredPrompts[r.name];if(!n)throw new I(O.InvalidParams,`Prompt ${r.name} not found`);if(!n.enabled)throw new I(O.InvalidParams,`Prompt ${r.name} disabled`);if(!n.argsSchema)return $o;let s=Lt(n.argsSchema)?.[e.params.argument.name];if(!Wl(s))return $o;let i=Ug(s);if(!i)return $o;let a=await i(e.params.argument.value,e.params.context);return Fg(a)}async handleResourceCompletion(e,r){let n=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===r.uri);if(!n){if(this._registeredResources[r.uri])return $o;throw new I(O.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let o=n.resourceTemplate.completeCallback(e.params.argument.name);if(!o)return $o;let s=await o(e.params.argument.value,e.params.context);return Fg(s)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(fs)),this.server.assertCanSetRequestHandler(Yt(ms)),this.server.assertCanSetRequestHandler(Yt(hs)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(fs,async(e,r)=>{let n=Object.entries(this._registeredResources).filter(([s,i])=>i.enabled).map(([s,i])=>({uri:s,name:i.name,...i.metadata})),o=[];for(let s of Object.values(this._registeredResourceTemplates)){if(!s.resourceTemplate.listCallback)continue;let i=await s.resourceTemplate.listCallback(r);for(let a of i.resources)o.push({...s.metadata,...a})}return{resources:[...n,...o]}}),this.server.setRequestHandler(ms,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,n])=>({name:r,uriTemplate:n.resourceTemplate.uriTemplate.toString(),...n.metadata}))})),this.server.setRequestHandler(hs,async(e,r)=>{let n=new URL(e.params.uri),o=this._registeredResources[n.toString()];if(o){if(!o.enabled)throw new I(O.InvalidParams,`Resource ${n} disabled`);return o.readCallback(n,r)}for(let s of Object.values(this._registeredResourceTemplates)){let i=s.resourceTemplate.uriTemplate.match(n.toString());if(i)return s.readCallback(n,i,r)}throw new I(O.InvalidParams,`Resource ${n} not found`)}),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(gs)),this.server.assertCanSetRequestHandler(Yt(ys)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(gs,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,r])=>({name:e,title:r.title,description:r.description,arguments:r.argsSchema?sT(r.argsSchema):void 0}))})),this.server.setRequestHandler(ys,async(e,r)=>{let n=this._registeredPrompts[e.params.name];if(!n)throw new I(O.InvalidParams,`Prompt ${e.params.name} not found`);if(!n.enabled)throw new I(O.InvalidParams,`Prompt ${e.params.name} disabled`);if(n.argsSchema){let o=Br(n.argsSchema),s=await Jo(o,e.params.arguments);if(!s.success){let c="error"in s?s.error:"Unknown error",u=Wo(c);throw new I(O.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${u}`)}let i=s.data,a=n.callback;return await Promise.resolve(a(i,r))}else{let o=n.callback;return await Promise.resolve(o(r))}}),this._promptHandlersInitialized=!0)}resource(e,r,...n){let o;typeof n[0]=="object"&&(o=n.shift());let s=n[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let i=this._createRegisteredResource(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let i=this._createRegisteredResourceTemplate(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(e,r,n,o){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let s=this._createRegisteredResource(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let s=this._createRegisteredResourceTemplate(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}}_createRegisteredResource(e,r,n,o,s){let i={name:e,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:a=>{typeof a.uri<"u"&&a.uri!==n&&(delete this._registeredResources[n],a.uri&&(this._registeredResources[a.uri]=i)),typeof a.name<"u"&&(i.name=a.name),typeof a.title<"u"&&(i.title=a.title),typeof a.metadata<"u"&&(i.metadata=a.metadata),typeof a.callback<"u"&&(i.readCallback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendResourceListChanged()}};return this._registeredResources[n]=i,i}_createRegisteredResourceTemplate(e,r,n,o,s){let i={resourceTemplate:n,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:u=>{typeof u.name<"u"&&u.name!==e&&(delete this._registeredResourceTemplates[e],u.name&&(this._registeredResourceTemplates[u.name]=i)),typeof u.title<"u"&&(i.title=u.title),typeof u.template<"u"&&(i.resourceTemplate=u.template),typeof u.metadata<"u"&&(i.metadata=u.metadata),typeof u.callback<"u"&&(i.readCallback=u.callback),typeof u.enabled<"u"&&(i.enabled=u.enabled),this.sendResourceListChanged()}};this._registeredResourceTemplates[e]=i;let a=n.uriTemplate.variableNames;return Array.isArray(a)&&a.some(u=>!!n.completeCallback(u))&&this.setCompletionRequestHandler(),i}_createRegisteredPrompt(e,r,n,o,s){let i={title:r,description:n,argsSchema:o===void 0?void 0:$r(o),callback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:a=>{typeof a.name<"u"&&a.name!==e&&(delete this._registeredPrompts[e],a.name&&(this._registeredPrompts[a.name]=i)),typeof a.title<"u"&&(i.title=a.title),typeof a.description<"u"&&(i.description=a.description),typeof a.argsSchema<"u"&&(i.argsSchema=$r(a.argsSchema)),typeof a.callback<"u"&&(i.callback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,o&&Object.values(o).some(c=>{let u=c instanceof Me?c._def?.innerType:c;return Wl(u)})&&this.setCompletionRequestHandler(),i}_createRegisteredTool(e,r,n,o,s,i,a,c,u){Xl(e);let l={title:r,description:n,inputSchema:Vg(o),outputSchema:Vg(s),annotations:i,execution:a,_meta:c,handler:u,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:d=>{typeof d.name<"u"&&d.name!==e&&(typeof d.name=="string"&&Xl(d.name),delete this._registeredTools[e],d.name&&(this._registeredTools[d.name]=l)),typeof d.title<"u"&&(l.title=d.title),typeof d.description<"u"&&(l.description=d.description),typeof d.paramsSchema<"u"&&(l.inputSchema=$r(d.paramsSchema)),typeof d.outputSchema<"u"&&(l.outputSchema=$r(d.outputSchema)),typeof d.callback<"u"&&(l.handler=d.callback),typeof d.annotations<"u"&&(l.annotations=d.annotations),typeof d._meta<"u"&&(l._meta=d._meta),typeof d.enabled<"u"&&(l.enabled=d.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let n,o,s,i;if(typeof r[0]=="string"&&(n=r.shift()),r.length>1){let c=r[0];Yl(c)?(o=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!Yl(r[0])&&(i=r.shift())):typeof c=="object"&&c!==null&&(i=r.shift())}let a=r[0];return this._createRegisteredTool(e,void 0,n,o,s,i,{taskSupport:"forbidden"},void 0,a)}registerTool(e,r,n){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let{title:o,description:s,inputSchema:i,outputSchema:a,annotations:c,_meta:u}=r;return this._createRegisteredTool(e,o,s,i,a,c,{taskSupport:"forbidden"},u,n)}prompt(e,...r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let n;typeof r[0]=="string"&&(n=r.shift());let o;r.length>1&&(o=r.shift());let s=r[0],i=this._createRegisteredPrompt(e,void 0,n,o,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,r,n){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let{title:o,description:s,argsSchema:i}=r,a=this._createRegisteredPrompt(e,o,s,i,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),a}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(e,r){return this.server.sendLoggingMessage(e,r)}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}};var nT={type:"object",properties:{}};function Kg(t){return t!==null&&typeof t=="object"&&"parse"in t&&typeof t.parse=="function"&&"safeParse"in t&&typeof t.safeParse=="function"}function oT(t){return"_def"in t||"_zod"in t||Kg(t)}function Yl(t){return typeof t!="object"||t===null||oT(t)?!1:Object.keys(t).length===0?!0:Object.values(t).some(Kg)}function Vg(t){if(t)return Yl(t)?$r(t):t}function sT(t){let e=Lt(t);return e?Object.entries(e).map(([r,n])=>{let o=Ep(n),s=Ip(n);return{name:r,description:o,required:!s}}):[]}function Yt(t){let r=Lt(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Xo(r);if(typeof n=="string")return n;throw new Error("Schema method literal must be a string")}function Fg(t){return{completion:{values:t.slice(0,100),total:t.length,hasMore:t.length>100}}}var $o={completion:{values:[],hasMore:!1}};var Ql=So(require("node:process"),1);var mi=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),iT(r)}clear(){this._buffer=void 0}};function iT(t){return af.parse(JSON.parse(t))}function Hg(t){return JSON.stringify(t)+`
`}var hi=class{constructor(e=Ql.default.stdin,r=Ql.default.stdout){this._stdin=e,this._stdout=r,this._readBuffer=new mi,this._started=!1,this._ondata=n=>{this._readBuffer.append(n),this.processReadBuffer()},this._onerror=n=>{this.onerror?.(n)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(;;)try{let e=this._readBuffer.readMessage();if(e===null)break;this.onmessage?.(e)}catch(e){this.onerror?.(e)}}async close(){this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),this.onclose?.()}send(e){return new Promise(r=>{let n=Hg(e);this._stdout.write(n)?r():this._stdout.once("drain",r)})}};var wo=So(require("node:crypto"),1);var Gg="0123456789ABCDEFGHJKMNPQRSTVWXYZ",gi=32;var aT=16,Jg=10,Bg=0xffffffffffff;var Nr;(function(t){t.Base32IncorrectEncoding="B32_ENC_INVALID",t.DecodeTimeInvalidCharacter="DEC_TIME_CHAR",t.DecodeTimeValueMalformed="DEC_TIME_MALFORMED",t.EncodeTimeNegative="ENC_TIME_NEG",t.EncodeTimeSizeExceeded="ENC_TIME_SIZE_EXCEED",t.EncodeTimeValueMalformed="ENC_TIME_MALFORMED",t.PRNGDetectFailure="PRNG_DETECT",t.ULIDInvalid="ULID_INVALID",t.Unexpected="UNEXPECTED",t.UUIDInvalid="UUID_INVALID"})(Nr||(Nr={}));var Or=class extends Error{constructor(e,r){super(`${r} (${e})`),this.name="ULIDError",this.code=e}};function cT(t){let e=Math.floor(t()*gi)%gi;return Gg.charAt(e)}function uT(t){let e=lT(),r=e&&(e.crypto||e.msCrypto)||(typeof wo.default<"u"?wo.default:null);if(typeof r?.getRandomValues=="function")return()=>{let n=new Uint8Array(1);return r.getRandomValues(n),n[0]/256};if(typeof r?.randomBytes=="function")return()=>r.randomBytes(1).readUInt8()/256;if(wo.default?.randomBytes)return()=>wo.default.randomBytes(1).readUInt8()/256;throw new Or(Nr.PRNGDetectFailure,"Failed to find a reliable PRNG")}function lT(){return fT()?self:typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:null}function dT(t,e){let r="";for(;t>0;t--)r=cT(e)+r;return r}function pT(t,e=Jg){if(isNaN(t))throw new Or(Nr.EncodeTimeValueMalformed,`Time must be a number: ${t}`);if(t>Bg)throw new Or(Nr.EncodeTimeSizeExceeded,`Cannot encode a time larger than ${Bg}: ${t}`);if(t<0)throw new Or(Nr.EncodeTimeNegative,`Time must be positive: ${t}`);if(Number.isInteger(t)===!1)throw new Or(Nr.EncodeTimeValueMalformed,`Time must be an integer: ${t}`);let r,n="";for(let o=e;o>0;o--)r=t%gi,n=Gg.charAt(r)+n,t=(t-r)/gi;return n}function fT(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function Wg(t,e){let r=e||uT(),n=!t||isNaN(t)?Date.now():t;return pT(n,Jg)+dT(aT,r)}var yi=class{baseUrl;apiKey;teamId;projectId;brainETag=null;brainCache=null;brainParamsKey=null;constructor(e){if(this.apiKey=e?.apiKey??process.env.CONTOX_API_KEY??"",this.baseUrl=(e?.apiUrl??process.env.CONTOX_API_URL??"https://contox.dev").replace(/\/$/,""),this.teamId=e?.teamId??process.env.CONTOX_TEAM_ID??"",this.projectId=e?.projectId??process.env.CONTOX_PROJECT_ID??"",!this.apiKey)throw new Error("CONTOX_API_KEY is required. Set it as an environment variable.");if(!this.teamId)throw new Error("CONTOX_TEAM_ID is required. Set it as an environment variable.");if(!this.projectId)throw new Error("CONTOX_PROJECT_ID is required. Set it as an environment variable.")}async request(e,r={}){let n=`${this.baseUrl}/api${e}`,o=await fetch(n,{...r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`,...r.headers}});if(!o.ok){let s=await o.json().catch(()=>({})),i=typeof s.error=="string"?s.error:o.statusText;throw new Error(`API error (${String(o.status)}): ${i}`)}return o.json()}async listContexts(e){let r=new URLSearchParams({teamId:this.teamId,projectId:this.projectId});return e?.schemaKey&&r.set("schemaKey",e.schemaKey),e?.tier!==void 0&&r.set("tier",String(e.tier)),e?.state&&r.set("state",e.state),e?.contextType&&r.set("contextType",e.contextType),e?.parentContextId&&r.set("parentContextId",e.parentContextId),this.request(`/contexts?${r.toString()}`)}async getContext(e){return this.request(`/contexts/${encodeURIComponent(e)}`)}async createContext(e){return this.request("/contexts",{method:"POST",body:JSON.stringify(e)})}async updateContext(e,r){return this.request(`/contexts/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(r)})}async deleteContext(e){await this.request(`/contexts/${encodeURIComponent(e)}`,{method:"DELETE"})}async findBySchemaKey(e){return(await this.listContexts({schemaKey:e}))[0]??null}async findContextByName(e){return(await this.listContexts()).find(n=>n.name===e)??null}async searchContexts(e){let r=await this.listContexts(),n=e.toLowerCase();return r.filter(o=>o.name.toLowerCase().includes(n)||(o.description?.toLowerCase().includes(n)??!1))}async searchContent(e){return this.request(`/contexts/search?q=${encodeURIComponent(e)}&projectId=${encodeURIComponent(this.projectId)}`)}async getBrain(e,r){let n=new URLSearchParams({teamId:this.teamId,projectId:this.projectId});if(r&&n.set("includeDrafts","true"),e){let u=Object.entries(e).map(([l,d])=>`${l}:${String(d)}`).join(",");n.set("entriesLimit",u)}let o=n.toString();o!==this.brainParamsKey&&(this.brainETag=null,this.brainCache=null,this.brainParamsKey=o);let s={};this.brainETag&&(s["If-None-Match"]=this.brainETag);let i=`${this.baseUrl}/api/contexts/brain?${o}`,a=await fetch(i,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`,...s}});if(a.status===304&&this.brainCache)return this.brainCache;if(!a.ok){let u=await a.json().catch(()=>({})),l=typeof u.error=="string"?u.error:a.statusText;throw new Error(`API error (${String(a.status)}): ${l}`)}let c=await a.json();return this.brainETag=a.headers.get("etag"),this.brainCache=c,c}async createEntry(e){return this.request("/context-entries",{method:"POST",body:JSON.stringify(e)})}async listEntries(e,r){let n=new URLSearchParams({contextId:e});return r?.limit&&n.set("limit",String(r.limit)),r?.cursorAfter&&n.set("cursorAfter",r.cursorAfter),r?.entryType&&n.set("entryType",r.entryType),this.request(`/context-entries?${n.toString()}`)}async optimisticUpdate(e,r,n,o){for(let i=0;i<3;i++){let a=await this.getContext(e),c=a.content??"",u=r(c);try{return await this.updateContext(e,{content:u,version:a.version,source:n,sourceRef:o})}catch(l){if((l instanceof Error?l.message:String(l)).includes("409")&&i<2)continue;throw l}}throw new Error("OCC: max retries exceeded")}async populate(e,r,n){return this.request("/contexts/populate",{method:"POST",body:JSON.stringify({teamId:this.teamId,projectId:this.projectId,nodes:e,dryRun:r,source:n})})}async approveContext(e){await this.request(`/contexts/${encodeURIComponent(e)}/approve?action=approve`,{method:"POST"})}async deprecateContext(e){await this.request(`/contexts/${encodeURIComponent(e)}/approve?action=deprecate`,{method:"POST"})}async getTree(){return this.request(`/contexts/tree?teamId=${encodeURIComponent(this.teamId)}&projectId=${encodeURIComponent(this.projectId)}`)}async createLink(e,r,n,o,s){await this.request("/context-links",{method:"POST",body:JSON.stringify({teamId:this.teamId,projectId:this.projectId,fromSchemaKey:e,toSchemaKey:r,linkType:n,reason:o,confidence:s,source:"mcp"})})}async getLinks(e,r){let n=new URLSearchParams({teamId:this.teamId,projectId:this.projectId,schemaKey:e});return r&&n.set("direction",r),this.request(`/context-links?${n.toString()}`)}async compactContext(e){return this.request(`/contexts/${encodeURIComponent(e)}/compact`,{method:"POST"})}static generateUlid(){return Wg()}};var Nt=[{id:"architecture",name:"Architecture",description:"Tech stack, architecture decisions, design patterns, project structure, infrastructure",order:0},{id:"conventions",name:"Conventions & Rules",description:"Coding conventions, style rules, linter gotchas, naming patterns, team agreements",order:1},{id:"implementation",name:"Implementation Log",description:"Features built, components created, APIs implemented, integrations added",order:2},{id:"decisions",name:"Technical Decisions",description:"Key decisions with rationale: why X over Y, trade-offs considered, constraints",order:3},{id:"bugs",name:"Bugs & Fixes",description:"Bugs found and how they were fixed, edge cases discovered, workarounds applied",order:4},{id:"todo",name:"Todo & Next Steps",description:"Pending tasks, known issues, planned improvements, tech debt to address",order:5},{id:"sessions",name:"Session Log",description:"Chronological log of all AI sessions with date and summary",order:6}],jr="Project Memory",Xg="Root context for AI project memory \u2014 contains all sub-contexts";function hn(t){return`[Memory] ${t.name}`}function _i(t){return Nt.find(e=>e.id===t)}async function Yg(t){try{return await mT(t)}catch{return hT(t)}}async function mT(t){let e=await t.getBrain({bugs:10,sessions:3});return{document:e.document,tokenEstimate:e.tokenEstimate,subContextCount:e.loadedContexts,rootId:e.tree[0]?.id??null}}async function hT(t){let e=await t.listContexts();if(e.length===0)return{document:`# Project Memory

_No context saved yet. This is the first session._
`,tokenEstimate:15,subContextCount:0,rootId:null};let r=e.find(l=>l.name===jr),n=r?.id??null,o=[];if(o.push(`# Project Memory
`),r){let l=await ed(t,r);if(l){let d=l.match(/\*\*Latest session\*\*: (.+)/);d&&o.push(`> Last session: ${d[1]}
`)}}let s=0;for(let l of Nt){let d=hn(l),h=e.find(p=>p.name===d);if(!h)continue;let f=await ed(t,h);!f||f.trim().length===0||(s++,o.push(`## ${l.name}
`),o.push(f.trim()),o.push(""))}let i=new Set([jr,...Nt.map(l=>hn(l))]),a=e.filter(l=>!i.has(l.name));if(a.length>0){o.push(`## Custom Contexts
`);for(let l of a){let d=await ed(t,l);d&&d.trim().length>0&&(s++,o.push(`### ${l.name}`),l.description&&o.push(`> ${l.description}
`),o.push(d.trim()),o.push(""))}}let c=o.join(`
`),u=Math.ceil(c.length/4);return{document:c,tokenEstimate:u,subContextCount:s,rootId:n}}async function ed(t,e){if(e.content!=null&&e.content.length>0)return e.content;try{return(await t.getContext(e.id)).content??""}catch{return""}}var vi=require("node:crypto");var Qg={architecture:"root/stack",conventions:"root/conventions",implementation:"root/journal",decisions:"root/decisions",bugs:"root/bugs",todo:"root/todo",sessions:"root/sessions"},ey=new Map,gT={schemaKey:"root",name:"Project Memory",contextType:"system",tier:1,order:0,description:"Root context \u2014 project overview and metadata",storageModel:"content",writePolicy:"mcp",children:[{schemaKey:"root/cortex",name:"Cortex",contextType:"system",tier:1,order:1,description:"Auto-generated project summary \u2014 current focus, recent sessions",storageModel:"content",writePolicy:"mcp"},{schemaKey:"root/stack",name:"Stack & Infrastructure",contextType:"reference",tier:1,order:2,description:"Tech stack, architecture decisions, design patterns, project structure",storageModel:"content",writePolicy:"both",children:[{schemaKey:"root/stack/database",name:"Database Schema",contextType:"reference",tier:2,order:0,description:"Database schema, collections, indexes, relationships",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/stack/environment",name:"Environment & Config",contextType:"reference",tier:2,order:1,description:"Environment variables, configuration files, deployment settings",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/stack/deployment",name:"Deployment & CI/CD",contextType:"reference",tier:2,order:2,description:"Deployment setup, CI/CD pipelines, hosting infrastructure",storageModel:"content",writePolicy:"scanner"}]},{schemaKey:"root/api",name:"API Surface",contextType:"reference",tier:1,order:3,description:"API endpoints, request/response schemas, authentication",storageModel:"content",writePolicy:"scanner",links:[{toSchemaKey:"root/backend/auth",linkType:"see-also"},{toSchemaKey:"root/stack/database",linkType:"depends-on"}],children:[{schemaKey:"root/api/auth",name:"Auth & User Endpoints",contextType:"reference",tier:2,order:0,description:"Authentication, registration, password reset, session management",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/api/core",name:"Core Resource Endpoints",contextType:"reference",tier:2,order:1,description:"CRUD endpoints for core business entities",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/api/integrations",name:"Integration Endpoints",contextType:"reference",tier:2,order:2,description:"Third-party integration endpoints (Slack, VS Code, etc.)",storageModel:"content",writePolicy:"scanner"}]},{schemaKey:"root/frontend",name:"Frontend Architecture",contextType:"reference",tier:1,order:4,description:"Frontend components, pages, hooks, design system",storageModel:"content",writePolicy:"scanner",links:[{toSchemaKey:"root/frontend/design",linkType:"depends-on"},{toSchemaKey:"root/api",linkType:"see-also"}],children:[{schemaKey:"root/frontend/ui",name:"UI Component Library",contextType:"reference",tier:2,order:0,description:"Reusable UI components, their props and usage patterns",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/frontend/pages",name:"Page Components & Routes",contextType:"reference",tier:2,order:1,description:"Page-level components and routing structure",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/frontend/hooks",name:"Hooks & State Management",contextType:"reference",tier:2,order:2,description:"Custom hooks, state management patterns, data fetching",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/frontend/design",name:"Design System Tokens",contextType:"reference",tier:2,order:3,description:"Colors, typography, spacing, design tokens and variables",storageModel:"content",writePolicy:"scanner"}]},{schemaKey:"root/backend",name:"Backend Architecture",contextType:"reference",tier:1,order:5,description:"Backend modules, business logic, external integrations",storageModel:"content",writePolicy:"scanner",links:[{toSchemaKey:"root/stack/database",linkType:"depends-on"},{toSchemaKey:"root/api",linkType:"see-also"}],children:[{schemaKey:"root/backend/auth",name:"Auth & Security",contextType:"reference",tier:2,order:0,description:"Authentication middleware, RBAC, security patterns",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/backend/logic",name:"Business Logic Modules",contextType:"reference",tier:2,order:1,description:"Core business logic, validation, data processing",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/backend/integrations",name:"External Integrations",contextType:"reference",tier:2,order:2,description:"Third-party service integrations (Stripe, Appwrite, etc.)",storageModel:"content",writePolicy:"scanner"}]},{schemaKey:"root/packages",name:"Packages & Extensions",contextType:"reference",tier:1,order:6,description:"MCP server, CLI, Claude plugin, VS Code extension",storageModel:"content",writePolicy:"scanner",children:[{schemaKey:"root/packages/mcp",name:"MCP Server Package",contextType:"reference",tier:2,order:0,description:"MCP server implementation, tools, API client",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/packages/cli",name:"CLI Package",contextType:"reference",tier:2,order:1,description:"CLI commands, options, configuration",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/packages/plugin",name:"Claude Plugin Package",contextType:"reference",tier:2,order:2,description:"Claude Code plugin configuration and marketplace metadata",storageModel:"content",writePolicy:"scanner"},{schemaKey:"root/packages/vscode",name:"VS Code Extension",contextType:"reference",tier:2,order:3,description:"VS Code extension functionality and configuration",storageModel:"content",writePolicy:"scanner"}]},{schemaKey:"root/conventions",name:"Conventions & Patterns",contextType:"memory",tier:1,order:7,description:"Coding conventions, style rules, naming patterns, team agreements",storageModel:"content",writePolicy:"both"},{schemaKey:"root/decisions",name:"Architecture Decisions",contextType:"memory",tier:1,order:8,description:"Key decisions with rationale: why X over Y, trade-offs, constraints",storageModel:"content",writePolicy:"both"},{schemaKey:"root/todo",name:"Active Todo & Roadmap",contextType:"memory",tier:1,order:9,description:"Pending tasks, known issues, planned improvements, tech debt",storageModel:"content",writePolicy:"both"},{schemaKey:"root/bugs",name:"Bug Registry",contextType:"memory",tier:1,order:10,description:"Bugs found and how they were fixed, edge cases, workarounds",storageModel:"entries",writePolicy:"mcp"},{schemaKey:"root/journal",name:"Implementation Journal",contextType:"memory",tier:2,order:11,description:"Features built, components created, APIs implemented",storageModel:"entries",writePolicy:"mcp"},{schemaKey:"root/sessions",name:"Session Chronicle",contextType:"system",tier:2,order:12,description:"Chronological log of all AI sessions with date and summary",storageModel:"entries",writePolicy:"mcp"}]};function ty(t){if(ey.set(t.schemaKey,t),t.children)for(let e of t.children)ty(e)}ty(gT);function ry(t){return ey.get(t)?.storageModel==="entries"}var ny=48e3;async function sy(t,e){try{return await yT(t,e)}catch{return _T(t,e)}}async function yT(t,e){let r=0,n=0,o=[],s=await t.findBySchemaKey("root");s||(s=await t.createContext({name:"Project Memory",teamId:t.teamId,projectId:t.projectId,schemaKey:"root",contextType:"system",tier:1,state:"approved"}),r++);let i=iy(e.summary,0,e.changes);await t.updateContext(s.id,{content:i,source:"session-analyzer"});let a=new Map;for(let h of e.changes){let f=a.get(h.category)??[];f.push(h),a.set(h.category,f)}let c=(0,vi.createHash)("sha256").update(`${e.summary}:${new Date().toISOString()}`).digest("hex").slice(0,12);for(let[h,f]of a){let p=Qg[h];if(!p)continue;let m=await t.findBySchemaKey(p);if(!m){let g=_i(h);m=await t.createContext({name:g?.name??h,teamId:t.teamId,projectId:t.projectId,description:g?.description,parentContextId:s.id,schemaKey:p,contextType:"memory",tier:p.split("/").length<=2?1:2,state:"approved"}),r++}if(ry(p)){for(let g of f){let v=(0,vi.createHash)("sha256").update(`${m.id}:${c}:${g.title}`).digest("hex");await t.createEntry({contextId:m.id,title:g.title,content:g.content,entryType:h,source:"session-analyzer",sourceRef:c,idempotencyKey:v})}n++,o.push(p)}else{let g=`### ${new Date().toISOString().split("T")[0]} \u2014 ${e.summary.slice(0,80)}
`,v=f.map(b=>`**${b.title}**

${b.content.trim()}`).join(`

---

`),x=`${g}
${v}
`;await t.optimisticUpdate(m.id,b=>td(b,x),"session-analyzer",c),n++,o.push(p)}}let u=await t.findBySchemaKey("root/sessions");u||(u=await t.createContext({name:"Session Chronicle",teamId:t.teamId,projectId:t.projectId,description:"Chronological log of all AI sessions",parentContextId:s.id,schemaKey:"root/sessions",contextType:"system",tier:2,state:"approved"}),r++);let l=e.changes.map(h=>h.category).join(", "),d=(0,vi.createHash)("sha256").update(`${u.id}:${c}:session-log`).digest("hex");return await t.createEntry({contextId:u.id,title:e.summary.slice(0,200),content:`**Summary**: ${e.summary}
**Categories**: ${l}
**Affected**: ${o.join(", ")}`,entryType:"session",source:"session-analyzer",sourceRef:c,idempotencyKey:d}),o.includes("root/sessions")||o.push("root/sessions"),await vT(t,e.summary,s.id,u.id),o.includes("root/cortex")||o.push("root/cortex"),{created:r,updated:n,affected:o,rootId:s.id}}async function _T(t,e){let r=await t.listContexts(),n=new Map;for(let k of r)n.set(k.name,k);let o=n.get(jr),s=0,i=0,a=[];o||(o=await t.createContext({name:jr,teamId:t.teamId,projectId:t.projectId,description:Xg}),s++,a.push(jr));let c=r.filter(k=>k.parentContextId===o.id).length,u=iy(e.summary,c,e.changes);await t.updateContext(o.id,{content:u});let l=`### ${new Date().toISOString().split("T")[0]} \u2014 ${e.summary.slice(0,80)}
`,d=new Map;for(let k of e.changes){let N=_i(k.category);if(!N)continue;let he=d.get(N.id)??[];he.push(k),d.set(N.id,he)}for(let[k,N]of d){let he=_i(k),xe=hn(he),Ge=n.get(xe);Ge||(Ge=await t.createContext({name:xe,teamId:t.teamId,projectId:t.projectId,description:he.description,parentContextId:o.id}),n.set(xe,Ge),s++);let gn=await oy(t,Ge),Qt=N.map(_n=>`**${_n.title}**

${_n.content.trim()}`).join(`

---

`),yn=`${l}
${Qt}
`,ko=td(gn,yn);await t.updateContext(Ge.id,{content:ko,order:he.order}),i++,a.push(xe)}let h=Nt.find(k=>k.id==="sessions"),f=hn(h),p=n.get(f);p||(p=await t.createContext({name:f,teamId:t.teamId,projectId:t.projectId,description:h.description,parentContextId:o.id}),s++);let m=await oy(t,p),g=new Date().toISOString(),v=e.changes.map(k=>k.category).join(", "),x=`- **${g}**: ${e.summary} _(${v})_
`,b=td(m,x);return await t.updateContext(p.id,{content:b,order:h.order}),a.includes(f)||(i++,a.push(f)),{created:s,updated:i,affected:a,rootId:o.id}}async function vT(t,e,r,n){try{let o=await t.findBySchemaKey("root/cortex");o||(o=await t.createContext({name:"Cortex",teamId:t.teamId,projectId:t.projectId,description:"Auto-generated project summary \u2014 current focus, recent sessions",parentContextId:r,schemaKey:"root/cortex",contextType:"system",tier:1,state:"approved"}));let i=(await t.listEntries(n,{limit:3})).entries.map(c=>`- **${c.createdAt.split("T")[0]??c.createdAt}**: ${c.title}`),a=[`# Cortex \u2014 Project Focus
`,`> Last updated: ${new Date().toISOString()}
`,`## Current Focus
`,e,"",`## Recent Sessions
`,...i.length>0?i:["_No sessions recorded yet._"],""].join(`
`);await t.optimisticUpdate(o.id,()=>a,"session-analyzer")}catch{}}function iy(t,e,r){let n=[];n.push(`# Project Memory
`),n.push(`> Last session: ${new Date().toISOString()}
`),n.push(`**Sub-contexts**: ${String(e+1)}
`),n.push(`**Latest session**: ${t}
`),n.push(`## Categories
`);for(let o of Nt){let i=r.some(a=>a.category===o.id)?"(updated)":"";n.push(`- **${o.name}** \u2014 ${o.description} ${i}`)}return n.push(""),n.join(`
`)}async function oy(t,e){if(e.content!==null)return e.content;try{return(await t.getContext(e.id)).content??""}catch{return""}}function td(t,e){if(!t)return e;let r=`${t}
${e}`;if(r.length<=ny)return r;let n=r.length-ny,o=r.slice(n),s=o.indexOf(`
`);return s>0?`[...older entries trimmed...]
${o.slice(s+1)}`:o}var Re=new fi({name:"contox",version:"3.1.0"}),_e=new yi;Re.tool("contox_get_memory","Load the complete project memory. Call this at the START of every session to remember previous work. Returns a markdown document with: Architecture, Conventions, Implementation Log, Decisions, Bugs & Fixes, Todo, and Session Log.",{},async()=>{try{let t=await Yg(_e);return{content:[{type:"text",text:`${t.document}
---
_${String(t.subContextCount)} sub-contexts loaded (~${String(t.tokenEstimate)} tokens)_
`}]}}catch(t){return{content:[{type:"text",text:`Error loading memory: ${String(t)}`}],isError:!0}}});var xT=Nt.filter(t=>t.id!=="sessions").map(t=>`"${t.id}": ${t.description}`).join(`
`);Re.tool("contox_save_session",`Save this session's work into persistent project memory. Call this at the END of every session.

Provide a summary and structured changes. Each change has a category, title, and content.

Available categories:
${xT}

The session log is updated automatically. Content is APPENDED to existing sub-contexts (never overwritten).`,{summary:A.string().describe("Brief session summary (1-3 sentences): what was accomplished"),changes:A.array(A.object({category:A.enum(["architecture","conventions","implementation","decisions","bugs","todo"]).describe("Category for this change"),title:A.string().describe('Brief title (e.g. "Added auth middleware", "Fixed CSS z-index bug")'),content:A.string().describe("Detailed content to save. Use markdown. Be specific and include file paths, patterns, key decisions.")})).describe("List of changes to save, organized by category")},async t=>{try{let e=await sy(_e,{summary:t.summary,changes:t.changes});return{content:[{type:"text",text:["Session saved successfully.",`- Created: ${String(e.created)} new sub-contexts`,`- Updated: ${String(e.updated)} existing sub-contexts`,`- Affected: ${e.affected.join(", ")}`].join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Error saving session: ${String(e)}`}],isError:!0}}});Re.tool("contox_list_contexts","List all contexts for the current project (including sub-contexts)",{},async()=>{try{let e=(await _e.listContexts()).map(r=>({id:r.id,name:r.name,description:r.description,parentContextId:r.parentContextId,schemaKey:r.schemaKey,tier:r.tier,state:r.state,tokens:r.tokens,updatedAt:r.updatedAt}));return{content:[{type:"text",text:JSON.stringify(e,null,2)}]}}catch(t){return{content:[{type:"text",text:`Error: ${String(t)}`}],isError:!0}}});Re.tool("contox_get_context","Get a specific context by ID, including its full content",{id:A.string().describe("The context ID")},async t=>{try{let e=await _e.getContext(t.id);return{content:[{type:"text",text:JSON.stringify(e,null,2)}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_create_context","Create a new context manually. For session-based memory, prefer contox_save_session.",{name:A.string().describe("Context name"),description:A.string().optional().describe("Optional description"),content:A.string().optional().describe("Optional initial content"),parentContextId:A.string().optional().describe("Optional parent context ID for hierarchy")},async t=>{try{let e=await _e.createContext({name:t.name,teamId:_e.teamId,projectId:_e.projectId,description:t.description,parentContextId:t.parentContextId});return t.content&&await _e.updateContext(e.id,{content:t.content}),{content:[{type:"text",text:`Context created: ${e.name} (${e.id})`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_update_context","Update an existing context (name, description, or content). Content is replaced, not appended. For incremental updates, prefer contox_save_session.",{id:A.string().describe("The context ID to update"),name:A.string().optional().describe("New name"),description:A.string().optional().describe("New description"),content:A.string().optional().describe("New content (replaces existing)")},async t=>{try{let e={};t.name!==void 0&&(e.name=t.name),t.description!==void 0&&(e.description=t.description),t.content!==void 0&&(e.content=t.content);let r=await _e.updateContext(t.id,e);return{content:[{type:"text",text:`Context updated: ${r.name} (${r.id})`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_delete_context","Delete a context by ID. This is irreversible.",{id:A.string().describe("The context ID to delete")},async t=>{try{return await _e.deleteContext(t.id),{content:[{type:"text",text:`Context deleted: ${t.id}`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_search",`Search contexts by name, description, AND content. Use this to find specific code patterns, function signatures, API endpoints, component props, or any information stored in the project memory. Returns matching snippets with surrounding context.

Examples: "useAuth", "stripe", "password reset", "Button props", "GET /api/contexts"`,{query:A.string().describe("Search query \u2014 searches across all context content, names, and descriptions")},async t=>{try{let e=await _e.searchContent(t.query);if(e.length===0)return{content:[{type:"text",text:`No results found for "${t.query}"`}]};let r=[];r.push(`Found ${String(e.length)} matching context(s) for "${t.query}":
`);for(let n of e){if(r.push(`## ${n.name}`),r.push(`> ID: ${n.id} | Match: ${n.matchType}`),n.description&&r.push(`> ${n.description}`),n.snippets.length>0){r.push("");for(let o of n.snippets)r.push("```"),r.push(o),r.push("```")}r.push("")}return{content:[{type:"text",text:r.join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_populate","Populate the brain hierarchy with structured contexts. Used by scanners and CLI to batch-create/update contexts by schemaKey. Created contexts default to state 'draft'. Returns audit trail with runId and diff stats.",{nodes:A.array(A.object({schemaKey:A.string().describe('Unique schema key (e.g. "root/api/auth")'),name:A.string().describe("Display name for the context"),content:A.string().optional().describe("Markdown content"),description:A.string().optional().describe("Brief description"),contextType:A.enum(["system","reference","memory"]).optional().describe("Context type"),tier:A.number().optional().describe("Tier (1=always loaded, 2=on-demand, 3=archive)"),parentSchemaKey:A.string().optional().describe("Parent schema key for hierarchy")})).describe("List of nodes to populate"),dryRun:A.boolean().optional().describe("If true, only return diff stats without writing"),source:A.string().optional().describe('Source identifier (e.g. "cli-scan", "mcp-populate")')},async t=>{try{let e=await _e.populate(t.nodes,t.dryRun,t.source);return{content:[{type:"text",text:[`Populate ${t.dryRun?"(dry run) ":""}completed.`,`- Run ID: ${e.runId}`,`- Created: ${String(e.created)}`,`- Updated: ${String(e.updated)}`,`- Unchanged: ${String(e.unchanged)}`,`- Errors: ${String(e.errors)}`].join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_add_entry","Add an entry to a journal-like context (bugs, implementation journal, sessions). Entries are INSERT-only (event-sourced) and idempotent via idempotencyKey. Uses client-generated ULID for monotone ordering.",{contextId:A.string().describe("Target context ID"),title:A.string().describe("Entry title (max 200 chars)"),content:A.string().describe("Entry content in markdown"),entryType:A.string().optional().describe('Entry type (e.g. "bug-fix", "feature", "session")'),tags:A.array(A.string()).optional().describe("Tags for categorization"),idempotencyKey:A.string().optional().describe("Idempotency key for retry safety"),source:A.string().optional().describe("Source identifier"),sourceRef:A.string().optional().describe("Source reference (commit SHA, session ID, etc.)")},async t=>{try{let e=await _e.createEntry({contextId:t.contextId,title:t.title,content:t.content,entryType:t.entryType,tags:t.tags,idempotencyKey:t.idempotencyKey,source:t.source,sourceRef:t.sourceRef});return{content:[{type:"text",text:`Entry added: ${e.title} (${e.id})`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_get_tree","Get the hierarchical brain tree for the current project. Returns a nested tree of contexts with schemaKey, tier, state, contextType, and children. Useful for understanding the project knowledge structure at a glance.",{},async()=>{try{let t=await _e.getTree();return{content:[{type:"text",text:JSON.stringify(t.tree,null,2)}]}}catch(t){return{content:[{type:"text",text:`Error: ${String(t)}`}],isError:!0}}});Re.tool("contox_approve","Approve or deprecate a context (state machine). Approved contexts are included in the brain document. Deprecated contexts are hidden. Only works on contexts with a state (draft \u2192 approved \u2192 deprecated).",{id:A.string().describe("The context ID"),action:A.enum(["approve","deprecate"]).describe('"approve" to make visible in brain, "deprecate" to hide')},async t=>{try{return t.action==="approve"?await _e.approveContext(t.id):await _e.deprecateContext(t.id),{content:[{type:"text",text:`Context ${t.action==="approve"?"approved":"deprecated"}: ${t.id}`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_get_links","Get links for a context by its schemaKey. Returns incoming and outgoing links with linkType, reason, and confidence. Links represent relationships between contexts (see-also, depends-on, child-of, related).",{schemaKey:A.string().describe('The schemaKey of the context (e.g. "root/api/auth")'),direction:A.enum(["both","outgoing","incoming"]).optional().describe("Filter direction (default: both)")},async t=>{try{let e=await _e.getLinks(t.schemaKey,t.direction),r=[];if(e.outgoing.length>0){r.push(`## Outgoing (${String(e.outgoing.length)})`);for(let n of e.outgoing)r.push(`- \u2192 ${n.toSchemaKey} [${n.linkType}]${n.reason?` \u2014 ${n.reason}`:""}${n.confidence!==null?` (conf: ${String(n.confidence)})`:""}`)}if(e.incoming.length>0){r.push(`## Incoming (${String(e.incoming.length)})`);for(let n of e.incoming)r.push(`- \u2190 ${n.fromSchemaKey} [${n.linkType}]${n.reason?` \u2014 ${n.reason}`:""}${n.confidence!==null?` (conf: ${String(n.confidence)})`:""}`)}return r.length===0&&r.push(`No links found for "${t.schemaKey}"`),{content:[{type:"text",text:r.join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_add_link",'Create a directed link between two contexts by their schemaKeys. Links form a knowledge graph \u2014 use them to express relationships like "depends-on", "see-also", "child-of", or "related".',{from:A.string().describe('Source schemaKey (e.g. "root/frontend/hooks")'),to:A.string().describe('Target schemaKey (e.g. "root/api/auth")'),linkType:A.enum(["see-also","depends-on","child-of","related"]).describe("Type of relationship"),reason:A.string().optional().describe("Why this link exists"),confidence:A.number().optional().describe("Confidence score 0-1 (e.g. 0.9 = very confident)")},async t=>{try{return await _e.createLink(t.from,t.to,t.linkType,t.reason,t.confidence),{content:[{type:"text",text:`Link created: ${t.from} \u2192 ${t.to} [${t.linkType}]`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Re.tool("contox_compact","Compact entries for a journal-like context (bugs, journal, sessions). Summarizes all entries into a single content block, reducing token count while preserving key information. Use when a context has too many entries.",{id:A.string().describe("The context ID to compact")},async t=>{try{let e=await _e.compactContext(t.id);return{content:[{type:"text",text:[`Compaction completed for context ${t.id}:`,`- Entries processed: ${String(e.entriesCount)}`,`- Summary length: ${String(e.summaryLength)} chars`,`- ${e.message}`].join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});async function bT(){let t=new hi;await Re.connect(t)}bT().catch(t=>{console.error("Fatal error:",t),process.exit(1)});
