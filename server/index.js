#!/usr/bin/env node
"use strict";var Jg=Object.create;var fi=Object.defineProperty;var Gg=Object.getOwnPropertyDescriptor;var Wg=Object.getOwnPropertyNames;var Xg=Object.getPrototypeOf,Yg=Object.prototype.hasOwnProperty;var z=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),mi=(t,e)=>{for(var r in e)fi(t,r,{get:e[r],enumerable:!0})},Qg=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Wg(e))!Yg.call(t,o)&&o!==r&&fi(t,o,{get:()=>e[o],enumerable:!(n=Gg(e,o))||n.enumerable});return t};var hi=(t,e,r)=>(r=t!=null?Jg(Xg(t)):{},Qg(e||!t||!t.__esModule?fi(r,"default",{value:t,enumerable:!0}):r,t));var Bn=z(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.regexpCode=X.getEsmExportName=X.getProperty=X.safeStringify=X.stringify=X.strConcat=X.addCodeArg=X.str=X._=X.nil=X._Code=X.Name=X.IDENTIFIER=X._CodeOrName=void 0;var Fn=class{};X._CodeOrName=Fn;X.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var wr=class extends Fn{constructor(e){if(super(),!X.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};X.Name=wr;var Ye=class extends Fn{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof wr&&(r[n.str]=(r[n.str]||0)+1),r),{})}};X._Code=Ye;X.nil=new Ye("");function Hf(t,...e){let r=[t[0]],n=0;for(;n<e.length;)Qc(r,e[n]),r.push(t[++n]);return new Ye(r)}X._=Hf;var Yc=new Ye("+");function Bf(t,...e){let r=[Hn(t[0])],n=0;for(;n<e.length;)r.push(Yc),Qc(r,e[n]),r.push(Yc,Hn(t[++n]));return Wb(r),new Ye(r)}X.str=Bf;function Qc(t,e){e instanceof Ye?t.push(...e._items):e instanceof wr?t.push(e):t.push(Qb(e))}X.addCodeArg=Qc;function Wb(t){let e=1;for(;e<t.length-1;){if(t[e]===Yc){let r=Xb(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function Xb(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof wr||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof wr))return`"${t}${e.slice(1)}`}function Yb(t,e){return e.emptyStr()?t:t.emptyStr()?e:Bf`${t}${e}`}X.strConcat=Yb;function Qb(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Hn(Array.isArray(t)?t.join(","):t)}function e$(t){return new Ye(Hn(t))}X.stringify=e$;function Hn(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}X.safeStringify=Hn;function t$(t){return typeof t=="string"&&X.IDENTIFIER.test(t)?new Ye(`.${t}`):Hf`[${t}]`}X.getProperty=t$;function r$(t){if(typeof t=="string"&&X.IDENTIFIER.test(t))return new Ye(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}X.getEsmExportName=r$;function n$(t){return new Ye(t.toString())}X.regexpCode=n$});var ru=z(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.ValueScope=qe.ValueScopeName=qe.Scope=qe.varKinds=qe.UsedValueState=void 0;var De=Bn(),eu=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},ws;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(ws||(qe.UsedValueState=ws={}));qe.varKinds={const:new De.Name("const"),let:new De.Name("let"),var:new De.Name("var")};var ks=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof De.Name?e:this.name(e)}name(e){return new De.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};qe.Scope=ks;var Ss=class extends De.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,De._)`.${new De.Name(r)}[${n}]`}};qe.ValueScopeName=Ss;var o$=(0,De._)`\n`,tu=class extends ks{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?o$:De.nil}}get(){return this._scope}name(e){return new Ss(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let o=this.toName(e),{prefix:s}=o,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[s];if(a){let l=a.get(i);if(l)return l}else a=this._values[s]=new Map;a.set(i,o);let c=this._scope[s]||(this._scope[s]=[]),u=c.length;return c[u]=r.ref,o.setValue(r,{property:s,itemIndex:u}),o}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,De._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,o=>{if(o.value===void 0)throw new Error(`CodeGen: name "${o}" has no value`);return o.value.code},r,n)}_reduceValues(e,r,n={},o){let s=De.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,ws.Started);let l=r(u);if(l){let d=this.opts.es5?qe.varKinds.var:qe.varKinds.const;s=(0,De._)`${s}${d} ${u} = ${l};${this.opts._n}`}else if(l=o?.(u))s=(0,De._)`${s}${l}${this.opts._n}`;else throw new eu(u);c.set(u,ws.Completed)})}return s}};qe.ValueScope=tu});var U=z(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.or=V.and=V.not=V.CodeGen=V.operators=V.varKinds=V.ValueScopeName=V.ValueScope=V.Scope=V.Name=V.regexpCode=V.stringify=V.getProperty=V.nil=V.strConcat=V.str=V._=void 0;var G=Bn(),it=ru(),Ft=Bn();Object.defineProperty(V,"_",{enumerable:!0,get:function(){return Ft._}});Object.defineProperty(V,"str",{enumerable:!0,get:function(){return Ft.str}});Object.defineProperty(V,"strConcat",{enumerable:!0,get:function(){return Ft.strConcat}});Object.defineProperty(V,"nil",{enumerable:!0,get:function(){return Ft.nil}});Object.defineProperty(V,"getProperty",{enumerable:!0,get:function(){return Ft.getProperty}});Object.defineProperty(V,"stringify",{enumerable:!0,get:function(){return Ft.stringify}});Object.defineProperty(V,"regexpCode",{enumerable:!0,get:function(){return Ft.regexpCode}});Object.defineProperty(V,"Name",{enumerable:!0,get:function(){return Ft.Name}});var Es=ru();Object.defineProperty(V,"Scope",{enumerable:!0,get:function(){return Es.Scope}});Object.defineProperty(V,"ValueScope",{enumerable:!0,get:function(){return Es.ValueScope}});Object.defineProperty(V,"ValueScopeName",{enumerable:!0,get:function(){return Es.ValueScopeName}});Object.defineProperty(V,"varKinds",{enumerable:!0,get:function(){return Es.varKinds}});V.operators={GT:new G._Code(">"),GTE:new G._Code(">="),LT:new G._Code("<"),LTE:new G._Code("<="),EQ:new G._Code("==="),NEQ:new G._Code("!=="),NOT:new G._Code("!"),OR:new G._Code("||"),AND:new G._Code("&&"),ADD:new G._Code("+")};var Tt=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},nu=class extends Tt{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?it.varKinds.var:this.varKind,o=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${o};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=Xr(this.rhs,e,r)),this}get names(){return this.rhs instanceof G._CodeOrName?this.rhs.names:{}}},zs=class extends Tt{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof G.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=Xr(this.rhs,e,r),this}get names(){let e=this.lhs instanceof G.Name?{}:{...this.lhs.names};return Ps(e,this.rhs)}},ou=class extends zs{constructor(e,r,n,o){super(e,n,o),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},su=class extends Tt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},iu=class extends Tt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},au=class extends Tt{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},cu=class extends Tt{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=Xr(this.code,e,r),this}get names(){return this.code instanceof G._CodeOrName?this.code.names:{}}},Kn=class extends Tt{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,o=n.length;for(;o--;){let s=n[o];s.optimizeNames(e,r)||(s$(e,s.names),n.splice(o,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>zr(e,r.names),{})}},Pt=class extends Kn{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},uu=class extends Kn{},Wr=class extends Pt{};Wr.kind="else";var kr=class t extends Pt{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new Wr(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(Kf(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=Xr(this.condition,e,r),this}get names(){let e=super.names;return Ps(e,this.condition),this.else&&zr(e,this.else.names),e}};kr.kind="if";var Sr=class extends Pt{};Sr.kind="for";var lu=class extends Sr{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=Xr(this.iteration,e,r),this}get names(){return zr(super.names,this.iteration.names)}},du=class extends Sr{constructor(e,r,n,o){super(),this.varKind=e,this.name=r,this.from=n,this.to=o}render(e){let r=e.es5?it.varKinds.var:this.varKind,{name:n,from:o,to:s}=this;return`for(${r} ${n}=${o}; ${n}<${s}; ${n}++)`+super.render(e)}get names(){let e=Ps(super.names,this.from);return Ps(e,this.to)}},Ts=class extends Sr{constructor(e,r,n,o){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=o}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=Xr(this.iterable,e,r),this}get names(){return zr(super.names,this.iterable.names)}},Jn=class extends Pt{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Jn.kind="func";var Gn=class extends Kn{render(e){return"return "+super.render(e)}};Gn.kind="return";var pu=class extends Pt{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,o;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(o=this.finally)===null||o===void 0||o.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&zr(e,this.catch.names),this.finally&&zr(e,this.finally.names),e}},Wn=class extends Pt{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Wn.kind="catch";var Xn=class extends Pt{render(e){return"finally"+super.render(e)}};Xn.kind="finally";var fu=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new it.Scope({parent:e}),this._nodes=[new uu]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,o){let s=this._scope.toName(r);return n!==void 0&&o&&(this._constants[s.str]=n),this._leafNode(new nu(e,s,n)),s}const(e,r,n){return this._def(it.varKinds.const,e,r,n)}let(e,r,n){return this._def(it.varKinds.let,e,r,n)}var(e,r,n){return this._def(it.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new zs(e,r,n))}add(e,r){return this._leafNode(new ou(e,V.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==G.nil&&this._leafNode(new cu(e)),this}object(...e){let r=["{"];for(let[n,o]of e)r.length>1&&r.push(","),r.push(n),(n!==o||this.opts.es5)&&(r.push(":"),(0,G.addCodeArg)(r,o));return r.push("}"),new G._Code(r)}if(e,r,n){if(this._blockNode(new kr(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new kr(e))}else(){return this._elseNode(new Wr)}endIf(){return this._endBlockNode(kr,Wr)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new lu(e),r)}forRange(e,r,n,o,s=this.opts.es5?it.varKinds.var:it.varKinds.let){let i=this._scope.toName(e);return this._for(new du(s,i,r,n),()=>o(i))}forOf(e,r,n,o=it.varKinds.const){let s=this._scope.toName(e);if(this.opts.es5){let i=r instanceof G.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,G._)`${i}.length`,a=>{this.var(s,(0,G._)`${i}[${a}]`),n(s)})}return this._for(new Ts("of",o,s,r),()=>n(s))}forIn(e,r,n,o=this.opts.es5?it.varKinds.var:it.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,G._)`Object.keys(${r})`,n);let s=this._scope.toName(e);return this._for(new Ts("in",o,s,r),()=>n(s))}endFor(){return this._endBlockNode(Sr)}label(e){return this._leafNode(new su(e))}break(e){return this._leafNode(new iu(e))}return(e){let r=new Gn;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Gn)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let o=new pu;if(this._blockNode(o),this.code(e),r){let s=this.name("e");this._currNode=o.catch=new Wn(s),r(s)}return n&&(this._currNode=o.finally=new Xn,this.code(n)),this._endBlockNode(Wn,Xn)}throw(e){return this._leafNode(new au(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=G.nil,n,o){return this._blockNode(new Jn(e,r,n)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(Jn)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof kr))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};V.CodeGen=fu;function zr(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function Ps(t,e){return e instanceof G._CodeOrName?zr(t,e.names):t}function Xr(t,e,r){if(t instanceof G.Name)return n(t);if(!o(t))return t;return new G._Code(t._items.reduce((s,i)=>(i instanceof G.Name&&(i=n(i)),i instanceof G._Code?s.push(...i._items):s.push(i),s),[]));function n(s){let i=r[s.str];return i===void 0||e[s.str]!==1?s:(delete e[s.str],i)}function o(s){return s instanceof G._Code&&s._items.some(i=>i instanceof G.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function s$(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Kf(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,G._)`!${mu(t)}`}V.not=Kf;var i$=Jf(V.operators.AND);function a$(...t){return t.reduce(i$)}V.and=a$;var c$=Jf(V.operators.OR);function u$(...t){return t.reduce(c$)}V.or=u$;function Jf(t){return(e,r)=>e===G.nil?r:r===G.nil?e:(0,G._)`${mu(e)} ${t} ${mu(r)}`}function mu(t){return t instanceof G.Name?t:(0,G._)`(${t})`}});var Y=z(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.checkStrictMode=F.getErrorPath=F.Type=F.useFunc=F.setEvaluated=F.evaluatedPropsToName=F.mergeEvaluated=F.eachItem=F.unescapeJsonPointer=F.escapeJsonPointer=F.escapeFragment=F.unescapeFragment=F.schemaRefOrVal=F.schemaHasRulesButRef=F.schemaHasRules=F.checkUnknownRules=F.alwaysValidSchema=F.toHash=void 0;var re=U(),l$=Bn();function d$(t){let e={};for(let r of t)e[r]=!0;return e}F.toHash=d$;function p$(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(Xf(t,e),!Yf(e,t.self.RULES.all))}F.alwaysValidSchema=p$;function Xf(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let o=n.RULES.keywords;for(let s in e)o[s]||tm(t,`unknown keyword: "${s}"`)}F.checkUnknownRules=Xf;function Yf(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}F.schemaHasRules=Yf;function f$(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}F.schemaHasRulesButRef=f$;function m$({topSchemaRef:t,schemaPath:e},r,n,o){if(!o){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,re._)`${r}`}return(0,re._)`${t}${e}${(0,re.getProperty)(n)}`}F.schemaRefOrVal=m$;function h$(t){return Qf(decodeURIComponent(t))}F.unescapeFragment=h$;function g$(t){return encodeURIComponent(gu(t))}F.escapeFragment=g$;function gu(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}F.escapeJsonPointer=gu;function Qf(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}F.unescapeJsonPointer=Qf;function y$(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}F.eachItem=y$;function Gf({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(o,s,i,a)=>{let c=i===void 0?s:i instanceof re.Name?(s instanceof re.Name?t(o,s,i):e(o,s,i),i):s instanceof re.Name?(e(o,i,s),s):r(s,i);return a===re.Name&&!(c instanceof re.Name)?n(o,c):c}}F.mergeEvaluated={props:Gf({mergeNames:(t,e,r)=>t.if((0,re._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,re._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,re._)`${r} || {}`).code((0,re._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,re._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,re._)`${r} || {}`),yu(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:em}),items:Gf({mergeNames:(t,e,r)=>t.if((0,re._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,re._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,re._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,re._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function em(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,re._)`{}`);return e!==void 0&&yu(t,r,e),r}F.evaluatedPropsToName=em;function yu(t,e,r){Object.keys(r).forEach(n=>t.assign((0,re._)`${e}${(0,re.getProperty)(n)}`,!0))}F.setEvaluated=yu;var Wf={};function _$(t,e){return t.scopeValue("func",{ref:e,code:Wf[e.code]||(Wf[e.code]=new l$._Code(e.code))})}F.useFunc=_$;var hu;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(hu||(F.Type=hu={}));function v$(t,e,r){if(t instanceof re.Name){let n=e===hu.Num;return r?n?(0,re._)`"[" + ${t} + "]"`:(0,re._)`"['" + ${t} + "']"`:n?(0,re._)`"/" + ${t}`:(0,re._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,re.getProperty)(t).toString():"/"+gu(t)}F.getErrorPath=v$;function tm(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}F.checkStrictMode=tm});var Et=z(_u=>{"use strict";Object.defineProperty(_u,"__esModule",{value:!0});var Pe=U(),x$={data:new Pe.Name("data"),valCxt:new Pe.Name("valCxt"),instancePath:new Pe.Name("instancePath"),parentData:new Pe.Name("parentData"),parentDataProperty:new Pe.Name("parentDataProperty"),rootData:new Pe.Name("rootData"),dynamicAnchors:new Pe.Name("dynamicAnchors"),vErrors:new Pe.Name("vErrors"),errors:new Pe.Name("errors"),this:new Pe.Name("this"),self:new Pe.Name("self"),scope:new Pe.Name("scope"),json:new Pe.Name("json"),jsonPos:new Pe.Name("jsonPos"),jsonLen:new Pe.Name("jsonLen"),jsonPart:new Pe.Name("jsonPart")};_u.default=x$});var Yn=z(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.extendErrors=Ee.resetErrorsCount=Ee.reportExtraError=Ee.reportError=Ee.keyword$DataError=Ee.keywordError=void 0;var W=U(),Is=Y(),Oe=Et();Ee.keywordError={message:({keyword:t})=>(0,W.str)`must pass "${t}" keyword validation`};Ee.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,W.str)`"${t}" keyword must be ${e} ($data)`:(0,W.str)`"${t}" keyword is invalid ($data)`};function b$(t,e=Ee.keywordError,r,n){let{it:o}=t,{gen:s,compositeRule:i,allErrors:a}=o,c=om(t,e,r);n??(i||a)?rm(s,c):nm(o,(0,W._)`[${c}]`)}Ee.reportError=b$;function $$(t,e=Ee.keywordError,r){let{it:n}=t,{gen:o,compositeRule:s,allErrors:i}=n,a=om(t,e,r);rm(o,a),s||i||nm(n,Oe.default.vErrors)}Ee.reportExtraError=$$;function w$(t,e){t.assign(Oe.default.errors,e),t.if((0,W._)`${Oe.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,W._)`${Oe.default.vErrors}.length`,e),()=>t.assign(Oe.default.vErrors,null)))}Ee.resetErrorsCount=w$;function k$({gen:t,keyword:e,schemaValue:r,data:n,errsCount:o,it:s}){if(o===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",o,Oe.default.errors,a=>{t.const(i,(0,W._)`${Oe.default.vErrors}[${a}]`),t.if((0,W._)`${i}.instancePath === undefined`,()=>t.assign((0,W._)`${i}.instancePath`,(0,W.strConcat)(Oe.default.instancePath,s.errorPath))),t.assign((0,W._)`${i}.schemaPath`,(0,W.str)`${s.errSchemaPath}/${e}`),s.opts.verbose&&(t.assign((0,W._)`${i}.schema`,r),t.assign((0,W._)`${i}.data`,n))})}Ee.extendErrors=k$;function rm(t,e){let r=t.const("err",e);t.if((0,W._)`${Oe.default.vErrors} === null`,()=>t.assign(Oe.default.vErrors,(0,W._)`[${r}]`),(0,W._)`${Oe.default.vErrors}.push(${r})`),t.code((0,W._)`${Oe.default.errors}++`)}function nm(t,e){let{gen:r,validateName:n,schemaEnv:o}=t;o.$async?r.throw((0,W._)`new ${t.ValidationError}(${e})`):(r.assign((0,W._)`${n}.errors`,e),r.return(!1))}var Tr={keyword:new W.Name("keyword"),schemaPath:new W.Name("schemaPath"),params:new W.Name("params"),propertyName:new W.Name("propertyName"),message:new W.Name("message"),schema:new W.Name("schema"),parentSchema:new W.Name("parentSchema")};function om(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,W._)`{}`:S$(t,e,r)}function S$(t,e,r={}){let{gen:n,it:o}=t,s=[z$(o,r),T$(t,r)];return P$(t,e,s),n.object(...s)}function z$({errorPath:t},{instancePath:e}){let r=e?(0,W.str)`${t}${(0,Is.getErrorPath)(e,Is.Type.Str)}`:t;return[Oe.default.instancePath,(0,W.strConcat)(Oe.default.instancePath,r)]}function T$({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let o=n?e:(0,W.str)`${e}/${t}`;return r&&(o=(0,W.str)`${o}${(0,Is.getErrorPath)(r,Is.Type.Str)}`),[Tr.schemaPath,o]}function P$(t,{params:e,message:r},n){let{keyword:o,data:s,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([Tr.keyword,o],[Tr.params,typeof e=="function"?e(t):e||(0,W._)`{}`]),c.messages&&n.push([Tr.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([Tr.schema,i],[Tr.parentSchema,(0,W._)`${l}${d}`],[Oe.default.data,s]),u&&n.push([Tr.propertyName,u])}});var im=z(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.boolOrEmptySchema=Yr.topBoolOrEmptySchema=void 0;var E$=Yn(),I$=U(),R$=Et(),C$={message:"boolean schema is false"};function O$(t){let{gen:e,schema:r,validateName:n}=t;r===!1?sm(t,!1):typeof r=="object"&&r.$async===!0?e.return(R$.default.data):(e.assign((0,I$._)`${n}.errors`,null),e.return(!0))}Yr.topBoolOrEmptySchema=O$;function Z$(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),sm(t)):r.var(e,!0)}Yr.boolOrEmptySchema=Z$;function sm(t,e){let{gen:r,data:n}=t,o={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,E$.reportError)(o,C$,void 0,e)}});var vu=z(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.getRules=Qr.isJSONType=void 0;var N$=["string","number","integer","boolean","null","object","array"],j$=new Set(N$);function A$(t){return typeof t=="string"&&j$.has(t)}Qr.isJSONType=A$;function M$(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Qr.getRules=M$});var xu=z(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.shouldUseRule=Ht.shouldUseGroup=Ht.schemaHasRulesForType=void 0;function D$({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&am(t,n)}Ht.schemaHasRulesForType=D$;function am(t,e){return e.rules.some(r=>cm(t,r))}Ht.shouldUseGroup=am;function cm(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Ht.shouldUseRule=cm});var Qn=z(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.reportTypeError=Ie.checkDataTypes=Ie.checkDataType=Ie.coerceAndCheckDataType=Ie.getJSONTypes=Ie.getSchemaTypes=Ie.DataType=void 0;var q$=vu(),L$=xu(),U$=Yn(),q=U(),um=Y(),en;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(en||(Ie.DataType=en={}));function V$(t){let e=lm(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Ie.getSchemaTypes=V$;function lm(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(q$.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Ie.getJSONTypes=lm;function F$(t,e){let{gen:r,data:n,opts:o}=t,s=H$(e,o.coerceTypes),i=e.length>0&&!(s.length===0&&e.length===1&&(0,L$.schemaHasRulesForType)(t,e[0]));if(i){let a=$u(e,n,o.strictNumbers,en.Wrong);r.if(a,()=>{s.length?B$(t,e,s):wu(t)})}return i}Ie.coerceAndCheckDataType=F$;var dm=new Set(["string","number","integer","boolean","null"]);function H$(t,e){return e?t.filter(r=>dm.has(r)||e==="array"&&r==="array"):[]}function B$(t,e,r){let{gen:n,data:o,opts:s}=t,i=n.let("dataType",(0,q._)`typeof ${o}`),a=n.let("coerced",(0,q._)`undefined`);s.coerceTypes==="array"&&n.if((0,q._)`${i} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>n.assign(o,(0,q._)`${o}[0]`).assign(i,(0,q._)`typeof ${o}`).if($u(e,o,s.strictNumbers),()=>n.assign(a,o))),n.if((0,q._)`${a} !== undefined`);for(let u of r)(dm.has(u)||u==="array"&&s.coerceTypes==="array")&&c(u);n.else(),wu(t),n.endIf(),n.if((0,q._)`${a} !== undefined`,()=>{n.assign(o,a),K$(t,a)});function c(u){switch(u){case"string":n.elseIf((0,q._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,q._)`"" + ${o}`).elseIf((0,q._)`${o} === null`).assign(a,(0,q._)`""`);return;case"number":n.elseIf((0,q._)`${i} == "boolean" || ${o} === null
              || (${i} == "string" && ${o} && ${o} == +${o})`).assign(a,(0,q._)`+${o}`);return;case"integer":n.elseIf((0,q._)`${i} === "boolean" || ${o} === null
              || (${i} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(a,(0,q._)`+${o}`);return;case"boolean":n.elseIf((0,q._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(a,!1).elseIf((0,q._)`${o} === "true" || ${o} === 1`).assign(a,!0);return;case"null":n.elseIf((0,q._)`${o} === "" || ${o} === 0 || ${o} === false`),n.assign(a,null);return;case"array":n.elseIf((0,q._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${o} === null`).assign(a,(0,q._)`[${o}]`)}}}function K$({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,q._)`${e} !== undefined`,()=>t.assign((0,q._)`${e}[${r}]`,n))}function bu(t,e,r,n=en.Correct){let o=n===en.Correct?q.operators.EQ:q.operators.NEQ,s;switch(t){case"null":return(0,q._)`${e} ${o} null`;case"array":s=(0,q._)`Array.isArray(${e})`;break;case"object":s=(0,q._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=i((0,q._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=i();break;default:return(0,q._)`typeof ${e} ${o} ${t}`}return n===en.Correct?s:(0,q.not)(s);function i(a=q.nil){return(0,q.and)((0,q._)`typeof ${e} == "number"`,a,r?(0,q._)`isFinite(${e})`:q.nil)}}Ie.checkDataType=bu;function $u(t,e,r,n){if(t.length===1)return bu(t[0],e,r,n);let o,s=(0,um.toHash)(t);if(s.array&&s.object){let i=(0,q._)`typeof ${e} != "object"`;o=s.null?i:(0,q._)`!${e} || ${i}`,delete s.null,delete s.array,delete s.object}else o=q.nil;s.number&&delete s.integer;for(let i in s)o=(0,q.and)(o,bu(i,e,r,n));return o}Ie.checkDataTypes=$u;var J$={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,q._)`{type: ${t}}`:(0,q._)`{type: ${e}}`};function wu(t){let e=G$(t);(0,U$.reportError)(e,J$)}Ie.reportTypeError=wu;function G$(t){let{gen:e,data:r,schema:n}=t,o=(0,um.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:o,schemaValue:o,parentSchema:n,params:{},it:t}}});var fm=z(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});Rs.assignDefaults=void 0;var tn=U(),W$=Y();function X$(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let o in r)pm(t,o,r[o].default);else e==="array"&&Array.isArray(n)&&n.forEach((o,s)=>pm(t,s,o.default))}Rs.assignDefaults=X$;function pm(t,e,r){let{gen:n,compositeRule:o,data:s,opts:i}=t;if(r===void 0)return;let a=(0,tn._)`${s}${(0,tn.getProperty)(e)}`;if(o){(0,W$.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,tn._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,tn._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,tn._)`${a} = ${(0,tn.stringify)(r)}`)}});var Qe=z(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.validateUnion=te.validateArray=te.usePattern=te.callValidateCode=te.schemaProperties=te.allSchemaProperties=te.noPropertyInData=te.propertyInData=te.isOwnProperty=te.hasPropFunc=te.reportMissingProp=te.checkMissingProp=te.checkReportMissingProp=void 0;var ie=U(),ku=Y(),Bt=Et(),Y$=Y();function Q$(t,e){let{gen:r,data:n,it:o}=t;r.if(zu(r,n,e,o.opts.ownProperties),()=>{t.setParams({missingProperty:(0,ie._)`${e}`},!0),t.error()})}te.checkReportMissingProp=Q$;function e0({gen:t,data:e,it:{opts:r}},n,o){return(0,ie.or)(...n.map(s=>(0,ie.and)(zu(t,e,s,r.ownProperties),(0,ie._)`${o} = ${s}`)))}te.checkMissingProp=e0;function t0(t,e){t.setParams({missingProperty:e},!0),t.error()}te.reportMissingProp=t0;function mm(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,ie._)`Object.prototype.hasOwnProperty`})}te.hasPropFunc=mm;function Su(t,e,r){return(0,ie._)`${mm(t)}.call(${e}, ${r})`}te.isOwnProperty=Su;function r0(t,e,r,n){let o=(0,ie._)`${e}${(0,ie.getProperty)(r)} !== undefined`;return n?(0,ie._)`${o} && ${Su(t,e,r)}`:o}te.propertyInData=r0;function zu(t,e,r,n){let o=(0,ie._)`${e}${(0,ie.getProperty)(r)} === undefined`;return n?(0,ie.or)(o,(0,ie.not)(Su(t,e,r))):o}te.noPropertyInData=zu;function hm(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}te.allSchemaProperties=hm;function n0(t,e){return hm(e).filter(r=>!(0,ku.alwaysValidSchema)(t,e[r]))}te.schemaProperties=n0;function o0({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:o,errorPath:s},it:i},a,c,u){let l=u?(0,ie._)`${t}, ${e}, ${n}${o}`:e,d=[[Bt.default.instancePath,(0,ie.strConcat)(Bt.default.instancePath,s)],[Bt.default.parentData,i.parentData],[Bt.default.parentDataProperty,i.parentDataProperty],[Bt.default.rootData,Bt.default.rootData]];i.opts.dynamicRef&&d.push([Bt.default.dynamicAnchors,Bt.default.dynamicAnchors]);let h=(0,ie._)`${l}, ${r.object(...d)}`;return c!==ie.nil?(0,ie._)`${a}.call(${c}, ${h})`:(0,ie._)`${a}(${h})`}te.callValidateCode=o0;var s0=(0,ie._)`new RegExp`;function i0({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:o}=e.code,s=o(r,n);return t.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,ie._)`${o.code==="new RegExp"?s0:(0,Y$.useFunc)(t,o)}(${r}, ${n})`})}te.usePattern=i0;function a0(t){let{gen:e,data:r,keyword:n,it:o}=t,s=e.name("valid");if(o.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(s,!0),i(()=>e.break()),s;function i(a){let c=e.const("len",(0,ie._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:ku.Type.Num},s),e.if((0,ie.not)(s),a)})}}te.validateArray=a0;function c0(t){let{gen:e,schema:r,keyword:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,ku.alwaysValidSchema)(o,c))&&!o.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,ie._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,ie.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}te.validateUnion=c0});var _m=z(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.validateKeywordUsage=gt.validSchemaType=gt.funcKeywordCode=gt.macroKeywordCode=void 0;var Ze=U(),Pr=Et(),u0=Qe(),l0=Yn();function d0(t,e){let{gen:r,keyword:n,schema:o,parentSchema:s,it:i}=t,a=e.macro.call(i.self,o,s,i),c=ym(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:Ze.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}gt.macroKeywordCode=d0;function p0(t,e){var r;let{gen:n,keyword:o,schema:s,parentSchema:i,$data:a,it:c}=t;m0(c,e);let u=!a&&e.compile?e.compile.call(c.self,s,i,c):e.validate,l=ym(n,o,u),d=n.let("valid");t.block$data(d,h),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function h(){if(e.errors===!1)m(),e.modifying&&gm(t),g(()=>t.error());else{let v=e.async?f():p();e.modifying&&gm(t),g(()=>f0(t,v))}}function f(){let v=n.let("ruleErrs",null);return n.try(()=>m((0,Ze._)`await `),x=>n.assign(d,!1).if((0,Ze._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(v,(0,Ze._)`${x}.errors`),()=>n.throw(x))),v}function p(){let v=(0,Ze._)`${l}.errors`;return n.assign(v,null),m(Ze.nil),v}function m(v=e.async?(0,Ze._)`await `:Ze.nil){let x=c.opts.passContext?Pr.default.this:Pr.default.self,w=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,Ze._)`${v}${(0,u0.callValidateCode)(t,l,x,w)}`,e.modifying)}function g(v){var x;n.if((0,Ze.not)((x=e.valid)!==null&&x!==void 0?x:d),v)}}gt.funcKeywordCode=p0;function gm(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Ze._)`${n.parentData}[${n.parentDataProperty}]`))}function f0(t,e){let{gen:r}=t;r.if((0,Ze._)`Array.isArray(${e})`,()=>{r.assign(Pr.default.vErrors,(0,Ze._)`${Pr.default.vErrors} === null ? ${e} : ${Pr.default.vErrors}.concat(${e})`).assign(Pr.default.errors,(0,Ze._)`${Pr.default.vErrors}.length`),(0,l0.extendErrors)(t)},()=>t.error())}function m0({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function ym(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Ze.stringify)(r)})}function h0(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}gt.validSchemaType=h0;function g0({schema:t,opts:e,self:r,errSchemaPath:n},o,s){if(Array.isArray(o.keyword)?!o.keyword.includes(s):o.keyword!==s)throw new Error("ajv implementation error");let i=o.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${s}: ${i.join(",")}`);if(o.validateSchema&&!o.validateSchema(t[s])){let c=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(o.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}gt.validateKeywordUsage=g0});var xm=z(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.extendSubschemaMode=Kt.extendSubschemaData=Kt.getSubschema=void 0;var yt=U(),vm=Y();function y0(t,{keyword:e,schemaProp:r,schema:n,schemaPath:o,errSchemaPath:s,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,yt._)`${t.schemaPath}${(0,yt.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,yt._)`${t.schemaPath}${(0,yt.getProperty)(e)}${(0,yt.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,vm.escapeFragment)(r)}`}}if(n!==void 0){if(o===void 0||s===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:o,topSchemaRef:i,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}Kt.getSubschema=y0;function _0(t,e,{dataProp:r,dataPropType:n,data:o,dataTypes:s,propertyName:i}){if(o!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,h=a.let("data",(0,yt._)`${e.data}${(0,yt.getProperty)(r)}`,!0);c(h),t.errorPath=(0,yt.str)`${u}${(0,vm.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,yt._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(o!==void 0){let u=o instanceof yt.Name?o:a.let("data",o,!0);c(u),i!==void 0&&(t.propertyName=i)}s&&(t.dataTypes=s);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Kt.extendSubschemaData=_0;function v0(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:o,allErrors:s}){n!==void 0&&(t.compositeRule=n),o!==void 0&&(t.createErrors=o),s!==void 0&&(t.allErrors=s),t.jtdDiscriminator=e,t.jtdMetadata=r}Kt.extendSubschemaMode=v0});var Tu=z((mC,bm)=>{"use strict";bm.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var i=s[o];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var wm=z((hC,$m)=>{"use strict";var Jt=$m.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},o=r.post||function(){};Cs(e,n,o,t,"",t)};Jt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Jt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Jt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Jt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Cs(t,e,r,n,o,s,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,o,s,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Jt.arrayKeywords)for(var h=0;h<d.length;h++)Cs(t,e,r,d[h],o+"/"+l+"/"+h,s,o,l,n,h)}else if(l in Jt.propsKeywords){if(d&&typeof d=="object")for(var f in d)Cs(t,e,r,d[f],o+"/"+l+"/"+x0(f),s,o,l,n,f)}else(l in Jt.keywords||t.allKeys&&!(l in Jt.skipKeywords))&&Cs(t,e,r,d,o+"/"+l,s,o,l,n)}r(n,o,s,i,a,c,u)}}function x0(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var eo=z(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.getSchemaRefs=Le.resolveUrl=Le.normalizeId=Le._getFullPath=Le.getFullPath=Le.inlineRef=void 0;var b0=Y(),$0=Tu(),w0=wm(),k0=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function S0(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Pu(t):e?km(t)<=e:!1}Le.inlineRef=S0;var z0=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Pu(t){for(let e in t){if(z0.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Pu)||typeof r=="object"&&Pu(r))return!0}return!1}function km(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!k0.has(r)&&(typeof t[r]=="object"&&(0,b0.eachItem)(t[r],n=>e+=km(n)),e===1/0))return 1/0}return e}function Sm(t,e="",r){r!==!1&&(e=rn(e));let n=t.parse(e);return zm(t,n)}Le.getFullPath=Sm;function zm(t,e){return t.serialize(e).split("#")[0]+"#"}Le._getFullPath=zm;var T0=/#\/?$/;function rn(t){return t?t.replace(T0,""):""}Le.normalizeId=rn;function P0(t,e,r){return r=rn(r),t.resolve(e,r)}Le.resolveUrl=P0;var E0=/^[a-z_][-a-z0-9._]*$/i;function I0(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,o=rn(t[r]||e),s={"":o},i=Sm(n,o,!1),a={},c=new Set;return w0(t,{allKeys:!0},(d,h,f,p)=>{if(p===void 0)return;let m=i+h,g=s[p];typeof d[r]=="string"&&(g=v.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),s[h]=g;function v(w){let k=this.opts.uriResolver.resolve;if(w=rn(g?k(g,w):w),c.has(w))throw l(w);c.add(w);let O=this.refs[w];return typeof O=="string"&&(O=this.refs[O]),typeof O=="object"?u(d,O.schema,w):w!==rn(m)&&(w[0]==="#"?(u(d,a[w],w),a[w]=d):this.refs[w]=m),w}function x(w){if(typeof w=="string"){if(!E0.test(w))throw new Error(`invalid anchor "${w}"`);v.call(this,`#${w}`)}}}),a;function u(d,h,f){if(h!==void 0&&!$0(d,h))throw l(f)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}Le.getSchemaRefs=I0});var no=z(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.getData=Gt.KeywordCxt=Gt.validateFunctionCode=void 0;var Rm=im(),Tm=Qn(),Iu=xu(),Os=Qn(),R0=fm(),ro=_m(),Eu=xm(),C=U(),M=Et(),C0=eo(),It=Y(),to=Yn();function O0(t){if(Zm(t)&&(Nm(t),Om(t))){j0(t);return}Cm(t,()=>(0,Rm.topBoolOrEmptySchema)(t))}Gt.validateFunctionCode=O0;function Cm({gen:t,validateName:e,schema:r,schemaEnv:n,opts:o},s){o.code.es5?t.func(e,(0,C._)`${M.default.data}, ${M.default.valCxt}`,n.$async,()=>{t.code((0,C._)`"use strict"; ${Pm(r,o)}`),N0(t,o),t.code(s)}):t.func(e,(0,C._)`${M.default.data}, ${Z0(o)}`,n.$async,()=>t.code(Pm(r,o)).code(s))}function Z0(t){return(0,C._)`{${M.default.instancePath}="", ${M.default.parentData}, ${M.default.parentDataProperty}, ${M.default.rootData}=${M.default.data}${t.dynamicRef?(0,C._)`, ${M.default.dynamicAnchors}={}`:C.nil}}={}`}function N0(t,e){t.if(M.default.valCxt,()=>{t.var(M.default.instancePath,(0,C._)`${M.default.valCxt}.${M.default.instancePath}`),t.var(M.default.parentData,(0,C._)`${M.default.valCxt}.${M.default.parentData}`),t.var(M.default.parentDataProperty,(0,C._)`${M.default.valCxt}.${M.default.parentDataProperty}`),t.var(M.default.rootData,(0,C._)`${M.default.valCxt}.${M.default.rootData}`),e.dynamicRef&&t.var(M.default.dynamicAnchors,(0,C._)`${M.default.valCxt}.${M.default.dynamicAnchors}`)},()=>{t.var(M.default.instancePath,(0,C._)`""`),t.var(M.default.parentData,(0,C._)`undefined`),t.var(M.default.parentDataProperty,(0,C._)`undefined`),t.var(M.default.rootData,M.default.data),e.dynamicRef&&t.var(M.default.dynamicAnchors,(0,C._)`{}`)})}function j0(t){let{schema:e,opts:r,gen:n}=t;Cm(t,()=>{r.$comment&&e.$comment&&Am(t),L0(t),n.let(M.default.vErrors,null),n.let(M.default.errors,0),r.unevaluated&&A0(t),jm(t),F0(t)})}function A0(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,C._)`${r}.evaluated`),e.if((0,C._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,C._)`${t.evaluated}.props`,(0,C._)`undefined`)),e.if((0,C._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,C._)`${t.evaluated}.items`,(0,C._)`undefined`))}function Pm(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,C._)`/*# sourceURL=${r} */`:C.nil}function M0(t,e){if(Zm(t)&&(Nm(t),Om(t))){D0(t,e);return}(0,Rm.boolOrEmptySchema)(t,e)}function Om({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function Zm(t){return typeof t.schema!="boolean"}function D0(t,e){let{schema:r,gen:n,opts:o}=t;o.$comment&&r.$comment&&Am(t),U0(t),V0(t);let s=n.const("_errs",M.default.errors);jm(t,s),n.var(e,(0,C._)`${s} === ${M.default.errors}`)}function Nm(t){(0,It.checkUnknownRules)(t),q0(t)}function jm(t,e){if(t.opts.jtd)return Em(t,[],!1,e);let r=(0,Tm.getSchemaTypes)(t.schema),n=(0,Tm.coerceAndCheckDataType)(t,r);Em(t,r,!n,e)}function q0(t){let{schema:e,errSchemaPath:r,opts:n,self:o}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,It.schemaHasRulesButRef)(e,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function L0(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,It.checkStrictMode)(t,"default is ignored in the schema root")}function U0(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,C0.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function V0(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function Am({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:o}){let s=r.$comment;if(o.$comment===!0)t.code((0,C._)`${M.default.self}.logger.log(${s})`);else if(typeof o.$comment=="function"){let i=(0,C.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,C._)`${M.default.self}.opts.$comment(${s}, ${i}, ${a}.schema)`)}}function F0(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:o,opts:s}=t;r.$async?e.if((0,C._)`${M.default.errors} === 0`,()=>e.return(M.default.data),()=>e.throw((0,C._)`new ${o}(${M.default.vErrors})`)):(e.assign((0,C._)`${n}.errors`,M.default.vErrors),s.unevaluated&&H0(t),e.return((0,C._)`${M.default.errors} === 0`))}function H0({gen:t,evaluated:e,props:r,items:n}){r instanceof C.Name&&t.assign((0,C._)`${e}.props`,r),n instanceof C.Name&&t.assign((0,C._)`${e}.items`,n)}function Em(t,e,r,n){let{gen:o,schema:s,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(s.$ref&&(c.ignoreKeywordsWithRef||!(0,It.schemaHasRulesButRef)(s,l))){o.block(()=>Dm(t,"$ref",l.all.$ref.definition));return}c.jtd||B0(t,e),o.block(()=>{for(let h of l.rules)d(h);d(l.post)});function d(h){(0,Iu.shouldUseGroup)(s,h)&&(h.type?(o.if((0,Os.checkDataType)(h.type,i,c.strictNumbers)),Im(t,h),e.length===1&&e[0]===h.type&&r&&(o.else(),(0,Os.reportTypeError)(t)),o.endIf()):Im(t,h),a||o.if((0,C._)`${M.default.errors} === ${n||0}`))}}function Im(t,e){let{gen:r,schema:n,opts:{useDefaults:o}}=t;o&&(0,R0.assignDefaults)(t,e.type),r.block(()=>{for(let s of e.rules)(0,Iu.shouldUseRule)(n,s)&&Dm(t,s.keyword,s.definition,e.type)})}function B0(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(K0(t,e),t.opts.allowUnionTypes||J0(t,e),G0(t,t.dataTypes))}function K0(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{Mm(t.dataTypes,r)||Ru(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),X0(t,e)}}function J0(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Ru(t,"use allowUnionTypes to allow union type keyword")}function G0(t,e){let r=t.self.RULES.all;for(let n in r){let o=r[n];if(typeof o=="object"&&(0,Iu.shouldUseRule)(t.schema,o)){let{type:s}=o.definition;s.length&&!s.some(i=>W0(e,i))&&Ru(t,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function W0(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function Mm(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function X0(t,e){let r=[];for(let n of t.dataTypes)Mm(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function Ru(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,It.checkStrictMode)(t,e,t.opts.strictTypes)}var Zs=class{constructor(e,r,n){if((0,ro.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,It.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",qm(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,ro.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",M.default.errors))}result(e,r,n){this.failResult((0,C.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,C.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,C._)`${r} !== undefined && (${(0,C.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?to.reportExtraError:to.reportError)(this,this.def.error,r)}$dataError(){(0,to.reportError)(this,this.def.$dataError||to.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,to.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=C.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=C.nil,r=C.nil){if(!this.$data)return;let{gen:n,schemaCode:o,schemaType:s,def:i}=this;n.if((0,C.or)((0,C._)`${o} === undefined`,r)),e!==C.nil&&n.assign(e,!0),(s.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==C.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:o,it:s}=this;return(0,C.or)(i(),a());function i(){if(n.length){if(!(r instanceof C.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,C._)`${(0,Os.checkDataTypes)(c,r,s.opts.strictNumbers,Os.DataType.Wrong)}`}return C.nil}function a(){if(o.validateSchema){let c=e.scopeValue("validate$data",{ref:o.validateSchema});return(0,C._)`!${c}(${r})`}return C.nil}}subschema(e,r){let n=(0,Eu.getSubschema)(this.it,e);(0,Eu.extendSubschemaData)(n,this.it,e),(0,Eu.extendSubschemaMode)(n,e);let o={...this.it,...n,items:void 0,props:void 0};return M0(o,r),o}mergeEvaluated(e,r){let{it:n,gen:o}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=It.mergeEvaluated.props(o,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=It.mergeEvaluated.items(o,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:o}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return o.if(r,()=>this.mergeEvaluated(e,C.Name)),!0}};Gt.KeywordCxt=Zs;function Dm(t,e,r,n){let o=new Zs(t,r,e);"code"in r?r.code(o,n):o.$data&&r.validate?(0,ro.funcKeywordCode)(o,r):"macro"in r?(0,ro.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,ro.funcKeywordCode)(o,r)}var Y0=/^\/(?:[^~]|~0|~1)*$/,Q0=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function qm(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let o,s;if(t==="")return M.default.rootData;if(t[0]==="/"){if(!Y0.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);o=t,s=M.default.rootData}else{let u=Q0.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(o=u[2],o==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(s=r[e-l],!o)return s}let i=s,a=o.split("/");for(let u of a)u&&(s=(0,C._)`${s}${(0,C.getProperty)((0,It.unescapeJsonPointer)(u))}`,i=(0,C._)`${i} && ${s}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}Gt.getData=qm});var Ns=z(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});var Cu=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Ou.default=Cu});var oo=z(ju=>{"use strict";Object.defineProperty(ju,"__esModule",{value:!0});var Zu=eo(),Nu=class extends Error{constructor(e,r,n,o){super(o||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Zu.resolveUrl)(e,r,n),this.missingSchema=(0,Zu.normalizeId)((0,Zu.getFullPath)(e,this.missingRef))}};ju.default=Nu});var As=z(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.resolveSchema=et.getCompilingSchema=et.resolveRef=et.compileSchema=et.SchemaEnv=void 0;var at=U(),ew=Ns(),Er=Et(),ct=eo(),Lm=Y(),tw=no(),nn=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,ct.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};et.SchemaEnv=nn;function Mu(t){let e=Um.call(this,t);if(e)return e;let r=(0,ct.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:o}=this.opts.code,{ownProperties:s}=this.opts,i=new at.CodeGen(this.scope,{es5:n,lines:o,ownProperties:s}),a;t.$async&&(a=i.scopeValue("Error",{ref:ew.default,code:(0,at._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:Er.default.data,parentData:Er.default.parentData,parentDataProperty:Er.default.parentDataProperty,dataNames:[Er.default.data],dataPathArr:[at.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,at.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:at.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,at._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,tw.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(Er.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let f=new Function(`${Er.default.self}`,`${Er.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:p,items:m}=u;f.evaluated={props:p instanceof at.Name?void 0:p,items:m instanceof at.Name?void 0:m,dynamicProps:p instanceof at.Name,dynamicItems:m instanceof at.Name},f.source&&(f.source.evaluated=(0,at.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}et.compileSchema=Mu;function rw(t,e,r){var n;r=(0,ct.resolveUrl)(this.opts.uriResolver,e,r);let o=t.refs[r];if(o)return o;let s=sw.call(this,t,r);if(s===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(s=new nn({schema:i,schemaId:a,root:t,baseId:e}))}if(s!==void 0)return t.refs[r]=nw.call(this,s)}et.resolveRef=rw;function nw(t){return(0,ct.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Mu.call(this,t)}function Um(t){for(let e of this._compilations)if(ow(e,t))return e}et.getCompilingSchema=Um;function ow(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function sw(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||js.call(this,t,e)}function js(t,e){let r=this.opts.uriResolver.parse(e),n=(0,ct._getFullPath)(this.opts.uriResolver,r),o=(0,ct.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===o)return Au.call(this,r,t);let s=(0,ct.normalizeId)(n),i=this.refs[s]||this.schemas[s];if(typeof i=="string"){let a=js.call(this,t,i);return typeof a?.schema!="object"?void 0:Au.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Mu.call(this,i),s===(0,ct.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(o=(0,ct.resolveUrl)(this.opts.uriResolver,o,u)),new nn({schema:a,schemaId:c,root:t,baseId:o})}return Au.call(this,r,i)}}et.resolveSchema=js;var iw=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Au(t,{baseId:e,schema:r,root:n}){var o;if(((o=t.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,Lm.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!iw.has(a)&&u&&(e=(0,ct.resolveUrl)(this.opts.uriResolver,e,u))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,Lm.schemaHasRulesButRef)(r,this.RULES)){let a=(0,ct.resolveUrl)(this.opts.uriResolver,e,r.$ref);s=js.call(this,n,a)}let{schemaId:i}=this.opts;if(s=s||new nn({schema:r,schemaId:i,root:n,baseId:e}),s.schema!==s.root.schema)return s}});var Vm=z((bC,aw)=>{aw.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var qu=z(($C,Km)=>{"use strict";var cw=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),Hm=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Du(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var uw=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function Fm(t){return t.length=0,!0}function lw(t,e,r){if(t.length){let n=Du(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function dw(t){let e=0,r={error:!1,address:"",zone:""},n=[],o=[],s=!1,i=!1,a=lw;for(let c=0;c<t.length;c++){let u=t[c];if(!(u==="["||u==="]"))if(u===":"){if(s===!0&&(i=!0),!a(o,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(s=!0),n.push(":");continue}else if(u==="%"){if(!a(o,n,r))break;a=Fm}else{o.push(u);continue}}return o.length&&(a===Fm?r.zone=o.join(""):i?n.push(o.join("")):n.push(Du(o))),r.address=n.join(""),r}function Bm(t){if(pw(t,":")<2)return{host:t,isIPV6:!1};let e=dw(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function pw(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function fw(t){let e=t,r=[],n=-1,o=0;for(;o=e.length;){if(o===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(o===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(o===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function mw(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function hw(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!Hm(r)){let n=Bm(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}Km.exports={nonSimpleDomain:uw,recomposeAuthority:hw,normalizeComponentEncoding:mw,removeDotSegments:fw,isIPv4:Hm,isUUID:cw,normalizeIPv6:Bm,stringArrayToHexStripped:Du}});var Ym=z((wC,Xm)=>{"use strict";var{isUUID:gw}=qu(),yw=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,_w=["http","https","ws","wss","urn","urn:uuid"];function vw(t){return _w.indexOf(t)!==-1}function Lu(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function Jm(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function Gm(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function xw(t){return t.secure=Lu(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function bw(t){if((t.port===(Lu(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function $w(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(yw);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let o=`${n}:${e.nid||t.nid}`,s=Uu(o);t.path=void 0,s&&(t=s.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function ww(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),o=`${r}:${e.nid||n}`,s=Uu(o);s&&(t=s.serialize(t,e));let i=t,a=t.nss;return i.path=`${n||e.nid}:${a}`,e.skipEscape=!0,i}function kw(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!gw(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function Sw(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var Wm={scheme:"http",domainHost:!0,parse:Jm,serialize:Gm},zw={scheme:"https",domainHost:Wm.domainHost,parse:Jm,serialize:Gm},Ms={scheme:"ws",domainHost:!0,parse:xw,serialize:bw},Tw={scheme:"wss",domainHost:Ms.domainHost,parse:Ms.parse,serialize:Ms.serialize},Pw={scheme:"urn",parse:$w,serialize:ww,skipNormalize:!0},Ew={scheme:"urn:uuid",parse:kw,serialize:Sw,skipNormalize:!0},Ds={http:Wm,https:zw,ws:Ms,wss:Tw,urn:Pw,"urn:uuid":Ew};Object.setPrototypeOf(Ds,null);function Uu(t){return t&&(Ds[t]||Ds[t.toLowerCase()])||void 0}Xm.exports={wsIsSecure:Lu,SCHEMES:Ds,isValidSchemeName:vw,getSchemeHandler:Uu}});var th=z((kC,Ls)=>{"use strict";var{normalizeIPv6:Iw,removeDotSegments:so,recomposeAuthority:Rw,normalizeComponentEncoding:qs,isIPv4:Cw,nonSimpleDomain:Ow}=qu(),{SCHEMES:Zw,getSchemeHandler:Qm}=Ym();function Nw(t,e){return typeof t=="string"?t=_t(Rt(t,e),e):typeof t=="object"&&(t=Rt(_t(t,e),e)),t}function jw(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},o=eh(Rt(t,n),Rt(e,n),n,!0);return n.skipEscape=!0,_t(o,n)}function eh(t,e,r,n){let o={};return n||(t=Rt(_t(t,r),r),e=Rt(_t(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(o.scheme=e.scheme,o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=so(e.path||""),o.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=so(e.path||""),o.query=e.query):(e.path?(e.path[0]==="/"?o.path=so(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?o.path="/"+e.path:t.path?o.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:o.path=e.path,o.path=so(o.path)),o.query=e.query):(o.path=t.path,e.query!==void 0?o.query=e.query:o.query=t.query),o.userinfo=t.userinfo,o.host=t.host,o.port=t.port),o.scheme=t.scheme),o.fragment=e.fragment,o}function Aw(t,e,r){return typeof t=="string"?(t=unescape(t),t=_t(qs(Rt(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=_t(qs(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=_t(qs(Rt(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=_t(qs(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function _t(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),o=[],s=Qm(n.scheme||r.scheme);s&&s.serialize&&s.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&o.push(r.scheme,":");let i=Rw(r);if(i!==void 0&&(n.reference!=="suffix"&&o.push("//"),o.push(i),r.path&&r.path[0]!=="/"&&o.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!s||!s.absolutePath)&&(a=so(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),o.push(a)}return r.query!==void 0&&o.push("?",r.query),r.fragment!==void 0&&o.push("#",r.fragment),o.join("")}var Mw=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Rt(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},o=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let s=t.match(Mw);if(s){if(n.scheme=s[1],n.userinfo=s[3],n.host=s[4],n.port=parseInt(s[5],10),n.path=s[6]||"",n.query=s[7],n.fragment=s[8],isNaN(n.port)&&(n.port=s[5]),n.host)if(Cw(n.host)===!1){let c=Iw(n.host);n.host=c.host.toLowerCase(),o=c.isIPV6}else o=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=Qm(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&o===!1&&Ow(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Vu={SCHEMES:Zw,normalize:Nw,resolve:jw,resolveComponent:eh,equal:Aw,serialize:_t,parse:Rt};Ls.exports=Vu;Ls.exports.default=Vu;Ls.exports.fastUri=Vu});var nh=z(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});var rh=th();rh.code='require("ajv/dist/runtime/uri").default';Fu.default=rh});var dh=z(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.CodeGen=Se.Name=Se.nil=Se.stringify=Se.str=Se._=Se.KeywordCxt=void 0;var Dw=no();Object.defineProperty(Se,"KeywordCxt",{enumerable:!0,get:function(){return Dw.KeywordCxt}});var on=U();Object.defineProperty(Se,"_",{enumerable:!0,get:function(){return on._}});Object.defineProperty(Se,"str",{enumerable:!0,get:function(){return on.str}});Object.defineProperty(Se,"stringify",{enumerable:!0,get:function(){return on.stringify}});Object.defineProperty(Se,"nil",{enumerable:!0,get:function(){return on.nil}});Object.defineProperty(Se,"Name",{enumerable:!0,get:function(){return on.Name}});Object.defineProperty(Se,"CodeGen",{enumerable:!0,get:function(){return on.CodeGen}});var qw=Ns(),ch=oo(),Lw=vu(),io=As(),Uw=U(),ao=eo(),Us=Qn(),Bu=Y(),oh=Vm(),Vw=nh(),uh=(t,e)=>new RegExp(t,e);uh.code="new RegExp";var Fw=["removeAdditional","useDefaults","coerceTypes"],Hw=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Bw={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},Kw={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},sh=200;function Jw(t){var e,r,n,o,s,i,a,c,u,l,d,h,f,p,m,g,v,x,w,k,O,me,ge,Be,mn;let Qt=t.strict,hn=(e=t.code)===null||e===void 0?void 0:e.optimize,bo=hn===!0||hn===void 0?1:hn||0,gn=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:uh,Kg=(o=t.uriResolver)!==null&&o!==void 0?o:Vw.default;return{strictSchema:(i=(s=t.strictSchema)!==null&&s!==void 0?s:Qt)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:Qt)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:Qt)!==null&&l!==void 0?l:"log",strictTuples:(h=(d=t.strictTuples)!==null&&d!==void 0?d:Qt)!==null&&h!==void 0?h:"log",strictRequired:(p=(f=t.strictRequired)!==null&&f!==void 0?f:Qt)!==null&&p!==void 0?p:!1,code:t.code?{...t.code,optimize:bo,regExp:gn}:{optimize:bo,regExp:gn},loopRequired:(m=t.loopRequired)!==null&&m!==void 0?m:sh,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:sh,meta:(v=t.meta)!==null&&v!==void 0?v:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:(w=t.inlineRefs)!==null&&w!==void 0?w:!0,schemaId:(k=t.schemaId)!==null&&k!==void 0?k:"$id",addUsedSchema:(O=t.addUsedSchema)!==null&&O!==void 0?O:!0,validateSchema:(me=t.validateSchema)!==null&&me!==void 0?me:!0,validateFormats:(ge=t.validateFormats)!==null&&ge!==void 0?ge:!0,unicodeRegExp:(Be=t.unicodeRegExp)!==null&&Be!==void 0?Be:!0,int32range:(mn=t.int32range)!==null&&mn!==void 0?mn:!0,uriResolver:Kg}}var co=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...Jw(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new Uw.ValueScope({scope:{},prefixes:Hw,es5:r,lines:n}),this.logger=ek(e.logger);let o=e.validateFormats;e.validateFormats=!1,this.RULES=(0,Lw.getRules)(),ih.call(this,Bw,e,"NOT SUPPORTED"),ih.call(this,Kw,e,"DEPRECATED","warn"),this._metaOpts=Yw.call(this),e.formats&&Ww.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&Xw.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),Gw.call(this),e.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,o=oh;n==="id"&&(o={...oh},o.id=o.$id,delete o.$id),r&&e&&this.addMetaSchema(o,o[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let o=n(r);return"$async"in n||(this.errors=n.errors),o}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return o.call(this,e,r);async function o(l,d){await s.call(this,l.$schema);let h=this._addSchema(l,d);return h.validate||i.call(this,h)}async function s(l){l&&!this.getSchema(l)&&await o.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof ch.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await s.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,o=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,o);return this}let s;if(typeof e=="object"){let{schemaId:i}=this.opts;if(s=e[i],s!==void 0&&typeof s!="string")throw new Error(`schema ${i} must be string`)}return r=(0,ao.normalizeId)(r||s),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,o,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let o=this.validate(n,e);if(!o&&r){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return o}getSchema(e){let r;for(;typeof(r=ah.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,o=new io.SchemaEnv({schema:{},schemaId:n});if(r=io.resolveSchema.call(this,o,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=ah.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,ao.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(rk.call(this,n,r),!r)return(0,Bu.eachItem)(n,s=>Hu.call(this,s)),this;ok.call(this,r);let o={...r,type:(0,Us.getJSONTypes)(r.type),schemaType:(0,Us.getJSONTypes)(r.schemaType)};return(0,Bu.eachItem)(n,o.type.length===0?s=>Hu.call(this,s,o):s=>o.type.forEach(i=>Hu.call(this,s,o,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let o=n.rules.findIndex(s=>s.keyword===e);o>=0&&n.rules.splice(o,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(o=>`${n}${o.instancePath} ${o.message}`).reduce((o,s)=>o+r+s)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let o of r){let s=o.split("/").slice(1),i=e;for(let a of s)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=lh(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let o=e[n];(!r||r.test(n))&&(typeof o=="string"?delete e[n]:o&&!o.meta&&(this._cache.delete(o.schema),delete e[n]))}}_addSchema(e,r,n,o=this.opts.validateSchema,s=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,ao.normalizeId)(i||n);let u=ao.getSchemaRefs.call(this,e,n);return c=new io.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),s&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),o&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):io.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{io.compileSchema.call(this,e)}finally{this.opts=r}}};co.ValidationError=qw.default;co.MissingRefError=ch.default;Se.default=co;function ih(t,e,r,n="error"){for(let o in t){let s=o;s in e&&this.logger[n](`${r}: option ${o}. ${t[s]}`)}}function ah(t){return t=(0,ao.normalizeId)(t),this.schemas[t]||this.refs[t]}function Gw(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function Ww(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function Xw(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function Yw(){let t={...this.opts};for(let e of Fw)delete t[e];return t}var Qw={log(){},warn(){},error(){}};function ek(t){if(t===!1)return Qw;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var tk=/^[a-z_$][a-z0-9_$:-]*$/i;function rk(t,e){let{RULES:r}=this;if((0,Bu.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!tk.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Hu(t,e,r){var n;let o=e?.post;if(r&&o)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,i=o?s.post:s.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},s.rules.push(i)),s.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Us.getJSONTypes)(e.type),schemaType:(0,Us.getJSONTypes)(e.schemaType)}};e.before?nk.call(this,i,a,e.before):i.rules.push(a),s.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function nk(t,e,r){let n=t.rules.findIndex(o=>o.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function ok(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=lh(e)),t.validateSchema=this.compile(e,!0))}var sk={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function lh(t){return{anyOf:[t,sk]}}});var ph=z(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});var ik={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Ku.default=ik});var gh=z(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.callRef=Ir.getValidate=void 0;var ak=oo(),fh=Qe(),Ue=U(),sn=Et(),mh=As(),Vs=Y(),ck={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:o,schemaEnv:s,validateName:i,opts:a,self:c}=n,{root:u}=s;if((r==="#"||r==="#/")&&o===u.baseId)return d();let l=mh.resolveRef.call(c,u,o,r);if(l===void 0)throw new ak.default(n.opts.uriResolver,o,r);if(l instanceof mh.SchemaEnv)return h(l);return f(l);function d(){if(s===u)return Fs(t,i,s,s.$async);let p=e.scopeValue("root",{ref:u});return Fs(t,(0,Ue._)`${p}.validate`,u,u.$async)}function h(p){let m=hh(t,p);Fs(t,m,p,p.$async)}function f(p){let m=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,Ue.stringify)(p)}:{ref:p}),g=e.name("valid"),v=t.subschema({schema:p,dataTypes:[],schemaPath:Ue.nil,topSchemaRef:m,errSchemaPath:r},g);t.mergeEvaluated(v),t.ok(g)}}};function hh(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,Ue._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Ir.getValidate=hh;function Fs(t,e,r,n){let{gen:o,it:s}=t,{allErrors:i,schemaEnv:a,opts:c}=s,u=c.passContext?sn.default.this:Ue.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let p=o.let("valid");o.try(()=>{o.code((0,Ue._)`await ${(0,fh.callValidateCode)(t,e,u)}`),f(e),i||o.assign(p,!0)},m=>{o.if((0,Ue._)`!(${m} instanceof ${s.ValidationError})`,()=>o.throw(m)),h(m),i||o.assign(p,!1)}),t.ok(p)}function d(){t.result((0,fh.callValidateCode)(t,e,u),()=>f(e),()=>h(e))}function h(p){let m=(0,Ue._)`${p}.errors`;o.assign(sn.default.vErrors,(0,Ue._)`${sn.default.vErrors} === null ? ${m} : ${sn.default.vErrors}.concat(${m})`),o.assign(sn.default.errors,(0,Ue._)`${sn.default.vErrors}.length`)}function f(p){var m;if(!s.opts.unevaluated)return;let g=(m=r?.validate)===null||m===void 0?void 0:m.evaluated;if(s.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(s.props=Vs.mergeEvaluated.props(o,g.props,s.props));else{let v=o.var("props",(0,Ue._)`${p}.evaluated.props`);s.props=Vs.mergeEvaluated.props(o,v,s.props,Ue.Name)}if(s.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(s.items=Vs.mergeEvaluated.items(o,g.items,s.items));else{let v=o.var("items",(0,Ue._)`${p}.evaluated.items`);s.items=Vs.mergeEvaluated.items(o,v,s.items,Ue.Name)}}}Ir.callRef=Fs;Ir.default=ck});var yh=z(Ju=>{"use strict";Object.defineProperty(Ju,"__esModule",{value:!0});var uk=ph(),lk=gh(),dk=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",uk.default,lk.default];Ju.default=dk});var _h=z(Gu=>{"use strict";Object.defineProperty(Gu,"__esModule",{value:!0});var Hs=U(),Wt=Hs.operators,Bs={maximum:{okStr:"<=",ok:Wt.LTE,fail:Wt.GT},minimum:{okStr:">=",ok:Wt.GTE,fail:Wt.LT},exclusiveMaximum:{okStr:"<",ok:Wt.LT,fail:Wt.GTE},exclusiveMinimum:{okStr:">",ok:Wt.GT,fail:Wt.LTE}},pk={message:({keyword:t,schemaCode:e})=>(0,Hs.str)`must be ${Bs[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Hs._)`{comparison: ${Bs[t].okStr}, limit: ${e}}`},fk={keyword:Object.keys(Bs),type:"number",schemaType:"number",$data:!0,error:pk,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,Hs._)`${r} ${Bs[e].fail} ${n} || isNaN(${r})`)}};Gu.default=fk});var vh=z(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});var uo=U(),mk={message:({schemaCode:t})=>(0,uo.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,uo._)`{multipleOf: ${t}}`},hk={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:mk,code(t){let{gen:e,data:r,schemaCode:n,it:o}=t,s=o.opts.multipleOfPrecision,i=e.let("res"),a=s?(0,uo._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${s}`:(0,uo._)`${i} !== parseInt(${i})`;t.fail$data((0,uo._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Wu.default=hk});var bh=z(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});function xh(t){let e=t.length,r=0,n=0,o;for(;n<e;)r++,o=t.charCodeAt(n++),o>=55296&&o<=56319&&n<e&&(o=t.charCodeAt(n),(o&64512)===56320&&n++);return r}Xu.default=xh;xh.code='require("ajv/dist/runtime/ucs2length").default'});var $h=z(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});var Rr=U(),gk=Y(),yk=bh(),_k={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Rr.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Rr._)`{limit: ${t}}`},vk={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:_k,code(t){let{keyword:e,data:r,schemaCode:n,it:o}=t,s=e==="maxLength"?Rr.operators.GT:Rr.operators.LT,i=o.opts.unicode===!1?(0,Rr._)`${r}.length`:(0,Rr._)`${(0,gk.useFunc)(t.gen,yk.default)}(${r})`;t.fail$data((0,Rr._)`${i} ${s} ${n}`)}};Yu.default=vk});var wh=z(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});var xk=Qe(),Ks=U(),bk={message:({schemaCode:t})=>(0,Ks.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,Ks._)`{pattern: ${t}}`},$k={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:bk,code(t){let{data:e,$data:r,schema:n,schemaCode:o,it:s}=t,i=s.opts.unicodeRegExp?"u":"",a=r?(0,Ks._)`(new RegExp(${o}, ${i}))`:(0,xk.usePattern)(t,n);t.fail$data((0,Ks._)`!${a}.test(${e})`)}};Qu.default=$k});var kh=z(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});var lo=U(),wk={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,lo.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,lo._)`{limit: ${t}}`},kk={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:wk,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxProperties"?lo.operators.GT:lo.operators.LT;t.fail$data((0,lo._)`Object.keys(${r}).length ${o} ${n}`)}};el.default=kk});var Sh=z(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});var po=Qe(),fo=U(),Sk=Y(),zk={message:({params:{missingProperty:t}})=>(0,fo.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,fo._)`{missingProperty: ${t}}`},Tk={keyword:"required",type:"object",schemaType:"array",$data:!0,error:zk,code(t){let{gen:e,schema:r,schemaCode:n,data:o,$data:s,it:i}=t,{opts:a}=i;if(!s&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let f=t.parentSchema.properties,{definedProperties:p}=t.it;for(let m of r)if(f?.[m]===void 0&&!p.has(m)){let g=i.schemaEnv.baseId+i.errSchemaPath,v=`required property "${m}" is not defined at "${g}" (strictRequired)`;(0,Sk.checkStrictMode)(i,v,i.opts.strictRequired)}}function u(){if(c||s)t.block$data(fo.nil,d);else for(let f of r)(0,po.checkReportMissingProp)(t,f)}function l(){let f=e.let("missing");if(c||s){let p=e.let("valid",!0);t.block$data(p,()=>h(f,p)),t.ok(p)}else e.if((0,po.checkMissingProp)(t,r,f)),(0,po.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,po.noPropertyInData)(e,o,f,a.ownProperties),()=>t.error())})}function h(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,po.propertyInData)(e,o,f,a.ownProperties)),e.if((0,fo.not)(p),()=>{t.error(),e.break()})},fo.nil)}}};tl.default=Tk});var zh=z(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});var mo=U(),Pk={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,mo.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,mo._)`{limit: ${t}}`},Ek={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Pk,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxItems"?mo.operators.GT:mo.operators.LT;t.fail$data((0,mo._)`${r}.length ${o} ${n}`)}};rl.default=Ek});var Js=z(nl=>{"use strict";Object.defineProperty(nl,"__esModule",{value:!0});var Th=Tu();Th.code='require("ajv/dist/runtime/equal").default';nl.default=Th});var Ph=z(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});var ol=Qn(),ze=U(),Ik=Y(),Rk=Js(),Ck={message:({params:{i:t,j:e}})=>(0,ze.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,ze._)`{i: ${t}, j: ${e}}`},Ok={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Ck,code(t){let{gen:e,data:r,$data:n,schema:o,parentSchema:s,schemaCode:i,it:a}=t;if(!n&&!o)return;let c=e.let("valid"),u=s.items?(0,ol.getSchemaTypes)(s.items):[];t.block$data(c,l,(0,ze._)`${i} === false`),t.ok(c);function l(){let p=e.let("i",(0,ze._)`${r}.length`),m=e.let("j");t.setParams({i:p,j:m}),e.assign(c,!0),e.if((0,ze._)`${p} > 1`,()=>(d()?h:f)(p,m))}function d(){return u.length>0&&!u.some(p=>p==="object"||p==="array")}function h(p,m){let g=e.name("item"),v=(0,ol.checkDataTypes)(u,g,a.opts.strictNumbers,ol.DataType.Wrong),x=e.const("indices",(0,ze._)`{}`);e.for((0,ze._)`;${p}--;`,()=>{e.let(g,(0,ze._)`${r}[${p}]`),e.if(v,(0,ze._)`continue`),u.length>1&&e.if((0,ze._)`typeof ${g} == "string"`,(0,ze._)`${g} += "_"`),e.if((0,ze._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(m,(0,ze._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,ze._)`${x}[${g}] = ${p}`)})}function f(p,m){let g=(0,Ik.useFunc)(e,Rk.default),v=e.name("outer");e.label(v).for((0,ze._)`;${p}--;`,()=>e.for((0,ze._)`${m} = ${p}; ${m}--;`,()=>e.if((0,ze._)`${g}(${r}[${p}], ${r}[${m}])`,()=>{t.error(),e.assign(c,!1).break(v)})))}}};sl.default=Ok});var Eh=z(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});var il=U(),Zk=Y(),Nk=Js(),jk={message:"must be equal to constant",params:({schemaCode:t})=>(0,il._)`{allowedValue: ${t}}`},Ak={keyword:"const",$data:!0,error:jk,code(t){let{gen:e,data:r,$data:n,schemaCode:o,schema:s}=t;n||s&&typeof s=="object"?t.fail$data((0,il._)`!${(0,Zk.useFunc)(e,Nk.default)}(${r}, ${o})`):t.fail((0,il._)`${s} !== ${r}`)}};al.default=Ak});var Ih=z(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});var ho=U(),Mk=Y(),Dk=Js(),qk={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,ho._)`{allowedValues: ${t}}`},Lk={keyword:"enum",schemaType:"array",$data:!0,error:qk,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:s,it:i}=t;if(!n&&o.length===0)throw new Error("enum must have non-empty array");let a=o.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,Mk.useFunc)(e,Dk.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(o))throw new Error("ajv implementation error");let f=e.const("vSchema",s);l=(0,ho.or)(...o.map((p,m)=>h(f,m)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",s,f=>e.if((0,ho._)`${u()}(${r}, ${f})`,()=>e.assign(l,!0).break()))}function h(f,p){let m=o[p];return typeof m=="object"&&m!==null?(0,ho._)`${u()}(${r}, ${f}[${p}])`:(0,ho._)`${r} === ${m}`}}};cl.default=Lk});var Rh=z(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});var Uk=_h(),Vk=vh(),Fk=$h(),Hk=wh(),Bk=kh(),Kk=Sh(),Jk=zh(),Gk=Ph(),Wk=Eh(),Xk=Ih(),Yk=[Uk.default,Vk.default,Fk.default,Hk.default,Bk.default,Kk.default,Jk.default,Gk.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Wk.default,Xk.default];ul.default=Yk});var dl=z(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.validateAdditionalItems=void 0;var Cr=U(),ll=Y(),Qk={message:({params:{len:t}})=>(0,Cr.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Cr._)`{limit: ${t}}`},eS={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Qk,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,ll.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Ch(t,n)}};function Ch(t,e){let{gen:r,schema:n,data:o,keyword:s,it:i}=t;i.items=!0;let a=r.const("len",(0,Cr._)`${o}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Cr._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,ll.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,Cr._)`${a} <= ${e.length}`);r.if((0,Cr.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:s,dataProp:l,dataPropType:ll.Type.Num},u),i.allErrors||r.if((0,Cr.not)(u),()=>r.break())})}}go.validateAdditionalItems=Ch;go.default=eS});var pl=z(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.validateTuple=void 0;var Oh=U(),Gs=Y(),tS=Qe(),rS={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return Zh(t,"additionalItems",e);r.items=!0,!(0,Gs.alwaysValidSchema)(r,e)&&t.ok((0,tS.validateArray)(t))}};function Zh(t,e,r=t.schema){let{gen:n,parentSchema:o,data:s,keyword:i,it:a}=t;l(o),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Gs.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,Oh._)`${s}.length`);r.forEach((d,h)=>{(0,Gs.alwaysValidSchema)(a,d)||(n.if((0,Oh._)`${u} > ${h}`,()=>t.subschema({keyword:i,schemaProp:h,dataProp:h},c)),t.ok(c))});function l(d){let{opts:h,errSchemaPath:f}=a,p=r.length,m=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(h.strictTuples&&!m){let g=`"${i}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,Gs.checkStrictMode)(a,g,h.strictTuples)}}}yo.validateTuple=Zh;yo.default=rS});var Nh=z(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0});var nS=pl(),oS={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,nS.validateTuple)(t,"items")};fl.default=oS});var Ah=z(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0});var jh=U(),sS=Y(),iS=Qe(),aS=dl(),cS={message:({params:{len:t}})=>(0,jh.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,jh._)`{limit: ${t}}`},uS={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:cS,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:o}=r;n.items=!0,!(0,sS.alwaysValidSchema)(n,e)&&(o?(0,aS.validateAdditionalItems)(t,o):t.ok((0,iS.validateArray)(t)))}};ml.default=uS});var Mh=z(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});var tt=U(),Ws=Y(),lS={message:({params:{min:t,max:e}})=>e===void 0?(0,tt.str)`must contain at least ${t} valid item(s)`:(0,tt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,tt._)`{minContains: ${t}}`:(0,tt._)`{minContains: ${t}, maxContains: ${e}}`},dS={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:lS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t,i,a,{minContains:c,maxContains:u}=n;s.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,tt._)`${o}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,Ws.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,Ws.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,Ws.alwaysValidSchema)(s,r)){let m=(0,tt._)`${l} >= ${i}`;a!==void 0&&(m=(0,tt._)`${m} && ${l} <= ${a}`),t.pass(m);return}s.items=!0;let d=e.name("valid");a===void 0&&i===1?f(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,tt._)`${o}.length > 0`,h)):(e.let(d,!1),h()),t.result(d,()=>t.reset());function h(){let m=e.name("_valid"),g=e.let("count",0);f(m,()=>e.if(m,()=>p(g)))}function f(m,g){e.forRange("i",0,l,v=>{t.subschema({keyword:"contains",dataProp:v,dataPropType:Ws.Type.Num,compositeRule:!0},m),g()})}function p(m){e.code((0,tt._)`${m}++`),a===void 0?e.if((0,tt._)`${m} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,tt._)`${m} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,tt._)`${m} >= ${i}`,()=>e.assign(d,!0)))}}};hl.default=dS});var Lh=z(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.validateSchemaDeps=vt.validatePropertyDeps=vt.error=void 0;var gl=U(),pS=Y(),_o=Qe();vt.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,gl.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,gl._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var fS={keyword:"dependencies",type:"object",schemaType:"object",error:vt.error,code(t){let[e,r]=mS(t);Dh(t,e),qh(t,r)}};function mS({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let o=Array.isArray(t[n])?e:r;o[n]=t[n]}return[e,r]}function Dh(t,e=t.schema){let{gen:r,data:n,it:o}=t;if(Object.keys(e).length===0)return;let s=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,_o.propertyInData)(r,n,i,o.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),o.allErrors?r.if(c,()=>{for(let u of a)(0,_o.checkReportMissingProp)(t,u)}):(r.if((0,gl._)`${c} && (${(0,_o.checkMissingProp)(t,a,s)})`),(0,_o.reportMissingProp)(t,s),r.else())}}vt.validatePropertyDeps=Dh;function qh(t,e=t.schema){let{gen:r,data:n,keyword:o,it:s}=t,i=r.name("valid");for(let a in e)(0,pS.alwaysValidSchema)(s,e[a])||(r.if((0,_o.propertyInData)(r,n,a,s.opts.ownProperties),()=>{let c=t.subschema({keyword:o,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}vt.validateSchemaDeps=qh;vt.default=fS});var Vh=z(yl=>{"use strict";Object.defineProperty(yl,"__esModule",{value:!0});var Uh=U(),hS=Y(),gS={message:"property name must be valid",params:({params:t})=>(0,Uh._)`{propertyName: ${t.propertyName}}`},yS={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:gS,code(t){let{gen:e,schema:r,data:n,it:o}=t;if((0,hS.alwaysValidSchema)(o,r))return;let s=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},s),e.if((0,Uh.not)(s),()=>{t.error(!0),o.allErrors||e.break()})}),t.ok(s)}};yl.default=yS});var vl=z(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});var Xs=Qe(),ut=U(),_S=Et(),Ys=Y(),vS={message:"must NOT have additional properties",params:({params:t})=>(0,ut._)`{additionalProperty: ${t.additionalProperty}}`},xS={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:vS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,errsCount:s,it:i}=t;if(!s)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,Ys.alwaysValidSchema)(i,r))return;let u=(0,Xs.allSchemaProperties)(n.properties),l=(0,Xs.allSchemaProperties)(n.patternProperties);d(),t.ok((0,ut._)`${s} === ${_S.default.errors}`);function d(){e.forIn("key",o,g=>{!u.length&&!l.length?p(g):e.if(h(g),()=>p(g))})}function h(g){let v;if(u.length>8){let x=(0,Ys.schemaRefOrVal)(i,n.properties,"properties");v=(0,Xs.isOwnProperty)(e,x,g)}else u.length?v=(0,ut.or)(...u.map(x=>(0,ut._)`${g} === ${x}`)):v=ut.nil;return l.length&&(v=(0,ut.or)(v,...l.map(x=>(0,ut._)`${(0,Xs.usePattern)(t,x)}.test(${g})`))),(0,ut.not)(v)}function f(g){e.code((0,ut._)`delete ${o}[${g}]`)}function p(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Ys.alwaysValidSchema)(i,r)){let v=e.name("valid");c.removeAdditional==="failing"?(m(g,v,!1),e.if((0,ut.not)(v),()=>{t.reset(),f(g)})):(m(g,v),a||e.if((0,ut.not)(v),()=>e.break()))}}function m(g,v,x){let w={keyword:"additionalProperties",dataProp:g,dataPropType:Ys.Type.Str};x===!1&&Object.assign(w,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(w,v)}}};_l.default=xS});var Bh=z(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});var bS=no(),Fh=Qe(),xl=Y(),Hh=vl(),$S={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Hh.default.code(new bS.KeywordCxt(s,Hh.default,"additionalProperties"));let i=(0,Fh.allSchemaProperties)(r);for(let d of i)s.definedProperties.add(d);s.opts.unevaluated&&i.length&&s.props!==!0&&(s.props=xl.mergeEvaluated.props(e,(0,xl.toHash)(i),s.props));let a=i.filter(d=>!(0,xl.alwaysValidSchema)(s,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,Fh.propertyInData)(e,o,d,s.opts.ownProperties)),l(d),s.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return s.opts.useDefaults&&!s.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};bl.default=$S});var Wh=z($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});var Kh=Qe(),Qs=U(),Jh=Y(),Gh=Y(),wS={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:o,it:s}=t,{opts:i}=s,a=(0,Kh.allSchemaProperties)(r),c=a.filter(m=>(0,Jh.alwaysValidSchema)(s,r[m]));if(a.length===0||c.length===a.length&&(!s.opts.unevaluated||s.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&o.properties,l=e.name("valid");s.props!==!0&&!(s.props instanceof Qs.Name)&&(s.props=(0,Gh.evaluatedPropsToName)(e,s.props));let{props:d}=s;h();function h(){for(let m of a)u&&f(m),s.allErrors?p(m):(e.var(l,!0),p(m),e.if(l))}function f(m){for(let g in u)new RegExp(m).test(g)&&(0,Jh.checkStrictMode)(s,`property ${g} matches pattern ${m} (use allowMatchingProperties)`)}function p(m){e.forIn("key",n,g=>{e.if((0,Qs._)`${(0,Kh.usePattern)(t,m)}.test(${g})`,()=>{let v=c.includes(m);v||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:g,dataPropType:Gh.Type.Str},l),s.opts.unevaluated&&d!==!0?e.assign((0,Qs._)`${d}[${g}]`,!0):!v&&!s.allErrors&&e.if((0,Qs.not)(l),()=>e.break())})})}}};$l.default=wS});var Xh=z(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});var kS=Y(),SS={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,kS.alwaysValidSchema)(n,r)){t.fail();return}let o=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),t.failResult(o,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};wl.default=SS});var Yh=z(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});var zS=Qe(),TS={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:zS.validateUnion,error:{message:"must match a schema in anyOf"}};kl.default=TS});var Qh=z(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});var ei=U(),PS=Y(),ES={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,ei._)`{passingSchemas: ${t.passing}}`},IS={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:ES,code(t){let{gen:e,schema:r,parentSchema:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(o.opts.discriminator&&n.discriminator)return;let s=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){s.forEach((l,d)=>{let h;(0,PS.alwaysValidSchema)(o,l)?e.var(c,!0):h=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,ei._)`${c} && ${i}`).assign(i,!1).assign(a,(0,ei._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),h&&t.mergeEvaluated(h,ei.Name)})})}}};Sl.default=IS});var eg=z(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});var RS=Y(),CS={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let o=e.name("valid");r.forEach((s,i)=>{if((0,RS.alwaysValidSchema)(n,s))return;let a=t.subschema({keyword:"allOf",schemaProp:i},o);t.ok(o),t.mergeEvaluated(a)})}};zl.default=CS});var ng=z(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});var ti=U(),rg=Y(),OS={message:({params:t})=>(0,ti.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,ti._)`{failingKeyword: ${t.ifClause}}`},ZS={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:OS,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,rg.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let o=tg(n,"then"),s=tg(n,"else");if(!o&&!s)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),o&&s){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else o?e.if(a,u("then")):e.if((0,ti.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let h=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(h,i),d?e.assign(d,(0,ti._)`${l}`):t.setParams({ifClause:l})}}}};function tg(t,e){let r=t.schema[e];return r!==void 0&&!(0,rg.alwaysValidSchema)(t,r)}Tl.default=ZS});var og=z(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});var NS=Y(),jS={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,NS.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};Pl.default=jS});var sg=z(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});var AS=dl(),MS=Nh(),DS=pl(),qS=Ah(),LS=Mh(),US=Lh(),VS=Vh(),FS=vl(),HS=Bh(),BS=Wh(),KS=Xh(),JS=Yh(),GS=Qh(),WS=eg(),XS=ng(),YS=og();function QS(t=!1){let e=[KS.default,JS.default,GS.default,WS.default,XS.default,YS.default,VS.default,FS.default,US.default,HS.default,BS.default];return t?e.push(MS.default,qS.default):e.push(AS.default,DS.default),e.push(LS.default),e}El.default=QS});var ig=z(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});var he=U(),ez={message:({schemaCode:t})=>(0,he.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,he._)`{format: ${t}}`},tz={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:ez,code(t,e){let{gen:r,data:n,$data:o,schema:s,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;o?h():f();function h(){let p=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),m=r.const("fDef",(0,he._)`${p}[${i}]`),g=r.let("fType"),v=r.let("format");r.if((0,he._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>r.assign(g,(0,he._)`${m}.type || "string"`).assign(v,(0,he._)`${m}.validate`),()=>r.assign(g,(0,he._)`"string"`).assign(v,m)),t.fail$data((0,he.or)(x(),w()));function x(){return c.strictSchema===!1?he.nil:(0,he._)`${i} && !${v}`}function w(){let k=l.$async?(0,he._)`(${m}.async ? await ${v}(${n}) : ${v}(${n}))`:(0,he._)`${v}(${n})`,O=(0,he._)`(typeof ${v} == "function" ? ${k} : ${v}.test(${n}))`;return(0,he._)`${v} && ${v} !== true && ${g} === ${e} && !${O}`}}function f(){let p=d.formats[s];if(!p){x();return}if(p===!0)return;let[m,g,v]=w(p);m===e&&t.pass(k());function x(){if(c.strictSchema===!1){d.logger.warn(O());return}throw new Error(O());function O(){return`unknown format "${s}" ignored in schema at path "${u}"`}}function w(O){let me=O instanceof RegExp?(0,he.regexpCode)(O):c.code.formats?(0,he._)`${c.code.formats}${(0,he.getProperty)(s)}`:void 0,ge=r.scopeValue("formats",{key:s,ref:O,code:me});return typeof O=="object"&&!(O instanceof RegExp)?[O.type||"string",O.validate,(0,he._)`${ge}.validate`]:["string",O,ge]}function k(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!l.$async)throw new Error("async format in sync schema");return(0,he._)`await ${v}(${n})`}return typeof g=="function"?(0,he._)`${v}(${n})`:(0,he._)`${v}.test(${n})`}}}};Il.default=tz});var ag=z(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});var rz=ig(),nz=[rz.default];Rl.default=nz});var cg=z(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.contentVocabulary=an.metadataVocabulary=void 0;an.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];an.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var lg=z(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});var oz=yh(),sz=Rh(),iz=sg(),az=ag(),ug=cg(),cz=[oz.default,sz.default,(0,iz.default)(),az.default,ug.metadataVocabulary,ug.contentVocabulary];Cl.default=cz});var pg=z(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.DiscrError=void 0;var dg;(function(t){t.Tag="tag",t.Mapping="mapping"})(dg||(ri.DiscrError=dg={}))});var mg=z(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});var cn=U(),Ol=pg(),fg=As(),uz=oo(),lz=Y(),dz={message:({params:{discrError:t,tagName:e}})=>t===Ol.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,cn._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},pz={keyword:"discriminator",type:"object",schemaType:"object",error:dz,code(t){let{gen:e,data:r,schema:n,parentSchema:o,it:s}=t,{oneOf:i}=o;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,cn._)`${r}${(0,cn.getProperty)(a)}`);e.if((0,cn._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:Ol.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let f=h();e.if(!1);for(let p in f)e.elseIf((0,cn._)`${u} === ${p}`),e.assign(c,d(f[p]));e.else(),t.error(!1,{discrError:Ol.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(f){let p=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(m,cn.Name),p}function h(){var f;let p={},m=v(o),g=!0;for(let k=0;k<i.length;k++){let O=i[k];if(O?.$ref&&!(0,lz.schemaHasRulesButRef)(O,s.self.RULES)){let ge=O.$ref;if(O=fg.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,ge),O instanceof fg.SchemaEnv&&(O=O.schema),O===void 0)throw new uz.default(s.opts.uriResolver,s.baseId,ge)}let me=(f=O?.properties)===null||f===void 0?void 0:f[a];if(typeof me!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(m||v(O)),x(me,k)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return p;function v({required:k}){return Array.isArray(k)&&k.includes(a)}function x(k,O){if(k.const)w(k.const,O);else if(k.enum)for(let me of k.enum)w(me,O);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function w(k,O){if(typeof k!="string"||k in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[k]=O}}}};Zl.default=pz});var hg=z((pO,fz)=>{fz.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var jl=z((ae,Nl)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.MissingRefError=ae.ValidationError=ae.CodeGen=ae.Name=ae.nil=ae.stringify=ae.str=ae._=ae.KeywordCxt=ae.Ajv=void 0;var mz=dh(),hz=lg(),gz=mg(),gg=hg(),yz=["/properties"],ni="http://json-schema.org/draft-07/schema",un=class extends mz.default{_addVocabularies(){super._addVocabularies(),hz.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(gz.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(gg,yz):gg;this.addMetaSchema(e,ni,!1),this.refs["http://json-schema.org/schema"]=ni}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(ni)?ni:void 0)}};ae.Ajv=un;Nl.exports=ae=un;Nl.exports.Ajv=un;Object.defineProperty(ae,"__esModule",{value:!0});ae.default=un;var _z=no();Object.defineProperty(ae,"KeywordCxt",{enumerable:!0,get:function(){return _z.KeywordCxt}});var ln=U();Object.defineProperty(ae,"_",{enumerable:!0,get:function(){return ln._}});Object.defineProperty(ae,"str",{enumerable:!0,get:function(){return ln.str}});Object.defineProperty(ae,"stringify",{enumerable:!0,get:function(){return ln.stringify}});Object.defineProperty(ae,"nil",{enumerable:!0,get:function(){return ln.nil}});Object.defineProperty(ae,"Name",{enumerable:!0,get:function(){return ln.Name}});Object.defineProperty(ae,"CodeGen",{enumerable:!0,get:function(){return ln.CodeGen}});var vz=Ns();Object.defineProperty(ae,"ValidationError",{enumerable:!0,get:function(){return vz.default}});var xz=oo();Object.defineProperty(ae,"MissingRefError",{enumerable:!0,get:function(){return xz.default}})});var kg=z(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.formatNames=bt.fastFormats=bt.fullFormats=void 0;function xt(t,e){return{validate:t,compare:e}}bt.fullFormats={date:xt(xg,ql),time:xt(Ml(!0),Ll),"date-time":xt(yg(!0),$g),"iso-time":xt(Ml(),bg),"iso-date-time":xt(yg(),wg),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:zz,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:Oz,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Tz,int32:{type:"number",validate:Iz},int64:{type:"number",validate:Rz},float:{type:"number",validate:vg},double:{type:"number",validate:vg},password:!0,binary:!0};bt.fastFormats={...bt.fullFormats,date:xt(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,ql),time:xt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Ll),"date-time":xt(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,$g),"iso-time":xt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,bg),"iso-date-time":xt(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,wg),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};bt.formatNames=Object.keys(bt.fullFormats);function bz(t){return t%4===0&&(t%100!==0||t%400===0)}var $z=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,wz=[0,31,28,31,30,31,30,31,31,30,31,30,31];function xg(t){let e=$z.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],o=+e[3];return n>=1&&n<=12&&o>=1&&o<=(n===2&&bz(r)?29:wz[n])}function ql(t,e){if(t&&e)return t>e?1:t<e?-1:0}var Al=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Ml(t){return function(r){let n=Al.exec(r);if(!n)return!1;let o=+n[1],s=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),l=+(n[7]||0);if(u>23||l>59||t&&!a)return!1;if(o<=23&&s<=59&&i<60)return!0;let d=s-l*c,h=o-u*c-(d<0?1:0);return(h===23||h===-1)&&(d===59||d===-1)&&i<61}}function Ll(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function bg(t,e){if(!(t&&e))return;let r=Al.exec(t),n=Al.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var Dl=/t|\s/i;function yg(t){let e=Ml(t);return function(n){let o=n.split(Dl);return o.length===2&&xg(o[0])&&e(o[1])}}function $g(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function wg(t,e){if(!(t&&e))return;let[r,n]=t.split(Dl),[o,s]=e.split(Dl),i=ql(r,o);if(i!==void 0)return i||Ll(n,s)}var kz=/\/|:/,Sz=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function zz(t){return kz.test(t)&&Sz.test(t)}var _g=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Tz(t){return _g.lastIndex=0,_g.test(t)}var Pz=-(2**31),Ez=2**31-1;function Iz(t){return Number.isInteger(t)&&t<=Ez&&t>=Pz}function Rz(t){return Number.isInteger(t)}function vg(){return!0}var Cz=/[^\\]\\Z/;function Oz(t){if(Cz.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Sg=z(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.formatLimitDefinition=void 0;var Zz=jl(),lt=U(),Xt=lt.operators,oi={formatMaximum:{okStr:"<=",ok:Xt.LTE,fail:Xt.GT},formatMinimum:{okStr:">=",ok:Xt.GTE,fail:Xt.LT},formatExclusiveMaximum:{okStr:"<",ok:Xt.LT,fail:Xt.GTE},formatExclusiveMinimum:{okStr:">",ok:Xt.GT,fail:Xt.LTE}},Nz={message:({keyword:t,schemaCode:e})=>(0,lt.str)`should be ${oi[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,lt._)`{comparison: ${oi[t].okStr}, limit: ${e}}`};dn.formatLimitDefinition={keyword:Object.keys(oi),type:"string",schemaType:"string",$data:!0,error:Nz,code(t){let{gen:e,data:r,schemaCode:n,keyword:o,it:s}=t,{opts:i,self:a}=s;if(!i.validateFormats)return;let c=new Zz.KeywordCxt(s,a.RULES.all.format.definition,"format");c.$data?u():l();function u(){let h=e.scopeValue("formats",{ref:a.formats,code:i.code.formats}),f=e.const("fmt",(0,lt._)`${h}[${c.schemaCode}]`);t.fail$data((0,lt.or)((0,lt._)`typeof ${f} != "object"`,(0,lt._)`${f} instanceof RegExp`,(0,lt._)`typeof ${f}.compare != "function"`,d(f)))}function l(){let h=c.schema,f=a.formats[h];if(!f||f===!0)return;if(typeof f!="object"||f instanceof RegExp||typeof f.compare!="function")throw new Error(`"${o}": format "${h}" does not define "compare" function`);let p=e.scopeValue("formats",{key:h,ref:f,code:i.code.formats?(0,lt._)`${i.code.formats}${(0,lt.getProperty)(h)}`:void 0});t.fail$data(d(p))}function d(h){return(0,lt._)`${h}.compare(${r}, ${n}) ${oi[o].fail} 0`}},dependencies:["format"]};var jz=t=>(t.addKeyword(dn.formatLimitDefinition),t);dn.default=jz});var Eg=z((vo,Pg)=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});var pn=kg(),Az=Sg(),Ul=U(),zg=new Ul.Name("fullFormats"),Mz=new Ul.Name("fastFormats"),Vl=(t,e={keywords:!0})=>{if(Array.isArray(e))return Tg(t,e,pn.fullFormats,zg),t;let[r,n]=e.mode==="fast"?[pn.fastFormats,Mz]:[pn.fullFormats,zg],o=e.formats||pn.formatNames;return Tg(t,o,r,n),e.keywords&&(0,Az.default)(t),t};Vl.get=(t,e="full")=>{let n=(e==="fast"?pn.fastFormats:pn.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function Tg(t,e,r,n){var o,s;(o=(s=t.opts.code).formats)!==null&&o!==void 0||(s.formats=(0,Ul._)`require("ajv-formats/dist/formats").${n}`);for(let i of e)t.addFormat(i,r[i])}Pg.exports=vo=Vl;Object.defineProperty(vo,"__esModule",{value:!0});vo.default=Vl});var ye={};mi(ye,{BRAND:()=>Sy,DIRTY:()=>er,EMPTY_PATH:()=>ny,INVALID:()=>N,NEVER:()=>c_,OK:()=>Te,ParseStatus:()=>xe,Schema:()=>L,ZodAny:()=>jt,ZodArray:()=>St,ZodBigInt:()=>rr,ZodBoolean:()=>nr,ZodBranded:()=>_n,ZodCatch:()=>mr,ZodDate:()=>or,ZodDefault:()=>fr,ZodDiscriminatedUnion:()=>ko,ZodEffects:()=>Je,ZodEnum:()=>dr,ZodError:()=>Ne,ZodFirstPartyTypeKind:()=>$,ZodFunction:()=>zo,ZodIntersection:()=>cr,ZodIssueCode:()=>b,ZodLazy:()=>ur,ZodLiteral:()=>lr,ZodMap:()=>Dr,ZodNaN:()=>Lr,ZodNativeEnum:()=>pr,ZodNever:()=>rt,ZodNull:()=>ir,ZodNullable:()=>mt,ZodNumber:()=>tr,ZodObject:()=>Ae,ZodOptional:()=>je,ZodParsedType:()=>T,ZodPipeline:()=>vn,ZodPromise:()=>At,ZodReadonly:()=>hr,ZodRecord:()=>So,ZodSchema:()=>L,ZodSet:()=>qr,ZodString:()=>Nt,ZodSymbol:()=>Ar,ZodTransformer:()=>Je,ZodTuple:()=>ft,ZodType:()=>L,ZodUndefined:()=>sr,ZodUnion:()=>ar,ZodUnknown:()=>kt,ZodVoid:()=>Mr,addIssueToContext:()=>S,any:()=>Zy,array:()=>My,bigint:()=>Ey,boolean:()=>id,coerce:()=>a_,custom:()=>nd,date:()=>Iy,datetimeRegex:()=>td,defaultErrorMap:()=>$t,discriminatedUnion:()=>Ly,effect:()=>Qy,enum:()=>Wy,function:()=>Ky,getErrorMap:()=>Zr,getParsedType:()=>pt,instanceof:()=>Ty,intersection:()=>Uy,isAborted:()=>$o,isAsync:()=>Nr,isDirty:()=>wo,isValid:()=>Zt,late:()=>zy,lazy:()=>Jy,literal:()=>Gy,makeIssue:()=>yn,map:()=>Hy,nan:()=>Py,nativeEnum:()=>Xy,never:()=>jy,null:()=>Oy,nullable:()=>t_,number:()=>sd,object:()=>vi,objectUtil:()=>gi,oboolean:()=>i_,onumber:()=>s_,optional:()=>e_,ostring:()=>o_,pipeline:()=>n_,preprocess:()=>r_,promise:()=>Yy,quotelessJson:()=>ey,record:()=>Fy,set:()=>By,setErrorMap:()=>ry,strictObject:()=>Dy,string:()=>od,symbol:()=>Ry,transformer:()=>Qy,tuple:()=>Vy,undefined:()=>Cy,union:()=>qy,unknown:()=>Ny,util:()=>H,void:()=>Ay});var H;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function r(o){throw new Error}t.assertNever=r,t.arrayToEnum=o=>{let s={};for(let i of o)s[i]=i;return s},t.getValidEnumValues=o=>{let s=t.objectKeys(o).filter(a=>typeof o[o[a]]!="number"),i={};for(let a of s)i[a]=o[a];return t.objectValues(i)},t.objectValues=o=>t.objectKeys(o).map(function(s){return o[s]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let s=[];for(let i in o)Object.prototype.hasOwnProperty.call(o,i)&&s.push(i);return s},t.find=(o,s)=>{for(let i of o)if(s(i))return i},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}t.joinValues=n,t.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s})(H||(H={}));var gi;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(gi||(gi={}));var T=H.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),pt=t=>{switch(typeof t){case"undefined":return T.undefined;case"string":return T.string;case"number":return Number.isNaN(t)?T.nan:T.number;case"boolean":return T.boolean;case"function":return T.function;case"bigint":return T.bigint;case"symbol":return T.symbol;case"object":return Array.isArray(t)?T.array:t===null?T.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?T.promise:typeof Map<"u"&&t instanceof Map?T.map:typeof Set<"u"&&t instanceof Set?T.set:typeof Date<"u"&&t instanceof Date?T.date:T.object;default:return T.unknown}};var b=H.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),ey=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Ne=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(o);else if(i.code==="invalid_return_type")o(i.returnTypeError);else if(i.code==="invalid_arguments")o(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,H.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let o of this.issues)if(o.path.length>0){let s=o.path[0];r[s]=r[s]||[],r[s].push(e(o))}else n.push(e(o));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ne.create=t=>new Ne(t);var ty=(t,e)=>{let r;switch(t.code){case b.invalid_type:t.received===T.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case b.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,H.jsonStringifyReplacer)}`;break;case b.unrecognized_keys:r=`Unrecognized key(s) in object: ${H.joinValues(t.keys,", ")}`;break;case b.invalid_union:r="Invalid input";break;case b.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${H.joinValues(t.options)}`;break;case b.invalid_enum_value:r=`Invalid enum value. Expected ${H.joinValues(t.options)}, received '${t.received}'`;break;case b.invalid_arguments:r="Invalid function arguments";break;case b.invalid_return_type:r="Invalid function return type";break;case b.invalid_date:r="Invalid date";break;case b.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:H.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case b.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case b.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case b.custom:r="Invalid input";break;case b.invalid_intersection_types:r="Intersection results could not be merged";break;case b.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case b.not_finite:r="Number must be finite";break;default:r=e.defaultError,H.assertNever(t)}return{message:r}},$t=ty;var Wl=$t;function ry(t){Wl=t}function Zr(){return Wl}var yn=t=>{let{data:e,path:r,errorMaps:n,issueData:o}=t,s=[...r,...o.path||[]],i={...o,path:s};if(o.message!==void 0)return{...o,path:s,message:o.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:e,defaultError:a}).message;return{...o,path:s,message:a}},ny=[];function S(t,e){let r=Zr(),n=yn({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===$t?void 0:$t].filter(o=>!!o)});t.common.issues.push(n)}var xe=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let o of r){if(o.status==="aborted")return N;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let o of r){let s=await o.key,i=await o.value;n.push({key:s,value:i})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let o of r){let{key:s,value:i}=o;if(s.status==="aborted"||i.status==="aborted")return N;s.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||o.alwaysSet)&&(n[s.value]=i.value)}return{status:e.value,value:n}}},N=Object.freeze({status:"aborted"}),er=t=>({status:"dirty",value:t}),Te=t=>({status:"valid",value:t}),$o=t=>t.status==="aborted",wo=t=>t.status==="dirty",Zt=t=>t.status==="valid",Nr=t=>typeof Promise<"u"&&t instanceof Promise;var E;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(E||(E={}));var Ke=class{constructor(e,r,n,o){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Xl=(t,e)=>{if(Zt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Ne(t.common.issues);return this._error=r,this._error}}};function D(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:o}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(i,a)=>{let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:o}}var L=class{get description(){return this._def.description}_getType(e){return pt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:pt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new xe,ctx:{common:e.parent.common,data:e.data,parsedType:pt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Nr(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:pt(e)},o=this._parseSync({data:e,path:n.path,parent:n});return Xl(n,o)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:pt(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Zt(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Zt(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:pt(e)},o=this._parse({data:e,path:n.path,parent:n}),s=await(Nr(o)?o:Promise.resolve(o));return Xl(n,s)}refine(e,r){let n=o=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,s)=>{let i=e(o),a=()=>s.addIssue({code:b.custom,...n(o)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof r=="function"?r(n,o):r),!1))}_refinement(e){return new Je({schema:this,typeName:$.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return je.create(this,this._def)}nullable(){return mt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return St.create(this)}promise(){return At.create(this,this._def)}or(e){return ar.create([this,e],this._def)}and(e){return cr.create(this,e,this._def)}transform(e){return new Je({...D(this._def),schema:this,typeName:$.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new fr({...D(this._def),innerType:this,defaultValue:r,typeName:$.ZodDefault})}brand(){return new _n({typeName:$.ZodBranded,type:this,...D(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new mr({...D(this._def),innerType:this,catchValue:r,typeName:$.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return vn.create(this,e)}readonly(){return hr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},oy=/^c[^\s-]{8,}$/i,sy=/^[0-9a-z]+$/,iy=/^[0-9A-HJKMNP-TV-Z]{26}$/i,ay=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,cy=/^[a-z0-9_-]{21}$/i,uy=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ly=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,dy=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,py="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",yi,fy=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,my=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,hy=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,gy=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,yy=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,_y=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ql="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",vy=new RegExp(`^${Ql}$`);function ed(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function xy(t){return new RegExp(`^${ed(t)}$`)}function td(t){let e=`${Ql}T${ed(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function by(t,e){return!!((e==="v4"||!e)&&fy.test(t)||(e==="v6"||!e)&&hy.test(t))}function $y(t,e){if(!uy.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function wy(t,e){return!!((e==="v4"||!e)&&my.test(t)||(e==="v6"||!e)&&gy.test(t))}var Nt=class t extends L{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==T.string){let s=this._getOrReturnCtx(e);return S(s,{code:b.invalid_type,expected:T.string,received:s.parsedType}),N}let n=new xe,o;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(o=this._getOrReturnCtx(e,o),S(o,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(o=this._getOrReturnCtx(e,o),S(o,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){let i=e.data.length>s.value,a=e.data.length<s.value;(i||a)&&(o=this._getOrReturnCtx(e,o),i?S(o,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&S(o,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")dy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"email",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")yi||(yi=new RegExp(py,"u")),yi.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"emoji",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")ay.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"uuid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")cy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"nanoid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")oy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"cuid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")sy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"cuid2",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")iy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"ulid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),S(o,{validation:"url",code:b.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"regex",code:b.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(e,o),S(o,{code:b.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(o=this._getOrReturnCtx(e,o),S(o,{code:b.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(o=this._getOrReturnCtx(e,o),S(o,{code:b.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?td(s).test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{code:b.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?vy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{code:b.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?xy(s).test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{code:b.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?ly.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"duration",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?by(e.data,s.version)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"ip",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?$y(e.data,s.alg)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"jwt",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?wy(e.data,s.version)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"cidr",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?yy.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"base64",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?_y.test(e.data)||(o=this._getOrReturnCtx(e,o),S(o,{validation:"base64url",code:b.invalid_string,message:s.message}),n.dirty()):H.assertNever(s);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(o=>e.test(o),{validation:r,code:b.invalid_string,...E.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...E.errToObj(e)})}url(e){return this._addCheck({kind:"url",...E.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...E.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...E.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...E.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...E.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...E.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...E.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...E.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...E.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...E.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...E.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...E.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...E.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...E.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...E.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...E.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...E.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...E.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...E.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...E.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...E.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...E.errToObj(r)})}nonempty(e){return this.min(1,E.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Nt.create=t=>new Nt({checks:[],typeName:$.ZodString,coerce:t?.coerce??!1,...D(t)});function ky(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}var tr=class t extends L{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==T.number){let s=this._getOrReturnCtx(e);return S(s,{code:b.invalid_type,expected:T.number,received:s.parsedType}),N}let n,o=new xe;for(let s of this._def.checks)s.kind==="int"?H.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),S(n,{code:b.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),S(n,{code:b.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),S(n,{code:b.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="multipleOf"?ky(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),S(n,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),S(n,{code:b.not_finite,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,E.toString(r))}gt(e,r){return this.setLimit("min",e,!1,E.toString(r))}lte(e,r){return this.setLimit("max",e,!0,E.toString(r))}lt(e,r){return this.setLimit("max",e,!1,E.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:E.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:E.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:E.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&H.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};tr.create=t=>new tr({checks:[],typeName:$.ZodNumber,coerce:t?.coerce||!1,...D(t)});var rr=class t extends L{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==T.bigint)return this._getInvalidInput(e);let n,o=new xe;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),S(n,{code:b.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),S(n,{code:b.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),S(n,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return S(r,{code:b.invalid_type,expected:T.bigint,received:r.parsedType}),N}gte(e,r){return this.setLimit("min",e,!0,E.toString(r))}gt(e,r){return this.setLimit("min",e,!1,E.toString(r))}lte(e,r){return this.setLimit("max",e,!0,E.toString(r))}lt(e,r){return this.setLimit("max",e,!1,E.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:E.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};rr.create=t=>new rr({checks:[],typeName:$.ZodBigInt,coerce:t?.coerce??!1,...D(t)});var nr=class extends L{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==T.boolean){let n=this._getOrReturnCtx(e);return S(n,{code:b.invalid_type,expected:T.boolean,received:n.parsedType}),N}return Te(e.data)}};nr.create=t=>new nr({typeName:$.ZodBoolean,coerce:t?.coerce||!1,...D(t)});var or=class t extends L{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==T.date){let s=this._getOrReturnCtx(e);return S(s,{code:b.invalid_type,expected:T.date,received:s.parsedType}),N}if(Number.isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return S(s,{code:b.invalid_date}),N}let n=new xe,o;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(o=this._getOrReturnCtx(e,o),S(o,{code:b.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(o=this._getOrReturnCtx(e,o),S(o,{code:b.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):H.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:E.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:E.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};or.create=t=>new or({checks:[],coerce:t?.coerce||!1,typeName:$.ZodDate,...D(t)});var Ar=class extends L{_parse(e){if(this._getType(e)!==T.symbol){let n=this._getOrReturnCtx(e);return S(n,{code:b.invalid_type,expected:T.symbol,received:n.parsedType}),N}return Te(e.data)}};Ar.create=t=>new Ar({typeName:$.ZodSymbol,...D(t)});var sr=class extends L{_parse(e){if(this._getType(e)!==T.undefined){let n=this._getOrReturnCtx(e);return S(n,{code:b.invalid_type,expected:T.undefined,received:n.parsedType}),N}return Te(e.data)}};sr.create=t=>new sr({typeName:$.ZodUndefined,...D(t)});var ir=class extends L{_parse(e){if(this._getType(e)!==T.null){let n=this._getOrReturnCtx(e);return S(n,{code:b.invalid_type,expected:T.null,received:n.parsedType}),N}return Te(e.data)}};ir.create=t=>new ir({typeName:$.ZodNull,...D(t)});var jt=class extends L{constructor(){super(...arguments),this._any=!0}_parse(e){return Te(e.data)}};jt.create=t=>new jt({typeName:$.ZodAny,...D(t)});var kt=class extends L{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Te(e.data)}};kt.create=t=>new kt({typeName:$.ZodUnknown,...D(t)});var rt=class extends L{_parse(e){let r=this._getOrReturnCtx(e);return S(r,{code:b.invalid_type,expected:T.never,received:r.parsedType}),N}};rt.create=t=>new rt({typeName:$.ZodNever,...D(t)});var Mr=class extends L{_parse(e){if(this._getType(e)!==T.undefined){let n=this._getOrReturnCtx(e);return S(n,{code:b.invalid_type,expected:T.void,received:n.parsedType}),N}return Te(e.data)}};Mr.create=t=>new Mr({typeName:$.ZodVoid,...D(t)});var St=class t extends L{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),o=this._def;if(r.parsedType!==T.array)return S(r,{code:b.invalid_type,expected:T.array,received:r.parsedType}),N;if(o.exactLength!==null){let i=r.data.length>o.exactLength.value,a=r.data.length<o.exactLength.value;(i||a)&&(S(r,{code:i?b.too_big:b.too_small,minimum:a?o.exactLength.value:void 0,maximum:i?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(S(r,{code:b.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(S(r,{code:b.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>o.type._parseAsync(new Ke(r,i,r.path,a)))).then(i=>xe.mergeArray(n,i));let s=[...r.data].map((i,a)=>o.type._parseSync(new Ke(r,i,r.path,a)));return xe.mergeArray(n,s)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:E.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:E.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:E.toString(r)}})}nonempty(e){return this.min(1,e)}};St.create=(t,e)=>new St({type:t,minLength:null,maxLength:null,exactLength:null,typeName:$.ZodArray,...D(e)});function jr(t){if(t instanceof Ae){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=je.create(jr(n))}return new Ae({...t._def,shape:()=>e})}else return t instanceof St?new St({...t._def,type:jr(t.element)}):t instanceof je?je.create(jr(t.unwrap())):t instanceof mt?mt.create(jr(t.unwrap())):t instanceof ft?ft.create(t.items.map(e=>jr(e))):t}var Ae=class t extends L{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=H.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==T.object){let u=this._getOrReturnCtx(e);return S(u,{code:b.invalid_type,expected:T.object,received:u.parsedType}),N}let{status:n,ctx:o}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof rt&&this._def.unknownKeys==="strip"))for(let u in o.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let l=s[u],d=o.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Ke(o,d,o.path,u)),alwaysSet:u in o.data})}if(this._def.catchall instanceof rt){let u=this._def.unknownKeys;if(u==="passthrough")for(let l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:o.data[l]}});else if(u==="strict")a.length>0&&(S(o,{code:b.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let l of a){let d=o.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Ke(o,d,o.path,l)),alwaysSet:l in o.data})}}return o.common.async?Promise.resolve().then(async()=>{let u=[];for(let l of c){let d=await l.key,h=await l.value;u.push({key:d,value:h,alwaysSet:l.alwaysSet})}return u}).then(u=>xe.mergeObjectSync(n,u)):xe.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return E.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let o=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:E.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of H.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of H.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return jr(this)}partial(e){let r={};for(let n of H.objectKeys(this.shape)){let o=this.shape[n];e&&!e[n]?r[n]=o:r[n]=o.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of H.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof je;)s=s._def.innerType;r[n]=s}return new t({...this._def,shape:()=>r})}keyof(){return rd(H.objectKeys(this.shape))}};Ae.create=(t,e)=>new Ae({shape:()=>t,unknownKeys:"strip",catchall:rt.create(),typeName:$.ZodObject,...D(e)});Ae.strictCreate=(t,e)=>new Ae({shape:()=>t,unknownKeys:"strict",catchall:rt.create(),typeName:$.ZodObject,...D(e)});Ae.lazycreate=(t,e)=>new Ae({shape:t,unknownKeys:"strip",catchall:rt.create(),typeName:$.ZodObject,...D(e)});var ar=class extends L{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function o(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=s.map(a=>new Ne(a.ctx.common.issues));return S(r,{code:b.invalid_union,unionErrors:i}),N}if(r.common.async)return Promise.all(n.map(async s=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(o);{let s,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!s&&(s={result:l,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let a=i.map(c=>new Ne(c));return S(r,{code:b.invalid_union,unionErrors:a}),N}}get options(){return this._def.options}};ar.create=(t,e)=>new ar({options:t,typeName:$.ZodUnion,...D(e)});var wt=t=>t instanceof ur?wt(t.schema):t instanceof Je?wt(t.innerType()):t instanceof lr?[t.value]:t instanceof dr?t.options:t instanceof pr?H.objectValues(t.enum):t instanceof fr?wt(t._def.innerType):t instanceof sr?[void 0]:t instanceof ir?[null]:t instanceof je?[void 0,...wt(t.unwrap())]:t instanceof mt?[null,...wt(t.unwrap())]:t instanceof _n||t instanceof hr?wt(t.unwrap()):t instanceof mr?wt(t._def.innerType):[],ko=class t extends L{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.object)return S(r,{code:b.invalid_type,expected:T.object,received:r.parsedType}),N;let n=this.discriminator,o=r.data[n],s=this.optionsMap.get(o);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(S(r,{code:b.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),N)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let o=new Map;for(let s of r){let i=wt(s.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(o.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);o.set(a,s)}}return new t({typeName:$.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:o,...D(n)})}};function _i(t,e){let r=pt(t),n=pt(e);if(t===e)return{valid:!0,data:t};if(r===T.object&&n===T.object){let o=H.objectKeys(e),s=H.objectKeys(t).filter(a=>o.indexOf(a)!==-1),i={...t,...e};for(let a of s){let c=_i(t[a],e[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===T.array&&n===T.array){if(t.length!==e.length)return{valid:!1};let o=[];for(let s=0;s<t.length;s++){let i=t[s],a=e[s],c=_i(i,a);if(!c.valid)return{valid:!1};o.push(c.data)}return{valid:!0,data:o}}else return r===T.date&&n===T.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var cr=class extends L{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=(s,i)=>{if($o(s)||$o(i))return N;let a=_i(s.value,i.value);return a.valid?((wo(s)||wo(i))&&r.dirty(),{status:r.value,value:a.data}):(S(n,{code:b.invalid_intersection_types}),N)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,i])=>o(s,i)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};cr.create=(t,e,r)=>new cr({left:t,right:e,typeName:$.ZodIntersection,...D(r)});var ft=class t extends L{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.array)return S(n,{code:b.invalid_type,expected:T.array,received:n.parsedType}),N;if(n.data.length<this._def.items.length)return S(n,{code:b.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),N;!this._def.rest&&n.data.length>this._def.items.length&&(S(n,{code:b.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Ke(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(s).then(i=>xe.mergeArray(r,i)):xe.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};ft.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ft({items:t,typeName:$.ZodTuple,rest:null,...D(e)})};var So=class t extends L{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.object)return S(n,{code:b.invalid_type,expected:T.object,received:n.parsedType}),N;let o=[],s=this._def.keyType,i=this._def.valueType;for(let a in n.data)o.push({key:s._parse(new Ke(n,a,n.path,a)),value:i._parse(new Ke(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?xe.mergeObjectAsync(r,o):xe.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof L?new t({keyType:e,valueType:r,typeName:$.ZodRecord,...D(n)}):new t({keyType:Nt.create(),valueType:e,typeName:$.ZodRecord,...D(r)})}},Dr=class extends L{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.map)return S(n,{code:b.invalid_type,expected:T.map,received:n.parsedType}),N;let o=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:o._parse(new Ke(n,a,n.path,[u,"key"])),value:s._parse(new Ke(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return N;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return N;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}};Dr.create=(t,e,r)=>new Dr({valueType:e,keyType:t,typeName:$.ZodMap,...D(r)});var qr=class t extends L{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.set)return S(n,{code:b.invalid_type,expected:T.set,received:n.parsedType}),N;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(S(n,{code:b.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(S(n,{code:b.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());let s=this._def.valueType;function i(c){let u=new Set;for(let l of c){if(l.status==="aborted")return N;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>s._parse(new Ke(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:E.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:E.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};qr.create=(t,e)=>new qr({valueType:t,minSize:null,maxSize:null,typeName:$.ZodSet,...D(e)});var zo=class t extends L{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.function)return S(r,{code:b.invalid_type,expected:T.function,received:r.parsedType}),N;function n(a,c){return yn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Zr(),$t].filter(u=>!!u),issueData:{code:b.invalid_arguments,argumentsError:c}})}function o(a,c){return yn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Zr(),$t].filter(u=>!!u),issueData:{code:b.invalid_return_type,returnTypeError:c}})}let s={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof At){let a=this;return Te(async function(...c){let u=new Ne([]),l=await a._def.args.parseAsync(c,s).catch(f=>{throw u.addIssue(n(c,f)),u}),d=await Reflect.apply(i,this,l);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw u.addIssue(o(d,f)),u})})}else{let a=this;return Te(function(...c){let u=a._def.args.safeParse(c,s);if(!u.success)throw new Ne([n(c,u.error)]);let l=Reflect.apply(i,this,u.data),d=a._def.returns.safeParse(l,s);if(!d.success)throw new Ne([o(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:ft.create(e).rest(kt.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||ft.create([]).rest(kt.create()),returns:r||kt.create(),typeName:$.ZodFunction,...D(n)})}},ur=class extends L{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};ur.create=(t,e)=>new ur({getter:t,typeName:$.ZodLazy,...D(e)});var lr=class extends L{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return S(r,{received:r.data,code:b.invalid_literal,expected:this._def.value}),N}return{status:"valid",value:e.data}}get value(){return this._def.value}};lr.create=(t,e)=>new lr({value:t,typeName:$.ZodLiteral,...D(e)});function rd(t,e){return new dr({values:t,typeName:$.ZodEnum,...D(e)})}var dr=class t extends L{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return S(r,{expected:H.joinValues(n),received:r.parsedType,code:b.invalid_type}),N}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return S(r,{received:r.data,code:b.invalid_enum_value,options:n}),N}return Te(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};dr.create=rd;var pr=class extends L{_parse(e){let r=H.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==T.string&&n.parsedType!==T.number){let o=H.objectValues(r);return S(n,{expected:H.joinValues(o),received:n.parsedType,code:b.invalid_type}),N}if(this._cache||(this._cache=new Set(H.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let o=H.objectValues(r);return S(n,{received:n.data,code:b.invalid_enum_value,options:o}),N}return Te(e.data)}get enum(){return this._def.values}};pr.create=(t,e)=>new pr({values:t,typeName:$.ZodNativeEnum,...D(e)});var At=class extends L{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.promise&&r.common.async===!1)return S(r,{code:b.invalid_type,expected:T.promise,received:r.parsedType}),N;let n=r.parsedType===T.promise?r.data:Promise.resolve(r.data);return Te(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};At.create=(t,e)=>new At({type:t,typeName:$.ZodPromise,...D(e)});var Je=class extends L{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=this._def.effect||null,s={addIssue:i=>{S(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){let i=o.transform(n.data,s);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return N;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?N:c.status==="dirty"?er(c.value):r.value==="dirty"?er(c.value):c});{if(r.value==="aborted")return N;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?N:a.status==="dirty"?er(a.value):r.value==="dirty"?er(a.value):a}}if(o.type==="refinement"){let i=a=>{let c=o.refinement(a,s);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?N:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?N:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(o.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Zt(i))return N;let a=o.transform(i.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>Zt(i)?Promise.resolve(o.transform(i.value,s)).then(a=>({status:r.value,value:a})):N);H.assertNever(o)}};Je.create=(t,e,r)=>new Je({schema:t,typeName:$.ZodEffects,effect:e,...D(r)});Je.createWithPreprocess=(t,e,r)=>new Je({schema:e,effect:{type:"preprocess",transform:t},typeName:$.ZodEffects,...D(r)});var je=class extends L{_parse(e){return this._getType(e)===T.undefined?Te(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};je.create=(t,e)=>new je({innerType:t,typeName:$.ZodOptional,...D(e)});var mt=class extends L{_parse(e){return this._getType(e)===T.null?Te(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};mt.create=(t,e)=>new mt({innerType:t,typeName:$.ZodNullable,...D(e)});var fr=class extends L{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===T.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};fr.create=(t,e)=>new fr({innerType:t,typeName:$.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...D(e)});var mr=class extends L{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Nr(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ne(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Ne(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};mr.create=(t,e)=>new mr({innerType:t,typeName:$.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...D(e)});var Lr=class extends L{_parse(e){if(this._getType(e)!==T.nan){let n=this._getOrReturnCtx(e);return S(n,{code:b.invalid_type,expected:T.nan,received:n.parsedType}),N}return{status:"valid",value:e.data}}};Lr.create=t=>new Lr({typeName:$.ZodNaN,...D(t)});var Sy=Symbol("zod_brand"),_n=class extends L{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},vn=class t extends L{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?N:s.status==="dirty"?(r.dirty(),er(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?N:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:$.ZodPipeline})}},hr=class extends L{_parse(e){let r=this._def.innerType._parse(e),n=o=>(Zt(o)&&(o.value=Object.freeze(o.value)),o);return Nr(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};hr.create=(t,e)=>new hr({innerType:t,typeName:$.ZodReadonly,...D(e)});function Yl(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function nd(t,e={},r){return t?jt.create().superRefine((n,o)=>{let s=t(n);if(s instanceof Promise)return s.then(i=>{if(!i){let a=Yl(e,n),c=a.fatal??r??!0;o.addIssue({code:"custom",...a,fatal:c})}});if(!s){let i=Yl(e,n),a=i.fatal??r??!0;o.addIssue({code:"custom",...i,fatal:a})}}):jt.create()}var zy={object:Ae.lazycreate},$;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})($||($={}));var Ty=(t,e={message:`Input not instance of ${t.name}`})=>nd(r=>r instanceof t,e),od=Nt.create,sd=tr.create,Py=Lr.create,Ey=rr.create,id=nr.create,Iy=or.create,Ry=Ar.create,Cy=sr.create,Oy=ir.create,Zy=jt.create,Ny=kt.create,jy=rt.create,Ay=Mr.create,My=St.create,vi=Ae.create,Dy=Ae.strictCreate,qy=ar.create,Ly=ko.create,Uy=cr.create,Vy=ft.create,Fy=So.create,Hy=Dr.create,By=qr.create,Ky=zo.create,Jy=ur.create,Gy=lr.create,Wy=dr.create,Xy=pr.create,Yy=At.create,Qy=Je.create,e_=je.create,t_=mt.create,r_=Je.createWithPreprocess,n_=vn.create,o_=()=>od().optional(),s_=()=>sd().optional(),i_=()=>id().optional(),a_={string:(t=>Nt.create({...t,coerce:!0})),number:(t=>tr.create({...t,coerce:!0})),boolean:(t=>nr.create({...t,coerce:!0})),bigint:(t=>rr.create({...t,coerce:!0})),date:(t=>or.create({...t,coerce:!0}))};var c_=N;var u_=Object.freeze({status:"aborted"});function _(t,e,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(t),e(a,c);for(let l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}let o=r?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:t});function i(a){var c;let u=r?.Parent?new s:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}var zt=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},To={};function Ve(t){return t&&Object.assign(To,t),To}var B={};mi(B,{BIGINT_FORMAT_RANGES:()=>cd,Class:()=>bi,NUMBER_FORMAT_RANGES:()=>Pi,aborted:()=>yr,allowsEval:()=>Si,assert:()=>m_,assertEqual:()=>l_,assertIs:()=>p_,assertNever:()=>f_,assertNotEqual:()=>d_,assignProp:()=>ki,cached:()=>$n,captureStackTrace:()=>Eo,cleanEnum:()=>T_,cleanRegex:()=>kn,clone:()=>Fe,createTransparentProxy:()=>x_,defineLazy:()=>ne,esc:()=>gr,escapeRegex:()=>Mt,extend:()=>w_,finalizeIssue:()=>nt,floatSafeRemainder:()=>wi,getElementAtPath:()=>h_,getEnumValues:()=>bn,getLengthableOrigin:()=>Sn,getParsedType:()=>v_,getSizableOrigin:()=>ud,isObject:()=>Ur,isPlainObject:()=>Vr,issue:()=>Ei,joinValues:()=>Po,jsonStringifyReplacer:()=>$i,merge:()=>k_,normalizeParams:()=>j,nullish:()=>wn,numKeys:()=>__,omit:()=>$_,optionalKeys:()=>Ti,partial:()=>S_,pick:()=>b_,prefixIssues:()=>ht,primitiveTypes:()=>ad,promiseAllObject:()=>g_,propertyKeyTypes:()=>zi,randomString:()=>y_,required:()=>z_,stringifyPrimitive:()=>Io,unwrapMessage:()=>xn});function l_(t){return t}function d_(t){return t}function p_(t){}function f_(t){throw new Error}function m_(t){}function bn(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,o])=>e.indexOf(+n)===-1).map(([n,o])=>o)}function Po(t,e="|"){return t.map(r=>Io(r)).join(e)}function $i(t,e){return typeof e=="bigint"?e.toString():e}function $n(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function wn(t){return t==null}function kn(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function wi(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}function ne(t,e,r){Object.defineProperty(t,e,{get(){{let o=r();return t[e]=o,o}throw new Error("cached value already set")},set(o){Object.defineProperty(t,e,{value:o})},configurable:!0})}function ki(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function h_(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function g_(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let o={};for(let s=0;s<e.length;s++)o[e[s]]=n[s];return o})}function y_(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function gr(t){return JSON.stringify(t)}var Eo=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Ur(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Si=$n(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Vr(t){if(Ur(t)===!1)return!1;let e=t.constructor;if(e===void 0)return!0;let r=e.prototype;return!(Ur(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function __(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var v_=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},zi=new Set(["string","number","symbol"]),ad=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Mt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Fe(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function j(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function x_(t){let e;return new Proxy({},{get(r,n,o){return e??(e=t()),Reflect.get(e,n,o)},set(r,n,o,s){return e??(e=t()),Reflect.set(e,n,o,s)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,o){return e??(e=t()),Reflect.defineProperty(e,n,o)}})}function Io(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Ti(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var Pi={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},cd={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function b_(t,e){let r={},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&(r[o]=n.shape[o])}return Fe(t,{...t._zod.def,shape:r,checks:[]})}function $_(t,e){let r={...t._zod.def.shape},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&delete r[o]}return Fe(t,{...t._zod.def,shape:r,checks:[]})}function w_(t,e){if(!Vr(e))throw new Error("Invalid input to extend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return ki(this,"shape",n),n},checks:[]};return Fe(t,r)}function k_(t,e){return Fe(t,{...t._zod.def,get shape(){let r={...t._zod.def.shape,...e._zod.def.shape};return ki(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function S_(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in n))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=t?new t({type:"optional",innerType:n[s]}):n[s])}else for(let s in n)o[s]=t?new t({type:"optional",innerType:n[s]}):n[s];return Fe(e,{...e._zod.def,shape:o,checks:[]})}function z_(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=new t({type:"nonoptional",innerType:n[s]}))}else for(let s in n)o[s]=new t({type:"nonoptional",innerType:n[s]});return Fe(e,{...e._zod.def,shape:o,checks:[]})}function yr(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function ht(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function xn(t){return typeof t=="string"?t:t?.message}function nt(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let o=xn(t.inst?._zod.def?.error?.(t))??xn(e?.error?.(t))??xn(r.customError?.(t))??xn(r.localeError?.(t))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function ud(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function Sn(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Ei(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function T_(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}var bi=class{constructor(...e){}};var ld=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,$i,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},Ro=_("$ZodError",ld),zn=_("$ZodError",ld,{Parent:Error});function Ii(t,e=r=>r.message){let r={},n=[];for(let o of t.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:r}}function Ri(t,e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>o({issues:a}));else if(i.code==="invalid_key")o({issues:i.issues});else if(i.code==="invalid_element")o({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(t),n}var Ci=t=>(e,r,n,o)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new zt;if(i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>nt(c,s,Ve())));throw Eo(a,o?.callee),a}return i.value},Oi=Ci(zn),Zi=t=>async(e,r,n,o)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>nt(c,s,Ve())));throw Eo(a,o?.callee),a}return i.value},Ni=Zi(zn),ji=t=>(e,r,n)=>{let o=n?{...n,async:!1}:{async:!1},s=e._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new zt;return s.issues.length?{success:!1,error:new(t??Ro)(s.issues.map(i=>nt(i,o,Ve())))}:{success:!0,data:s.value}},_r=ji(zn),Ai=t=>async(e,r,n)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},s=e._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(i=>nt(i,o,Ve())))}:{success:!0,data:s.value}},vr=Ai(zn);var dd=/^[cC][^\s-]{8,}$/,pd=/^[0-9a-z]+$/,fd=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,md=/^[0-9a-vA-V]{20}$/,hd=/^[A-Za-z0-9]{27}$/,gd=/^[a-zA-Z0-9_-]{21}$/,yd=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var _d=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Mi=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;var vd=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;var E_="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function xd(){return new RegExp(E_,"u")}var bd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$d=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,wd=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,kd=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Sd=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Di=/^[A-Za-z0-9_-]*$/,zd=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var Td=/^\+(?:[0-9]){6,14}[0-9]$/,Pd="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Ed=new RegExp(`^${Pd}$`);function Id(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Rd(t){return new RegExp(`^${Id(t)}$`)}function Cd(t){let e=Id({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${Pd}T(?:${n})$`)}var Od=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)};var Zd=/^\d+$/,Nd=/^-?\d+(?:\.\d+)?/i,jd=/true|false/i,Ad=/null/i;var Md=/^[^A-Z]*$/,Dd=/^[^a-z]*$/;var be=_("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),qd={number:"number",bigint:"bigint",object:"date"},qi=_("$ZodCheckLessThan",(t,e)=>{be.init(t,e);let r=qd[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Li=_("$ZodCheckGreaterThan",(t,e)=>{be.init(t,e);let r=qd[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Ld=_("$ZodCheckMultipleOf",(t,e)=>{be.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):wi(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),Ud=_("$ZodCheckNumberFormat",(t,e)=>{be.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[o,s]=Pi[e.format];t._zod.onattach.push(i=>{let a=i._zod.bag;a.format=e.format,a.minimum=o,a.maximum=s,r&&(a.pattern=Zd)}),t._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:e.format,code:"invalid_type",input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<o&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!e.abort}),a>s&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:t})}});var Vd=_("$ZodCheckMaxLength",(t,e)=>{var r;be.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!wn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let o=n.value;if(o.length<=e.maximum)return;let i=Sn(o);n.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),Fd=_("$ZodCheckMinLength",(t,e)=>{var r;be.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!wn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let o=n.value;if(o.length>=e.minimum)return;let i=Sn(o);n.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),Hd=_("$ZodCheckLengthEquals",(t,e)=>{var r;be.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!wn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag;o.minimum=e.length,o.maximum=e.length,o.length=e.length}),t._zod.check=n=>{let o=n.value,s=o.length;if(s===e.length)return;let i=Sn(o),a=s>e.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Tn=_("$ZodCheckStringFormat",(t,e)=>{var r,n;be.init(t,e),t._zod.onattach.push(o=>{let s=o._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=o=>{e.pattern.lastIndex=0,!e.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:e.format,input:o.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),Bd=_("$ZodCheckRegex",(t,e)=>{Tn.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),Kd=_("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Md),Tn.init(t,e)}),Jd=_("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Dd),Tn.init(t,e)}),Gd=_("$ZodCheckIncludes",(t,e)=>{be.init(t,e);let r=Mt(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(o=>{let s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),t._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:t,continue:!e.abort})}}),Wd=_("$ZodCheckStartsWith",(t,e)=>{be.init(t,e);let r=new RegExp(`^${Mt(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),Xd=_("$ZodCheckEndsWith",(t,e)=>{be.init(t,e);let r=new RegExp(`.*${Mt(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});var Yd=_("$ZodCheckOverwrite",(t,e)=>{be.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var Oo=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(i=>i),o=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(let i of s)this.content.push(i)}compile(){let e=Function,r=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...r,o.join(`
`))}};var ep={major:4,minor:0,patch:0};var ee=_("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=ep;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let o of n)for(let s of o._zod.onattach)s(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let o=(s,i,a)=>{let c=yr(s),u;for(let l of i){if(l._zod.def.when){if(!l._zod.def.when(s))continue}else if(c)continue;let d=s.issues.length,h=l._zod.check(s);if(h instanceof Promise&&a?.async===!1)throw new zt;if(u||h instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await h,s.issues.length!==d&&(c||(c=yr(s,d)))});else{if(s.issues.length===d)continue;c||(c=yr(s,d))}}return u?u.then(()=>s):s};t._zod.run=(s,i)=>{let a=t._zod.parse(s,i);if(a instanceof Promise){if(i.async===!1)throw new zt;return a.then(c=>o(c,n,i))}return o(a,n,i)}}t["~standard"]={validate:o=>{try{let s=_r(t,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return vr(t,o).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),Pn=_("$ZodString",(t,e)=>{ee.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Od(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),oe=_("$ZodStringFormat",(t,e)=>{Tn.init(t,e),Pn.init(t,e)}),Vi=_("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=_d),oe.init(t,e)}),Fi=_("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Mi(n))}else e.pattern??(e.pattern=Mi());oe.init(t,e)}),Hi=_("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=vd),oe.init(t,e)}),Bi=_("$ZodURL",(t,e)=>{oe.init(t,e),t._zod.check=r=>{try{let n=r.value,o=new URL(n),s=o.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:zd.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&s.endsWith("/")?r.value=s.slice(0,-1):r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),Ki=_("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=xd()),oe.init(t,e)}),Ji=_("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=gd),oe.init(t,e)}),Gi=_("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=dd),oe.init(t,e)}),Wi=_("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=pd),oe.init(t,e)}),Xi=_("$ZodULID",(t,e)=>{e.pattern??(e.pattern=fd),oe.init(t,e)}),Yi=_("$ZodXID",(t,e)=>{e.pattern??(e.pattern=md),oe.init(t,e)}),Qi=_("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=hd),oe.init(t,e)}),lp=_("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=Cd(e)),oe.init(t,e)}),dp=_("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Ed),oe.init(t,e)}),pp=_("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=Rd(e)),oe.init(t,e)}),fp=_("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=yd),oe.init(t,e)}),ea=_("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=bd),oe.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),ta=_("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=$d),oe.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),ra=_("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=wd),oe.init(t,e)}),na=_("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=kd),oe.init(t,e),t._zod.check=r=>{let[n,o]=r.value.split("/");try{if(!o)throw new Error;let s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function mp(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var oa=_("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Sd),oe.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{mp(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function I_(t){if(!Di.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return mp(r)}var sa=_("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Di),oe.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{I_(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),ia=_("$ZodE164",(t,e)=>{e.pattern??(e.pattern=Td),oe.init(t,e)});function R_(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}var aa=_("$ZodJWT",(t,e)=>{oe.init(t,e),t._zod.check=r=>{R_(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}});var No=_("$ZodNumber",(t,e)=>{ee.init(t,e),t._zod.pattern=t._zod.bag.pattern??Nd,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;let s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...s?{received:s}:{}}),r}}),ca=_("$ZodNumber",(t,e)=>{Ud.init(t,e),No.init(t,e)}),ua=_("$ZodBoolean",(t,e)=>{ee.init(t,e),t._zod.pattern=jd,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),r}});var la=_("$ZodNull",(t,e)=>{ee.init(t,e),t._zod.pattern=Ad,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:t}),r}});var da=_("$ZodUnknown",(t,e)=>{ee.init(t,e),t._zod.parse=r=>r}),pa=_("$ZodNever",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function tp(t,e,r){t.issues.length&&e.issues.push(...ht(r,t.issues)),e.value[r]=t.value}var fa=_("$ZodArray",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),r;r.value=Array(o.length);let s=[];for(let i=0;i<o.length;i++){let a=o[i],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?s.push(c.then(u=>tp(u,r,i))):tp(c,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function Zo(t,e,r){t.issues.length&&e.issues.push(...ht(r,t.issues)),e.value[r]=t.value}function rp(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...ht(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}var jo=_("$ZodObject",(t,e)=>{ee.init(t,e);let r=$n(()=>{let d=Object.keys(e.shape);for(let f of d)if(!(e.shape[f]instanceof ee))throw new Error(`Invalid element at key "${f}": expected a Zod schema`);let h=Ti(e.shape);return{shape:e.shape,keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(h)}});ne(t._zod,"propValues",()=>{let d=e.shape,h={};for(let f in d){let p=d[f]._zod;if(p.values){h[f]??(h[f]=new Set);for(let m of p.values)h[f].add(m)}}return h});let n=d=>{let h=new Oo(["shape","payload","ctx"]),f=r.value,p=x=>{let w=gr(x);return`shape[${w}]._zod.run({ value: input[${w}], issues: [] }, ctx)`};h.write("const input = payload.value;");let m=Object.create(null),g=0;for(let x of f.keys)m[x]=`key_${g++}`;h.write("const newResult = {}");for(let x of f.keys)if(f.optionalKeys.has(x)){let w=m[x];h.write(`const ${w} = ${p(x)};`);let k=gr(x);h.write(`
        if (${w}.issues.length) {
          if (input[${k}] === undefined) {
            if (${k} in input) {
              newResult[${k}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${w}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${k}, ...iss.path] : [${k}],
              }))
            );
          }
        } else if (${w}.value === undefined) {
          if (${k} in input) newResult[${k}] = undefined;
        } else {
          newResult[${k}] = ${w}.value;
        }
        `)}else{let w=m[x];h.write(`const ${w} = ${p(x)};`),h.write(`
          if (${w}.issues.length) payload.issues = payload.issues.concat(${w}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${gr(x)}, ...iss.path] : [${gr(x)}]
          })));`),h.write(`newResult[${gr(x)}] = ${w}.value`)}h.write("payload.value = newResult;"),h.write("return payload;");let v=h.compile();return(x,w)=>v(d,x,w)},o,s=Ur,i=!To.jitless,c=i&&Si.value,u=e.catchall,l;t._zod.parse=(d,h)=>{l??(l=r.value);let f=d.value;if(!s(f))return d.issues.push({expected:"object",code:"invalid_type",input:f,inst:t}),d;let p=[];if(i&&c&&h?.async===!1&&h.jitless!==!0)o||(o=n(e.shape)),d=o(d,h);else{d.value={};let w=l.shape;for(let k of l.keys){let O=w[k],me=O._zod.run({value:f[k],issues:[]},h),ge=O._zod.optin==="optional"&&O._zod.optout==="optional";me instanceof Promise?p.push(me.then(Be=>ge?rp(Be,d,k,f):Zo(Be,d,k))):ge?rp(me,d,k,f):Zo(me,d,k)}}if(!u)return p.length?Promise.all(p).then(()=>d):d;let m=[],g=l.keySet,v=u._zod,x=v.def.type;for(let w of Object.keys(f)){if(g.has(w))continue;if(x==="never"){m.push(w);continue}let k=v.run({value:f[w],issues:[]},h);k instanceof Promise?p.push(k.then(O=>Zo(O,d,w))):Zo(k,d,w)}return m.length&&d.issues.push({code:"unrecognized_keys",keys:m,input:f,inst:t}),p.length?Promise.all(p).then(()=>d):d}});function np(t,e,r,n){for(let o of t)if(o.issues.length===0)return e.value=o.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(o=>o.issues.map(s=>nt(s,n,Ve())))}),e}var Ao=_("$ZodUnion",(t,e)=>{ee.init(t,e),ne(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),ne(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),ne(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),ne(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){let r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>kn(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let o=!1,s=[];for(let i of e.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)s.push(a),o=!0;else{if(a.issues.length===0)return a;s.push(a)}}return o?Promise.all(s).then(i=>np(i,r,t,n)):np(s,r,t,n)}}),ma=_("$ZodDiscriminatedUnion",(t,e)=>{Ao.init(t,e);let r=t._zod.parse;ne(t._zod,"propValues",()=>{let o={};for(let s of e.options){let i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(let[a,c]of Object.entries(i)){o[a]||(o[a]=new Set);for(let u of c)o[a].add(u)}}return o});let n=$n(()=>{let o=e.options,s=new Map;for(let i of o){let a=i._zod.propValues[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let c of a){if(s.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);s.set(c,i)}}return s});t._zod.parse=(o,s)=>{let i=o.value;if(!Ur(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),o;let a=n.value.get(i?.[e.discriminator]);return a?a._zod.run(o,s):e.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[e.discriminator],inst:t}),o)}}),ha=_("$ZodIntersection",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>{let o=r.value,s=e.left._zod.run({value:o,issues:[]},n),i=e.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([c,u])=>op(r,c,u)):op(r,s,i)}});function Ui(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Vr(t)&&Vr(e)){let r=Object.keys(e),n=Object.keys(t).filter(s=>r.indexOf(s)!==-1),o={...t,...e};for(let s of n){let i=Ui(t[s],e[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let o=t[n],s=e[n],i=Ui(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function op(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),yr(t))return t;let n=Ui(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var ga=_("$ZodRecord",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Vr(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:t}),r;let s=[];if(e.keyType._zod.values){let i=e.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=e.valueType._zod.run({value:o[c],issues:[]},n);u instanceof Promise?s.push(u.then(l=>{l.issues.length&&r.issues.push(...ht(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(...ht(c,u.issues)),r.value[c]=u.value)}let a;for(let c in o)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:t,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(o)){if(i==="__proto__")continue;let a=e.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>nt(u,n,Ve())),input:i,path:[i],inst:t}),r.value[a.value]=a.value;continue}let c=e.valueType._zod.run({value:o[i],issues:[]},n);c instanceof Promise?s.push(c.then(u=>{u.issues.length&&r.issues.push(...ht(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...ht(i,c.issues)),r.value[a.value]=c.value)}}return s.length?Promise.all(s).then(()=>r):r}});var ya=_("$ZodEnum",(t,e)=>{ee.init(t,e);let r=bn(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>zi.has(typeof n)).map(n=>typeof n=="string"?Mt(n):n.toString()).join("|")})$`),t._zod.parse=(n,o)=>{let s=n.value;return t._zod.values.has(s)||n.issues.push({code:"invalid_value",values:r,input:s,inst:t}),n}}),_a=_("$ZodLiteral",(t,e)=>{ee.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?Mt(r):r?r.toString():String(r)).join("|")})$`),t._zod.parse=(r,n)=>{let o=r.value;return t._zod.values.has(o)||r.issues.push({code:"invalid_value",values:e.values,input:o,inst:t}),r}});var va=_("$ZodTransform",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>{let o=e.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(r.value=i,r));if(o instanceof Promise)throw new zt;return r.value=o,r}}),xa=_("$ZodOptional",(t,e)=>{ee.init(t,e),t._zod.optin="optional",t._zod.optout="optional",ne(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),ne(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${kn(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),ba=_("$ZodNullable",(t,e)=>{ee.init(t,e),ne(t._zod,"optin",()=>e.innerType._zod.optin),ne(t._zod,"optout",()=>e.innerType._zod.optout),ne(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${kn(r.source)}|null)$`):void 0}),ne(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),$a=_("$ZodDefault",(t,e)=>{ee.init(t,e),t._zod.optin="optional",ne(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>sp(s,e)):sp(o,e)}});function sp(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var wa=_("$ZodPrefault",(t,e)=>{ee.init(t,e),t._zod.optin="optional",ne(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),ka=_("$ZodNonOptional",(t,e)=>{ee.init(t,e),ne(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>ip(s,t)):ip(o,t)}});function ip(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var Sa=_("$ZodCatch",(t,e)=>{ee.init(t,e),t._zod.optin="optional",ne(t._zod,"optout",()=>e.innerType._zod.optout),ne(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=e.catchValue({...r,error:{issues:s.issues.map(i=>nt(i,n,Ve()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(s=>nt(s,n,Ve()))},input:r.value}),r.issues=[]),r)}});var za=_("$ZodPipe",(t,e)=>{ee.init(t,e),ne(t._zod,"values",()=>e.in._zod.values),ne(t._zod,"optin",()=>e.in._zod.optin),ne(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(r,n)=>{let o=e.in._zod.run(r,n);return o instanceof Promise?o.then(s=>ap(s,e,n)):ap(o,e,n)}});function ap(t,e,r){return yr(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}var Ta=_("$ZodReadonly",(t,e)=>{ee.init(t,e),ne(t._zod,"propValues",()=>e.innerType._zod.propValues),ne(t._zod,"values",()=>e.innerType._zod.values),ne(t._zod,"optin",()=>e.innerType._zod.optin),ne(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(cp):cp(o)}});function cp(t){return t.value=Object.freeze(t.value),t}var Pa=_("$ZodCustom",(t,e)=>{be.init(t,e),ee.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,o=e.fn(n);if(o instanceof Promise)return o.then(s=>up(s,r,n,t));up(o,r,n,t)}});function up(t,e,r,n){if(!t){let o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),e.issues.push(Ei(o))}}var C_=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},O_=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${C_(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${Io(n.values[0])}`:`Invalid option: expected one of ${Po(n.values,"|")}`;case"too_big":{let o=n.inclusive?"<=":"<",s=e(n.origin);return s?`Too big: expected ${n.origin??"value"} to have ${o}${n.maximum.toString()} ${s.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${o}${n.maximum.toString()}`}case"too_small":{let o=n.inclusive?">=":">",s=e(n.origin);return s?`Too small: expected ${n.origin} to have ${o}${n.minimum.toString()} ${s.unit}`:`Too small: expected ${n.origin} to be ${o}${n.minimum.toString()}`}case"invalid_format":{let o=n;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${Po(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function hp(){return{localeError:O_()}}var En=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function gp(){return new En}var Dt=gp();function Ea(t,e){return new t({type:"string",...j(e)})}function Ia(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...j(e)})}function Mo(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...j(e)})}function Ra(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...j(e)})}function Ca(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...j(e)})}function Oa(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...j(e)})}function Za(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...j(e)})}function Na(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...j(e)})}function ja(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...j(e)})}function Aa(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...j(e)})}function Ma(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...j(e)})}function Da(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...j(e)})}function qa(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...j(e)})}function La(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...j(e)})}function Ua(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...j(e)})}function Va(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...j(e)})}function Fa(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...j(e)})}function Ha(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...j(e)})}function Ba(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...j(e)})}function Ka(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...j(e)})}function Ja(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...j(e)})}function Ga(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...j(e)})}function Wa(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...j(e)})}function yp(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...j(e)})}function _p(t,e){return new t({type:"string",format:"date",check:"string_format",...j(e)})}function vp(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...j(e)})}function xp(t,e){return new t({type:"string",format:"duration",check:"string_format",...j(e)})}function Xa(t,e){return new t({type:"number",checks:[],...j(e)})}function Ya(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...j(e)})}function Qa(t,e){return new t({type:"boolean",...j(e)})}function ec(t,e){return new t({type:"null",...j(e)})}function tc(t){return new t({type:"unknown"})}function rc(t,e){return new t({type:"never",...j(e)})}function Do(t,e){return new qi({check:"less_than",...j(e),value:t,inclusive:!1})}function In(t,e){return new qi({check:"less_than",...j(e),value:t,inclusive:!0})}function qo(t,e){return new Li({check:"greater_than",...j(e),value:t,inclusive:!1})}function Rn(t,e){return new Li({check:"greater_than",...j(e),value:t,inclusive:!0})}function Lo(t,e){return new Ld({check:"multiple_of",...j(e),value:t})}function Uo(t,e){return new Vd({check:"max_length",...j(e),maximum:t})}function Fr(t,e){return new Fd({check:"min_length",...j(e),minimum:t})}function Vo(t,e){return new Hd({check:"length_equals",...j(e),length:t})}function nc(t,e){return new Bd({check:"string_format",format:"regex",...j(e),pattern:t})}function oc(t){return new Kd({check:"string_format",format:"lowercase",...j(t)})}function sc(t){return new Jd({check:"string_format",format:"uppercase",...j(t)})}function ic(t,e){return new Gd({check:"string_format",format:"includes",...j(e),includes:t})}function ac(t,e){return new Wd({check:"string_format",format:"starts_with",...j(e),prefix:t})}function cc(t,e){return new Xd({check:"string_format",format:"ends_with",...j(e),suffix:t})}function xr(t){return new Yd({check:"overwrite",tx:t})}function uc(t){return xr(e=>e.normalize(t))}function lc(){return xr(t=>t.trim())}function dc(){return xr(t=>t.toLowerCase())}function pc(){return xr(t=>t.toUpperCase())}function bp(t,e,r){return new t({type:"array",element:e,...j(r)})}function fc(t,e,r){let n=j(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function mc(t,e,r){return new t({type:"custom",check:"custom",fn:e,...j(r)})}var Fo=class{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??Dt,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,r={path:[],schemaPath:[]}){var n;let o=e._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(e);if(i)return i.count++,r.schemaPath.includes(e)&&(i.cycle=r.path),i.schema;let a={schema:{},count:1,cycle:void 0,path:r.path};this.seen.set(e,a);let c=e._zod.toJSONSchema?.();if(c)a.schema=c;else{let d={...r,schemaPath:[...r.schemaPath,e],path:r.path},h=e._zod.parent;if(h)a.ref=h,this.process(h,d),this.seen.get(h).isParent=!0;else{let f=a.schema;switch(o.type){case"string":{let p=f;p.type="string";let{minimum:m,maximum:g,format:v,patterns:x,contentEncoding:w}=e._zod.bag;if(typeof m=="number"&&(p.minLength=m),typeof g=="number"&&(p.maxLength=g),v&&(p.format=s[v]??v,p.format===""&&delete p.format),w&&(p.contentEncoding=w),x&&x.size>0){let k=[...x];k.length===1?p.pattern=k[0].source:k.length>1&&(a.schema.allOf=[...k.map(O=>({...this.target==="draft-7"?{type:"string"}:{},pattern:O.source}))])}break}case"number":{let p=f,{minimum:m,maximum:g,format:v,multipleOf:x,exclusiveMaximum:w,exclusiveMinimum:k}=e._zod.bag;typeof v=="string"&&v.includes("int")?p.type="integer":p.type="number",typeof k=="number"&&(p.exclusiveMinimum=k),typeof m=="number"&&(p.minimum=m,typeof k=="number"&&(k>=m?delete p.minimum:delete p.exclusiveMinimum)),typeof w=="number"&&(p.exclusiveMaximum=w),typeof g=="number"&&(p.maximum=g,typeof w=="number"&&(w<=g?delete p.maximum:delete p.exclusiveMaximum)),typeof x=="number"&&(p.multipleOf=x);break}case"boolean":{let p=f;p.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{f.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{f.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let p=f,{minimum:m,maximum:g}=e._zod.bag;typeof m=="number"&&(p.minItems=m),typeof g=="number"&&(p.maxItems=g),p.type="array",p.items=this.process(o.element,{...d,path:[...d.path,"items"]});break}case"object":{let p=f;p.type="object",p.properties={};let m=o.shape;for(let x in m)p.properties[x]=this.process(m[x],{...d,path:[...d.path,"properties",x]});let g=new Set(Object.keys(m)),v=new Set([...g].filter(x=>{let w=o.shape[x]._zod;return this.io==="input"?w.optin===void 0:w.optout===void 0}));v.size>0&&(p.required=Array.from(v)),o.catchall?._zod.def.type==="never"?p.additionalProperties=!1:o.catchall?o.catchall&&(p.additionalProperties=this.process(o.catchall,{...d,path:[...d.path,"additionalProperties"]})):this.io==="output"&&(p.additionalProperties=!1);break}case"union":{let p=f;p.anyOf=o.options.map((m,g)=>this.process(m,{...d,path:[...d.path,"anyOf",g]}));break}case"intersection":{let p=f,m=this.process(o.left,{...d,path:[...d.path,"allOf",0]}),g=this.process(o.right,{...d,path:[...d.path,"allOf",1]}),v=w=>"allOf"in w&&Object.keys(w).length===1,x=[...v(m)?m.allOf:[m],...v(g)?g.allOf:[g]];p.allOf=x;break}case"tuple":{let p=f;p.type="array";let m=o.items.map((x,w)=>this.process(x,{...d,path:[...d.path,"prefixItems",w]}));if(this.target==="draft-2020-12"?p.prefixItems=m:p.items=m,o.rest){let x=this.process(o.rest,{...d,path:[...d.path,"items"]});this.target==="draft-2020-12"?p.items=x:p.additionalItems=x}o.rest&&(p.items=this.process(o.rest,{...d,path:[...d.path,"items"]}));let{minimum:g,maximum:v}=e._zod.bag;typeof g=="number"&&(p.minItems=g),typeof v=="number"&&(p.maxItems=v);break}case"record":{let p=f;p.type="object",p.propertyNames=this.process(o.keyType,{...d,path:[...d.path,"propertyNames"]}),p.additionalProperties=this.process(o.valueType,{...d,path:[...d.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let p=f,m=bn(o.entries);m.every(g=>typeof g=="number")&&(p.type="number"),m.every(g=>typeof g=="string")&&(p.type="string"),p.enum=m;break}case"literal":{let p=f,m=[];for(let g of o.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");m.push(Number(g))}else m.push(g);if(m.length!==0)if(m.length===1){let g=m[0];p.type=g===null?"null":typeof g,p.const=g}else m.every(g=>typeof g=="number")&&(p.type="number"),m.every(g=>typeof g=="string")&&(p.type="string"),m.every(g=>typeof g=="boolean")&&(p.type="string"),m.every(g=>g===null)&&(p.type="null"),p.enum=m;break}case"file":{let p=f,m={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:v,mime:x}=e._zod.bag;g!==void 0&&(m.minLength=g),v!==void 0&&(m.maxLength=v),x?x.length===1?(m.contentMediaType=x[0],Object.assign(p,m)):p.anyOf=x.map(w=>({...m,contentMediaType:w})):Object.assign(p,m);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let p=this.process(o.innerType,d);f.anyOf=[p,{type:"null"}];break}case"nonoptional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"success":{let p=f;p.type="boolean";break}case"default":{this.process(o.innerType,d),a.ref=o.innerType,f.default=JSON.parse(JSON.stringify(o.defaultValue));break}case"prefault":{this.process(o.innerType,d),a.ref=o.innerType,this.io==="input"&&(f._prefault=JSON.parse(JSON.stringify(o.defaultValue)));break}case"catch":{this.process(o.innerType,d),a.ref=o.innerType;let p;try{p=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}f.default=p;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let p=f,m=e._zod.pattern;if(!m)throw new Error("Pattern not found in template literal");p.type="string",p.pattern=m.source;break}case"pipe":{let p=this.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;this.process(p,d),a.ref=p;break}case"readonly":{this.process(o.innerType,d),a.ref=o.innerType,f.readOnly=!0;break}case"promise":{this.process(o.innerType,d),a.ref=o.innerType;break}case"optional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"lazy":{let p=e._zod.innerType;this.process(p,d),a.ref=p;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}default:}}}let u=this.metadataRegistry.get(e);return u&&Object.assign(a.schema,u),this.io==="input"&&_e(e)&&(delete a.schema.examples,delete a.schema.default),this.io==="input"&&a.schema._prefault&&((n=a.schema).default??(n.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(e).schema}emit(e,r){let n={cycles:r?.cycles??"ref",reused:r?.reused??"inline",external:r?.external??void 0},o=this.seen.get(e);if(!o)throw new Error("Unprocessed schema. This is a bug in Zod.");let s=l=>{let d=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){let m=n.external.registry.get(l[0])?.id,g=n.external.uri??(x=>x);if(m)return{ref:g(m)};let v=l[1].defId??l[1].schema.id??`schema${this.counter++}`;return l[1].defId=v,{defId:v,ref:`${g("__shared")}#/${d}/${v}`}}if(l[1]===o)return{ref:"#"};let f=`#/${d}/`,p=l[1].schema.id??`__schema${this.counter++}`;return{defId:p,ref:f+p}},i=l=>{if(l[1].schema.$ref)return;let d=l[1],{ref:h,defId:f}=s(l);d.def={...d.schema},f&&(d.defId=f);let p=d.schema;for(let m in p)delete p[m];p.$ref=h};if(n.cycles==="throw")for(let l of this.seen.entries()){let d=l[1];if(d.cycle)throw new Error(`Cycle detected: #/${d.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let l of this.seen.entries()){let d=l[1];if(e===l[0]){i(l);continue}if(n.external){let f=n.external.registry.get(l[0])?.id;if(e!==l[0]&&f){i(l);continue}}if(this.metadataRegistry.get(l[0])?.id){i(l);continue}if(d.cycle){i(l);continue}if(d.count>1&&n.reused==="ref"){i(l);continue}}let a=(l,d)=>{let h=this.seen.get(l),f=h.def??h.schema,p={...f};if(h.ref===null)return;let m=h.ref;if(h.ref=null,m){a(m,d);let g=this.seen.get(m).schema;g.$ref&&d.target==="draft-7"?(f.allOf=f.allOf??[],f.allOf.push(g)):(Object.assign(f,g),Object.assign(f,p))}h.isParent||this.override({zodSchema:l,jsonSchema:f,path:h.path??[]})};for(let l of[...this.seen.entries()].reverse())a(l[0],{target:this.target});let c={};if(this.target==="draft-2020-12"?c.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?c.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),n.external?.uri){let l=n.external.registry.get(e)?.id;if(!l)throw new Error("Schema is missing an `id` property");c.$id=n.external.uri(l)}Object.assign(c,o.def);let u=n.external?.defs??{};for(let l of this.seen.entries()){let d=l[1];d.def&&d.defId&&(u[d.defId]=d.def)}n.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?c.$defs=u:c.definitions=u);try{return JSON.parse(JSON.stringify(c))}catch{throw new Error("Error converting schema to JSON.")}}};function hc(t,e){if(t instanceof En){let n=new Fo(e),o={};for(let a of t._idmap.entries()){let[c,u]=a;n.process(u)}let s={},i={registry:t,uri:e?.uri,defs:o};for(let a of t._idmap.entries()){let[c,u]=a;s[c]=n.emit(u,{...e,external:i})}if(Object.keys(o).length>0){let a=n.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[a]:o}}return{schemas:s}}let r=new Fo(e);return r.process(t),r.emit(t,e)}function _e(t,e){let r=e??{seen:new Set};if(r.seen.has(t))return!1;r.seen.add(t);let o=t._zod.def;switch(o.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return _e(o.element,r);case"object":{for(let s in o.shape)if(_e(o.shape[s],r))return!0;return!1}case"union":{for(let s of o.options)if(_e(s,r))return!0;return!1}case"intersection":return _e(o.left,r)||_e(o.right,r);case"tuple":{for(let s of o.items)if(_e(s,r))return!0;return!!(o.rest&&_e(o.rest,r))}case"record":return _e(o.keyType,r)||_e(o.valueType,r);case"map":return _e(o.keyType,r)||_e(o.valueType,r);case"set":return _e(o.valueType,r);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return _e(o.innerType,r);case"lazy":return _e(o.getter(),r);case"default":return _e(o.innerType,r);case"prefault":return _e(o.innerType,r);case"custom":return!1;case"transform":return!0;case"pipe":return _e(o.in,r)||_e(o.out,r);case"success":return!1;case"catch":return!1;default:}throw new Error(`Unknown schema type: ${o.type}`)}var mv=_("ZodMiniType",(t,e)=>{if(!t._zod)throw new Error("Uninitialized schema in ZodMiniType.");ee.init(t,e),t.def=e,t.parse=(r,n)=>Oi(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>_r(t,r,n),t.parseAsync=async(r,n)=>Ni(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>vr(t,r,n),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Fe(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t))});var hv=_("ZodMiniObject",(t,e)=>{jo.init(t,e),mv.init(t,e),B.defineLazy(t,"shape",()=>e.shape)});function gc(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new hv(r)}function Ge(t){return!!t._zod}function $r(t){let e=Object.values(t);if(e.length===0)return gc({});let r=e.every(Ge),n=e.every(o=>!Ge(o));if(r)return gc(t);if(n)return vi(t);throw new Error("Mixed Zod versions detected in object shape.")}function qt(t,e){return Ge(t)?_r(t,e):t.safeParse(e)}async function Ho(t,e){return Ge(t)?await vr(t,e):await t.safeParseAsync(e)}function Lt(t){if(!t)return;let e;if(Ge(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function Hr(t){if(t){if(typeof t=="object"){let e=t,r=t;if(!e._def&&!r._zod){let n=Object.values(t);if(n.length>0&&n.every(o=>typeof o=="object"&&o!==null&&(o._def!==void 0||o._zod!==void 0||typeof o.parse=="function")))return $r(t)}}if(Ge(t)){let r=t._zod?.def;if(r&&(r.type==="object"||r.shape!==void 0))return t}else if(t.shape!==void 0)return t}}function Bo(t){if(t&&typeof t=="object"){if("message"in t&&typeof t.message=="string")return t.message;if("issues"in t&&Array.isArray(t.issues)&&t.issues.length>0){let e=t.issues[0];if(e&&typeof e=="object"&&"message"in e)return String(e.message)}try{return JSON.stringify(t)}catch{return String(t)}}return String(t)}function wp(t){return t.description}function kp(t){if(Ge(t))return t._zod?.def?.type==="optional";let e=t;return typeof t.isOptional=="function"?t.isOptional():e._def?.typeName==="ZodOptional"}function Ko(t){if(Ge(t)){let s=t._zod?.def;if(s){if(s.value!==void 0)return s.value;if(Array.isArray(s.values)&&s.values.length>0)return s.values[0]}}let r=t._def;if(r){if(r.value!==void 0)return r.value;if(Array.isArray(r.values)&&r.values.length>0)return r.values[0]}let n=t.value;if(n!==void 0)return n}var Cn={};mi(Cn,{ZodISODate:()=>zp,ZodISODateTime:()=>Sp,ZodISODuration:()=>Pp,ZodISOTime:()=>Tp,date:()=>_c,datetime:()=>yc,duration:()=>xc,time:()=>vc});var Sp=_("ZodISODateTime",(t,e)=>{lp.init(t,e),ce.init(t,e)});function yc(t){return yp(Sp,t)}var zp=_("ZodISODate",(t,e)=>{dp.init(t,e),ce.init(t,e)});function _c(t){return _p(zp,t)}var Tp=_("ZodISOTime",(t,e)=>{pp.init(t,e),ce.init(t,e)});function vc(t){return vp(Tp,t)}var Pp=_("ZodISODuration",(t,e)=>{fp.init(t,e),ce.init(t,e)});function xc(t){return xp(Pp,t)}var Ep=(t,e)=>{Ro.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>Ri(t,r)},flatten:{value:r=>Ii(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},PP=_("ZodError",Ep),On=_("ZodError",Ep,{Parent:Error});var Ip=Ci(On),Rp=Zi(On),Cp=ji(On),Op=Ai(On);var fe=_("ZodType",(t,e)=>(ee.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Fe(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>Ip(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Cp(t,r,n),t.parseAsync=async(r,n)=>Rp(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>Op(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(px(r,n)),t.superRefine=r=>t.check(fx(r)),t.overwrite=r=>t.check(xr(r)),t.optional=()=>pe(t),t.nullable=()=>jp(t),t.nullish=()=>pe(jp(t)),t.nonoptional=r=>sx(t,r),t.array=()=>K(t),t.or=r=>se([t,r]),t.and=r=>Go(t,r),t.transform=r=>$c(t,Lp(r)),t.default=r=>rx(t,r),t.prefault=r=>ox(t,r),t.catch=r=>ax(t,r),t.pipe=r=>$c(t,r),t.readonly=()=>lx(t),t.describe=r=>{let n=t.clone();return Dt.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return Dt.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return Dt.get(t);let n=t.clone();return Dt.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Ap=_("_ZodString",(t,e)=>{Pn.init(t,e),fe.init(t,e);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(nc(...n)),t.includes=(...n)=>t.check(ic(...n)),t.startsWith=(...n)=>t.check(ac(...n)),t.endsWith=(...n)=>t.check(cc(...n)),t.min=(...n)=>t.check(Fr(...n)),t.max=(...n)=>t.check(Uo(...n)),t.length=(...n)=>t.check(Vo(...n)),t.nonempty=(...n)=>t.check(Fr(1,...n)),t.lowercase=n=>t.check(oc(n)),t.uppercase=n=>t.check(sc(n)),t.trim=()=>t.check(lc()),t.normalize=(...n)=>t.check(uc(...n)),t.toLowerCase=()=>t.check(dc()),t.toUpperCase=()=>t.check(pc())}),kv=_("ZodString",(t,e)=>{Pn.init(t,e),Ap.init(t,e),t.email=r=>t.check(Ia(Sv,r)),t.url=r=>t.check(Na(zv,r)),t.jwt=r=>t.check(Wa(Lv,r)),t.emoji=r=>t.check(ja(Tv,r)),t.guid=r=>t.check(Mo(Zp,r)),t.uuid=r=>t.check(Ra(Jo,r)),t.uuidv4=r=>t.check(Ca(Jo,r)),t.uuidv6=r=>t.check(Oa(Jo,r)),t.uuidv7=r=>t.check(Za(Jo,r)),t.nanoid=r=>t.check(Aa(Pv,r)),t.guid=r=>t.check(Mo(Zp,r)),t.cuid=r=>t.check(Ma(Ev,r)),t.cuid2=r=>t.check(Da(Iv,r)),t.ulid=r=>t.check(qa(Rv,r)),t.base64=r=>t.check(Ka(Mv,r)),t.base64url=r=>t.check(Ja(Dv,r)),t.xid=r=>t.check(La(Cv,r)),t.ksuid=r=>t.check(Ua(Ov,r)),t.ipv4=r=>t.check(Va(Zv,r)),t.ipv6=r=>t.check(Fa(Nv,r)),t.cidrv4=r=>t.check(Ha(jv,r)),t.cidrv6=r=>t.check(Ba(Av,r)),t.e164=r=>t.check(Ga(qv,r)),t.datetime=r=>t.check(yc(r)),t.date=r=>t.check(_c(r)),t.time=r=>t.check(vc(r)),t.duration=r=>t.check(xc(r))});function y(t){return Ea(kv,t)}var ce=_("ZodStringFormat",(t,e)=>{oe.init(t,e),Ap.init(t,e)}),Sv=_("ZodEmail",(t,e)=>{Hi.init(t,e),ce.init(t,e)});var Zp=_("ZodGUID",(t,e)=>{Vi.init(t,e),ce.init(t,e)});var Jo=_("ZodUUID",(t,e)=>{Fi.init(t,e),ce.init(t,e)});var zv=_("ZodURL",(t,e)=>{Bi.init(t,e),ce.init(t,e)});var Tv=_("ZodEmoji",(t,e)=>{Ki.init(t,e),ce.init(t,e)});var Pv=_("ZodNanoID",(t,e)=>{Ji.init(t,e),ce.init(t,e)});var Ev=_("ZodCUID",(t,e)=>{Gi.init(t,e),ce.init(t,e)});var Iv=_("ZodCUID2",(t,e)=>{Wi.init(t,e),ce.init(t,e)});var Rv=_("ZodULID",(t,e)=>{Xi.init(t,e),ce.init(t,e)});var Cv=_("ZodXID",(t,e)=>{Yi.init(t,e),ce.init(t,e)});var Ov=_("ZodKSUID",(t,e)=>{Qi.init(t,e),ce.init(t,e)});var Zv=_("ZodIPv4",(t,e)=>{ea.init(t,e),ce.init(t,e)});var Nv=_("ZodIPv6",(t,e)=>{ta.init(t,e),ce.init(t,e)});var jv=_("ZodCIDRv4",(t,e)=>{ra.init(t,e),ce.init(t,e)});var Av=_("ZodCIDRv6",(t,e)=>{na.init(t,e),ce.init(t,e)});var Mv=_("ZodBase64",(t,e)=>{oa.init(t,e),ce.init(t,e)});var Dv=_("ZodBase64URL",(t,e)=>{sa.init(t,e),ce.init(t,e)});var qv=_("ZodE164",(t,e)=>{ia.init(t,e),ce.init(t,e)});var Lv=_("ZodJWT",(t,e)=>{aa.init(t,e),ce.init(t,e)});var Mp=_("ZodNumber",(t,e)=>{No.init(t,e),fe.init(t,e),t.gt=(n,o)=>t.check(qo(n,o)),t.gte=(n,o)=>t.check(Rn(n,o)),t.min=(n,o)=>t.check(Rn(n,o)),t.lt=(n,o)=>t.check(Do(n,o)),t.lte=(n,o)=>t.check(In(n,o)),t.max=(n,o)=>t.check(In(n,o)),t.int=n=>t.check(Np(n)),t.safe=n=>t.check(Np(n)),t.positive=n=>t.check(qo(0,n)),t.nonnegative=n=>t.check(Rn(0,n)),t.negative=n=>t.check(Do(0,n)),t.nonpositive=n=>t.check(In(0,n)),t.multipleOf=(n,o)=>t.check(Lo(n,o)),t.step=(n,o)=>t.check(Lo(n,o)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function Q(t){return Xa(Mp,t)}var Uv=_("ZodNumberFormat",(t,e)=>{ca.init(t,e),Mp.init(t,e)});function Np(t){return Ya(Uv,t)}var Vv=_("ZodBoolean",(t,e)=>{ua.init(t,e),fe.init(t,e)});function ve(t){return Qa(Vv,t)}var Fv=_("ZodNull",(t,e)=>{la.init(t,e),fe.init(t,e)});function wc(t){return ec(Fv,t)}var Hv=_("ZodUnknown",(t,e)=>{da.init(t,e),fe.init(t,e)});function ue(){return tc(Hv)}var Bv=_("ZodNever",(t,e)=>{pa.init(t,e),fe.init(t,e)});function Kv(t){return rc(Bv,t)}var Jv=_("ZodArray",(t,e)=>{fa.init(t,e),fe.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Fr(r,n)),t.nonempty=r=>t.check(Fr(1,r)),t.max=(r,n)=>t.check(Uo(r,n)),t.length=(r,n)=>t.check(Vo(r,n)),t.unwrap=()=>t.element});function K(t,e){return bp(Jv,t,e)}var Dp=_("ZodObject",(t,e)=>{jo.init(t,e),fe.init(t,e),B.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>Me(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:ue()}),t.loose=()=>t.clone({...t._zod.def,catchall:ue()}),t.strict=()=>t.clone({...t._zod.def,catchall:Kv()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>B.extend(t,r),t.merge=r=>B.merge(t,r),t.pick=r=>B.pick(t,r),t.omit=r=>B.omit(t,r),t.partial=(...r)=>B.partial(Up,t,r[0]),t.required=(...r)=>B.required(Vp,t,r[0])});function P(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new Dp(r)}function Re(t,e){return new Dp({type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},catchall:ue(),...B.normalizeParams(e)})}var qp=_("ZodUnion",(t,e)=>{Ao.init(t,e),fe.init(t,e),t.options=e.options});function se(t,e){return new qp({type:"union",options:t,...B.normalizeParams(e)})}var Gv=_("ZodDiscriminatedUnion",(t,e)=>{qp.init(t,e),ma.init(t,e)});function kc(t,e,r){return new Gv({type:"union",options:e,discriminator:t,...B.normalizeParams(r)})}var Wv=_("ZodIntersection",(t,e)=>{ha.init(t,e),fe.init(t,e)});function Go(t,e){return new Wv({type:"intersection",left:t,right:e})}var Xv=_("ZodRecord",(t,e)=>{ga.init(t,e),fe.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function le(t,e,r){return new Xv({type:"record",keyType:t,valueType:e,...B.normalizeParams(r)})}var bc=_("ZodEnum",(t,e)=>{ya.init(t,e),fe.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,o)=>{let s={};for(let i of n)if(r.has(i))s[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new bc({...e,checks:[],...B.normalizeParams(o),entries:s})},t.exclude=(n,o)=>{let s={...e.entries};for(let i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new bc({...e,checks:[],...B.normalizeParams(o),entries:s})}});function Me(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new bc({type:"enum",entries:r,...B.normalizeParams(e)})}var Yv=_("ZodLiteral",(t,e)=>{_a.init(t,e),fe.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function R(t,e){return new Yv({type:"literal",values:Array.isArray(t)?t:[t],...B.normalizeParams(e)})}var Qv=_("ZodTransform",(t,e)=>{va.init(t,e),fe.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=s=>{if(typeof s=="string")r.issues.push(B.issue(s,r.value,e));else{let i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=t),i.continue??(i.continue=!0),r.issues.push(B.issue(i))}};let o=e.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});function Lp(t){return new Qv({type:"transform",transform:t})}var Up=_("ZodOptional",(t,e)=>{xa.init(t,e),fe.init(t,e),t.unwrap=()=>t._zod.def.innerType});function pe(t){return new Up({type:"optional",innerType:t})}var ex=_("ZodNullable",(t,e)=>{ba.init(t,e),fe.init(t,e),t.unwrap=()=>t._zod.def.innerType});function jp(t){return new ex({type:"nullable",innerType:t})}var tx=_("ZodDefault",(t,e)=>{$a.init(t,e),fe.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function rx(t,e){return new tx({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var nx=_("ZodPrefault",(t,e)=>{wa.init(t,e),fe.init(t,e),t.unwrap=()=>t._zod.def.innerType});function ox(t,e){return new nx({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var Vp=_("ZodNonOptional",(t,e)=>{ka.init(t,e),fe.init(t,e),t.unwrap=()=>t._zod.def.innerType});function sx(t,e){return new Vp({type:"nonoptional",innerType:t,...B.normalizeParams(e)})}var ix=_("ZodCatch",(t,e)=>{Sa.init(t,e),fe.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function ax(t,e){return new ix({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var cx=_("ZodPipe",(t,e)=>{za.init(t,e),fe.init(t,e),t.in=e.in,t.out=e.out});function $c(t,e){return new cx({type:"pipe",in:t,out:e})}var ux=_("ZodReadonly",(t,e)=>{Ta.init(t,e),fe.init(t,e)});function lx(t){return new ux({type:"readonly",innerType:t})}var Fp=_("ZodCustom",(t,e)=>{Pa.init(t,e),fe.init(t,e)});function dx(t){let e=new be({check:"custom"});return e._zod.check=t,e}function Hp(t,e){return fc(Fp,t??(()=>!0),e)}function px(t,e={}){return mc(Fp,t,e)}function fx(t){let e=dx(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(B.issue(n,r.value,e._zod.def));else{let o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=e),o.continue??(o.continue=!e._zod.def.abort),r.issues.push(B.issue(o))}},t(r.value,r)));return e}function Sc(t,e){return $c(Lp(t),e)}Ve(hp());var Tc="2025-11-25";var Bp=[Tc,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Ut="io.modelcontextprotocol/related-task",Xo="2.0",$e=Hp(t=>t!==null&&(typeof t=="object"||typeof t=="function")),Kp=se([y(),Q().int()]),Jp=y(),UP=Re({ttl:se([Q(),wc()]).optional(),pollInterval:Q().optional()}),mx=P({ttl:Q().optional()}),hx=P({taskId:y()}),Pc=Re({progressToken:Kp.optional(),[Ut]:hx.optional()}),He=P({_meta:Pc.optional()}),Zn=He.extend({task:mx.optional()}),Gp=t=>Zn.safeParse(t).success,we=P({method:y(),params:He.loose().optional()}),We=P({_meta:Pc.optional()}),Xe=P({method:y(),params:We.loose().optional()}),ke=Re({_meta:Pc.optional()}),Yo=se([y(),Q().int()]),Wp=P({jsonrpc:R(Xo),id:Yo,...we.shape}).strict(),Ec=t=>Wp.safeParse(t).success,Xp=P({jsonrpc:R(Xo),...Xe.shape}).strict(),Yp=t=>Xp.safeParse(t).success,Ic=P({jsonrpc:R(Xo),id:Yo,result:ke}).strict(),Nn=t=>Ic.safeParse(t).success;var Z;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(Z||(Z={}));var Rc=P({jsonrpc:R(Xo),id:Yo.optional(),error:P({code:Q().int(),message:y(),data:ue().optional()})}).strict();var Qp=t=>Rc.safeParse(t).success;var ef=se([Wp,Xp,Ic,Rc]),VP=se([Ic,Rc]),Qo=ke.strict(),gx=We.extend({requestId:Yo.optional(),reason:y().optional()}),es=Xe.extend({method:R("notifications/cancelled"),params:gx}),yx=P({src:y(),mimeType:y().optional(),sizes:K(y()).optional(),theme:Me(["light","dark"]).optional()}),jn=P({icons:K(yx).optional()}),Br=P({name:y(),title:y().optional()}),tf=Br.extend({...Br.shape,...jn.shape,version:y(),websiteUrl:y().optional(),description:y().optional()}),_x=Go(P({applyDefaults:ve().optional()}),le(y(),ue())),vx=Sc(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,Go(P({form:_x.optional(),url:$e.optional()}),le(y(),ue()).optional())),xx=Re({list:$e.optional(),cancel:$e.optional(),requests:Re({sampling:Re({createMessage:$e.optional()}).optional(),elicitation:Re({create:$e.optional()}).optional()}).optional()}),bx=Re({list:$e.optional(),cancel:$e.optional(),requests:Re({tools:Re({call:$e.optional()}).optional()}).optional()}),$x=P({experimental:le(y(),$e).optional(),sampling:P({context:$e.optional(),tools:$e.optional()}).optional(),elicitation:vx.optional(),roots:P({listChanged:ve().optional()}).optional(),tasks:xx.optional()}),wx=He.extend({protocolVersion:y(),capabilities:$x,clientInfo:tf}),Cc=we.extend({method:R("initialize"),params:wx});var kx=P({experimental:le(y(),$e).optional(),logging:$e.optional(),completions:$e.optional(),prompts:P({listChanged:ve().optional()}).optional(),resources:P({subscribe:ve().optional(),listChanged:ve().optional()}).optional(),tools:P({listChanged:ve().optional()}).optional(),tasks:bx.optional()}),Sx=ke.extend({protocolVersion:y(),capabilities:kx,serverInfo:tf,instructions:y().optional()}),Oc=Xe.extend({method:R("notifications/initialized"),params:We.optional()});var ts=we.extend({method:R("ping"),params:He.optional()}),zx=P({progress:Q(),total:pe(Q()),message:pe(y())}),Tx=P({...We.shape,...zx.shape,progressToken:Kp}),rs=Xe.extend({method:R("notifications/progress"),params:Tx}),Px=He.extend({cursor:Jp.optional()}),An=we.extend({params:Px.optional()}),Mn=ke.extend({nextCursor:Jp.optional()}),Ex=Me(["working","input_required","completed","failed","cancelled"]),Dn=P({taskId:y(),status:Ex,ttl:se([Q(),wc()]),createdAt:y(),lastUpdatedAt:y(),pollInterval:pe(Q()),statusMessage:pe(y())}),Kr=ke.extend({task:Dn}),Ix=We.merge(Dn),qn=Xe.extend({method:R("notifications/tasks/status"),params:Ix}),ns=we.extend({method:R("tasks/get"),params:He.extend({taskId:y()})}),os=ke.merge(Dn),ss=we.extend({method:R("tasks/result"),params:He.extend({taskId:y()})}),FP=ke.loose(),is=An.extend({method:R("tasks/list")}),as=Mn.extend({tasks:K(Dn)}),cs=we.extend({method:R("tasks/cancel"),params:He.extend({taskId:y()})}),rf=ke.merge(Dn),nf=P({uri:y(),mimeType:pe(y()),_meta:le(y(),ue()).optional()}),of=nf.extend({text:y()}),Zc=y().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),sf=nf.extend({blob:Zc}),Ln=Me(["user","assistant"]),Jr=P({audience:K(Ln).optional(),priority:Q().min(0).max(1).optional(),lastModified:Cn.datetime({offset:!0}).optional()}),af=P({...Br.shape,...jn.shape,uri:y(),description:pe(y()),mimeType:pe(y()),annotations:Jr.optional(),_meta:pe(Re({}))}),Rx=P({...Br.shape,...jn.shape,uriTemplate:y(),description:pe(y()),mimeType:pe(y()),annotations:Jr.optional(),_meta:pe(Re({}))}),us=An.extend({method:R("resources/list")}),Cx=Mn.extend({resources:K(af)}),ls=An.extend({method:R("resources/templates/list")}),Ox=Mn.extend({resourceTemplates:K(Rx)}),Nc=He.extend({uri:y()}),Zx=Nc,ds=we.extend({method:R("resources/read"),params:Zx}),Nx=ke.extend({contents:K(se([of,sf]))}),jx=Xe.extend({method:R("notifications/resources/list_changed"),params:We.optional()}),Ax=Nc,Mx=we.extend({method:R("resources/subscribe"),params:Ax}),Dx=Nc,qx=we.extend({method:R("resources/unsubscribe"),params:Dx}),Lx=We.extend({uri:y()}),Ux=Xe.extend({method:R("notifications/resources/updated"),params:Lx}),Vx=P({name:y(),description:pe(y()),required:pe(ve())}),Fx=P({...Br.shape,...jn.shape,description:pe(y()),arguments:pe(K(Vx)),_meta:pe(Re({}))}),ps=An.extend({method:R("prompts/list")}),Hx=Mn.extend({prompts:K(Fx)}),Bx=He.extend({name:y(),arguments:le(y(),y()).optional()}),fs=we.extend({method:R("prompts/get"),params:Bx}),jc=P({type:R("text"),text:y(),annotations:Jr.optional(),_meta:le(y(),ue()).optional()}),Ac=P({type:R("image"),data:Zc,mimeType:y(),annotations:Jr.optional(),_meta:le(y(),ue()).optional()}),Mc=P({type:R("audio"),data:Zc,mimeType:y(),annotations:Jr.optional(),_meta:le(y(),ue()).optional()}),Kx=P({type:R("tool_use"),name:y(),id:y(),input:le(y(),ue()),_meta:le(y(),ue()).optional()}),Jx=P({type:R("resource"),resource:se([of,sf]),annotations:Jr.optional(),_meta:le(y(),ue()).optional()}),Gx=af.extend({type:R("resource_link")}),Dc=se([jc,Ac,Mc,Gx,Jx]),Wx=P({role:Ln,content:Dc}),Xx=ke.extend({description:y().optional(),messages:K(Wx)}),Yx=Xe.extend({method:R("notifications/prompts/list_changed"),params:We.optional()}),Qx=P({title:y().optional(),readOnlyHint:ve().optional(),destructiveHint:ve().optional(),idempotentHint:ve().optional(),openWorldHint:ve().optional()}),eb=P({taskSupport:Me(["required","optional","forbidden"]).optional()}),cf=P({...Br.shape,...jn.shape,description:y().optional(),inputSchema:P({type:R("object"),properties:le(y(),$e).optional(),required:K(y()).optional()}).catchall(ue()),outputSchema:P({type:R("object"),properties:le(y(),$e).optional(),required:K(y()).optional()}).catchall(ue()).optional(),annotations:Qx.optional(),execution:eb.optional(),_meta:le(y(),ue()).optional()}),ms=An.extend({method:R("tools/list")}),tb=Mn.extend({tools:K(cf)}),hs=ke.extend({content:K(Dc).default([]),structuredContent:le(y(),ue()).optional(),isError:ve().optional()}),HP=hs.or(ke.extend({toolResult:ue()})),rb=Zn.extend({name:y(),arguments:le(y(),ue()).optional()}),Gr=we.extend({method:R("tools/call"),params:rb}),nb=Xe.extend({method:R("notifications/tools/list_changed"),params:We.optional()}),BP=P({autoRefresh:ve().default(!0),debounceMs:Q().int().nonnegative().default(300)}),Un=Me(["debug","info","notice","warning","error","critical","alert","emergency"]),ob=He.extend({level:Un}),qc=we.extend({method:R("logging/setLevel"),params:ob}),sb=We.extend({level:Un,logger:y().optional(),data:ue()}),ib=Xe.extend({method:R("notifications/message"),params:sb}),ab=P({name:y().optional()}),cb=P({hints:K(ab).optional(),costPriority:Q().min(0).max(1).optional(),speedPriority:Q().min(0).max(1).optional(),intelligencePriority:Q().min(0).max(1).optional()}),ub=P({mode:Me(["auto","required","none"]).optional()}),lb=P({type:R("tool_result"),toolUseId:y().describe("The unique identifier for the corresponding tool call."),content:K(Dc).default([]),structuredContent:P({}).loose().optional(),isError:ve().optional(),_meta:le(y(),ue()).optional()}),db=kc("type",[jc,Ac,Mc]),Wo=kc("type",[jc,Ac,Mc,Kx,lb]),pb=P({role:Ln,content:se([Wo,K(Wo)]),_meta:le(y(),ue()).optional()}),fb=Zn.extend({messages:K(pb),modelPreferences:cb.optional(),systemPrompt:y().optional(),includeContext:Me(["none","thisServer","allServers"]).optional(),temperature:Q().optional(),maxTokens:Q().int(),stopSequences:K(y()).optional(),metadata:$e.optional(),tools:K(cf).optional(),toolChoice:ub.optional()}),mb=we.extend({method:R("sampling/createMessage"),params:fb}),Lc=ke.extend({model:y(),stopReason:pe(Me(["endTurn","stopSequence","maxTokens"]).or(y())),role:Ln,content:db}),Uc=ke.extend({model:y(),stopReason:pe(Me(["endTurn","stopSequence","maxTokens","toolUse"]).or(y())),role:Ln,content:se([Wo,K(Wo)])}),hb=P({type:R("boolean"),title:y().optional(),description:y().optional(),default:ve().optional()}),gb=P({type:R("string"),title:y().optional(),description:y().optional(),minLength:Q().optional(),maxLength:Q().optional(),format:Me(["email","uri","date","date-time"]).optional(),default:y().optional()}),yb=P({type:Me(["number","integer"]),title:y().optional(),description:y().optional(),minimum:Q().optional(),maximum:Q().optional(),default:Q().optional()}),_b=P({type:R("string"),title:y().optional(),description:y().optional(),enum:K(y()),default:y().optional()}),vb=P({type:R("string"),title:y().optional(),description:y().optional(),oneOf:K(P({const:y(),title:y()})),default:y().optional()}),xb=P({type:R("string"),title:y().optional(),description:y().optional(),enum:K(y()),enumNames:K(y()).optional(),default:y().optional()}),bb=se([_b,vb]),$b=P({type:R("array"),title:y().optional(),description:y().optional(),minItems:Q().optional(),maxItems:Q().optional(),items:P({type:R("string"),enum:K(y())}),default:K(y()).optional()}),wb=P({type:R("array"),title:y().optional(),description:y().optional(),minItems:Q().optional(),maxItems:Q().optional(),items:P({anyOf:K(P({const:y(),title:y()}))}),default:K(y()).optional()}),kb=se([$b,wb]),Sb=se([xb,bb,kb]),zb=se([Sb,hb,gb,yb]),Tb=Zn.extend({mode:R("form").optional(),message:y(),requestedSchema:P({type:R("object"),properties:le(y(),zb),required:K(y()).optional()})}),Pb=Zn.extend({mode:R("url"),message:y(),elicitationId:y(),url:y().url()}),Eb=se([Tb,Pb]),Ib=we.extend({method:R("elicitation/create"),params:Eb}),Rb=We.extend({elicitationId:y()}),Cb=Xe.extend({method:R("notifications/elicitation/complete"),params:Rb}),gs=ke.extend({action:Me(["accept","decline","cancel"]),content:Sc(t=>t===null?void 0:t,le(y(),se([y(),Q(),ve(),K(y())])).optional())}),Ob=P({type:R("ref/resource"),uri:y()});var Zb=P({type:R("ref/prompt"),name:y()}),Nb=He.extend({ref:se([Zb,Ob]),argument:P({name:y(),value:y()}),context:P({arguments:le(y(),y()).optional()}).optional()}),ys=we.extend({method:R("completion/complete"),params:Nb});function uf(t){if(t.params.ref.type!=="ref/prompt")throw new TypeError(`Expected CompleteRequestPrompt, but got ${t.params.ref.type}`)}function lf(t){if(t.params.ref.type!=="ref/resource")throw new TypeError(`Expected CompleteRequestResourceTemplate, but got ${t.params.ref.type}`)}var jb=ke.extend({completion:Re({values:K(y()).max(100),total:pe(Q().int()),hasMore:pe(ve())})}),Ab=P({uri:y().startsWith("file://"),name:y().optional(),_meta:le(y(),ue()).optional()}),Mb=we.extend({method:R("roots/list"),params:He.optional()}),Vc=ke.extend({roots:K(Ab)}),Db=Xe.extend({method:R("notifications/roots/list_changed"),params:We.optional()}),KP=se([ts,Cc,ys,qc,fs,ps,us,ls,ds,Mx,qx,Gr,ms,ns,ss,is,cs]),JP=se([es,rs,Oc,Db,qn]),GP=se([Qo,Lc,Uc,gs,Vc,os,as,Kr]),WP=se([ts,mb,Ib,Mb,ns,ss,is,cs]),XP=se([es,rs,ib,Ux,jx,nb,Yx,qn,Cb]),YP=se([Qo,Sx,jb,Xx,Hx,Cx,Ox,Nx,hs,tb,os,as,Kr]),I=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===Z.UrlElicitationRequired&&n){let o=n;if(o.elicitations)return new zc(o.elicitations,r)}return new t(e,r,n)}},zc=class extends I{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(Z.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}};function Vt(t){return t==="completed"||t==="failed"||t==="cancelled"}var pf=Symbol("Let zodToJsonSchema decide on which parser to use");var df={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},ff=t=>typeof t=="string"?{...df,name:t}:{...df,...t};var mf=t=>{let e=ff(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,o])=>[o._def,{def:o._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Fc(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function J(t,e,r,n,o){t[e]=r,Fc(t,e,n,o)}var _s=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")};function de(t){if(t.target!=="openAi")return{};let e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?_s(e,t.currentPath):e.join("/")}}function hf(t,e){let r={type:"array"};return t.type?._def&&t.type?._def?.typeName!==$.ZodAny&&(r.items=A(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&J(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&J(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(J(r,"minItems",t.exactLength.value,t.exactLength.message,e),J(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function gf(t,e){let r={type:"integer",format:"int64"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?J(r,"minimum",n.value,n.message,e):J(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),J(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?J(r,"maximum",n.value,n.message,e):J(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),J(r,"maximum",n.value,n.message,e));break;case"multipleOf":J(r,"multipleOf",n.value,n.message,e);break}return r}function yf(){return{type:"boolean"}}function vs(t,e){return A(t.type._def,e)}var _f=(t,e)=>A(t.innerType._def,e);function Hc(t,e,r){let n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((o,s)=>Hc(t,e,o))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return qb(t,e)}}var qb=(t,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let n of t.checks)switch(n.kind){case"min":J(r,"minimum",n.value,n.message,e);break;case"max":J(r,"maximum",n.value,n.message,e);break}return r};function vf(t,e){return{...A(t.innerType._def,e),default:t.defaultValue()}}function xf(t,e){return e.effectStrategy==="input"?A(t.schema._def,e):de(e)}function bf(t){return{type:"string",enum:Array.from(t.values)}}var Lb=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function $f(t,e){let r=[A(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),A(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,o=[];return r.forEach(s=>{if(Lb(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else{let i=s;if("additionalProperties"in s&&s.additionalProperties===!1){let{additionalProperties:a,...c}=s;i=c}else n=void 0;o.push(i)}}),o.length?{allOf:o,...n}:void 0}function wf(t,e){let r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}var Bc,ot={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Bc===void 0&&(Bc=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Bc),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function xs(t,e){let r={type:"string"};if(t.checks)for(let n of t.checks)switch(n.kind){case"min":J(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e);break;case"max":J(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":st(r,"email",n.message,e);break;case"format:idn-email":st(r,"idn-email",n.message,e);break;case"pattern:zod":Ce(r,ot.email,n.message,e);break}break;case"url":st(r,"uri",n.message,e);break;case"uuid":st(r,"uuid",n.message,e);break;case"regex":Ce(r,n.regex,n.message,e);break;case"cuid":Ce(r,ot.cuid,n.message,e);break;case"cuid2":Ce(r,ot.cuid2,n.message,e);break;case"startsWith":Ce(r,RegExp(`^${Kc(n.value,e)}`),n.message,e);break;case"endsWith":Ce(r,RegExp(`${Kc(n.value,e)}$`),n.message,e);break;case"datetime":st(r,"date-time",n.message,e);break;case"date":st(r,"date",n.message,e);break;case"time":st(r,"time",n.message,e);break;case"duration":st(r,"duration",n.message,e);break;case"length":J(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e),J(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"includes":{Ce(r,RegExp(Kc(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&st(r,"ipv4",n.message,e),n.version!=="v4"&&st(r,"ipv6",n.message,e);break}case"base64url":Ce(r,ot.base64url,n.message,e);break;case"jwt":Ce(r,ot.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&Ce(r,ot.ipv4Cidr,n.message,e),n.version!=="v4"&&Ce(r,ot.ipv6Cidr,n.message,e);break}case"emoji":Ce(r,ot.emoji(),n.message,e);break;case"ulid":{Ce(r,ot.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{st(r,"binary",n.message,e);break}case"contentEncoding:base64":{J(r,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{Ce(r,ot.base64,n.message,e);break}}break}case"nanoid":Ce(r,ot.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function Kc(t,e){return e.patternStrategy==="escape"?Vb(t):t}var Ub=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Vb(t){let e="";for(let r=0;r<t.length;r++)Ub.has(t[r])||(e+="\\"),e+=t[r];return e}function st(t,e,r,n){t.format||t.anyOf?.some(o=>o.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):J(t,"format",e,r,n)}function Ce(t,e,r,n){t.pattern||t.allOf?.some(o=>o.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:kf(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):J(t,"pattern",kf(e,n),r,n)}function kf(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;let r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},n=r.i?t.source.toLowerCase():t.source,o="",s=!1,i=!1,a=!1;for(let c=0;c<n.length;c++){if(s){o+=n[c],s=!1;continue}if(r.i){if(i){if(n[c].match(/[a-z]/)){a?(o+=n[c],o+=`${n[c-2]}-${n[c]}`.toUpperCase(),a=!1):n[c+1]==="-"&&n[c+2]?.match(/[a-z]/)?(o+=n[c],a=!0):o+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){o+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(r.m){if(n[c]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&n[c]==="."){o+=i?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}o+=n[c],n[c]==="\\"?s=!0:i&&n[c]==="]"?i=!1:!i&&n[c]==="["&&(i=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return o}function bs(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===$.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((n,o)=>({...n,[o]:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",o]})??de(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let r={type:"object",additionalProperties:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===$.ZodString&&t.keyType._def.checks?.length){let{type:n,...o}=xs(t.keyType._def,e);return{...r,propertyNames:o}}else{if(t.keyType?._def.typeName===$.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===$.ZodBranded&&t.keyType._def.type._def.typeName===$.ZodString&&t.keyType._def.type._def.checks?.length){let{type:n,...o}=vs(t.keyType._def,e);return{...r,propertyNames:o}}}return r}function Sf(t,e){if(e.mapStrategy==="record")return bs(t,e);let r=A(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||de(e),n=A(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||de(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function zf(t){let e=t.values,n=Object.keys(t.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),o=Array.from(new Set(n.map(s=>typeof s)));return{type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:n}}function Tf(t){return t.target==="openAi"?void 0:{not:de({...t,currentPath:[...t.currentPath,"not"]})}}function Pf(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Vn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function If(t,e){if(e.target==="openApi3")return Ef(t,e);let r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in Vn&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((o,s)=>{let i=Vn[s._def.typeName];return i&&!o.includes(i)?[...o,i]:o},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((o,s)=>{let i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...o,i];case"bigint":return[...o,"integer"];case"object":if(s._def.value===null)return[...o,"null"];default:return o}},[]);if(n.length===r.length){let o=n.filter((s,i,a)=>a.indexOf(s)===i);return{type:o.length>1?o:o[0],enum:r.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,o)=>[...n,...o._def.values.filter(s=>!n.includes(s))],[])};return Ef(t,e)}var Ef=(t,e)=>{let r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,o)=>A(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${o}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function Rf(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Vn[t.innerType._def.typeName],nullable:!0}:{type:[Vn[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=A(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let r=A(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function Cf(t,e){let r={type:"number"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"int":r.type="integer",Fc(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?J(r,"minimum",n.value,n.message,e):J(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),J(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?J(r,"maximum",n.value,n.message,e):J(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),J(r,"maximum",n.value,n.message,e));break;case"multipleOf":J(r,"multipleOf",n.value,n.message,e);break}return r}function Of(t,e){let r=e.target==="openAi",n={type:"object",properties:{}},o=[],s=t.shape();for(let a in s){let c=s[a];if(c===void 0||c._def===void 0)continue;let u=Hb(c);u&&r&&(c._def.typeName==="ZodOptional"&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);let l=A(c._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});l!==void 0&&(n.properties[a]=l,u||o.push(a))}o.length&&(n.required=o);let i=Fb(t,e);return i!==void 0&&(n.additionalProperties=i),n}function Fb(t,e){if(t.catchall._def.typeName!=="ZodNever")return A(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Hb(t){try{return t.isOptional()}catch{return!0}}var Zf=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return A(t.innerType._def,e);let r=A(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:de(e)},r]}:de(e)};var Nf=(t,e)=>{if(e.pipeStrategy==="input")return A(t.in._def,e);if(e.pipeStrategy==="output")return A(t.out._def,e);let r=A(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=A(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(o=>o!==void 0)}};function jf(t,e){return A(t.type._def,e)}function Af(t,e){let n={type:"array",uniqueItems:!0,items:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&J(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&J(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function Mf(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>A(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:A(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>A(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function Df(t){return{not:de(t)}}function qf(t){return de(t)}var Lf=(t,e)=>A(t.innerType._def,e);var Uf=(t,e,r)=>{switch(e){case $.ZodString:return xs(t,r);case $.ZodNumber:return Cf(t,r);case $.ZodObject:return Of(t,r);case $.ZodBigInt:return gf(t,r);case $.ZodBoolean:return yf();case $.ZodDate:return Hc(t,r);case $.ZodUndefined:return Df(r);case $.ZodNull:return Pf(r);case $.ZodArray:return hf(t,r);case $.ZodUnion:case $.ZodDiscriminatedUnion:return If(t,r);case $.ZodIntersection:return $f(t,r);case $.ZodTuple:return Mf(t,r);case $.ZodRecord:return bs(t,r);case $.ZodLiteral:return wf(t,r);case $.ZodEnum:return bf(t);case $.ZodNativeEnum:return zf(t);case $.ZodNullable:return Rf(t,r);case $.ZodOptional:return Zf(t,r);case $.ZodMap:return Sf(t,r);case $.ZodSet:return Af(t,r);case $.ZodLazy:return()=>t.getter()._def;case $.ZodPromise:return jf(t,r);case $.ZodNaN:case $.ZodNever:return Tf(r);case $.ZodEffects:return xf(t,r);case $.ZodAny:return de(r);case $.ZodUnknown:return qf(r);case $.ZodDefault:return vf(t,r);case $.ZodBranded:return vs(t,r);case $.ZodReadonly:return Lf(t,r);case $.ZodCatch:return _f(t,r);case $.ZodPipeline:return Nf(t,r);case $.ZodFunction:case $.ZodVoid:case $.ZodSymbol:return;default:return(n=>{})(e)}};function A(t,e,r=!1){let n=e.seen.get(t);if(e.override){let a=e.override?.(t,e,n,r);if(a!==pf)return a}if(n&&!r){let a=Bb(n,e);if(a!==void 0)return a}let o={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,o);let s=Uf(t,t.typeName,e),i=typeof s=="function"?A(s(),e):s;if(i&&Kb(t,e,i),e.postProcess){let a=e.postProcess(i,t,e);return o.jsonSchema=i,a}return o.jsonSchema=i,i}var Bb=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:_s(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),de(e)):e.$refStrategy==="seen"?de(e):void 0}},Kb=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r);var Jc=(t,e)=>{let r=mf(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((c,[u,l])=>({...c,[u]:A(l._def,{...r,currentPath:[...r.basePath,r.definitionPath,u]},!0)??de(r)}),{}):void 0,o=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=A(t._def,o===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,o]},!1)??de(r),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(s.title=i),r.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[r.openAiAnyTypeName]||(n[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let a=o===void 0?n?{...s,[r.definitionPath]:n}:s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:{...n,[o]:s}};return r.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a};function Jb(t){return!t||t==="jsonSchema7"||t==="draft-7"?"draft-7":t==="jsonSchema2019-09"||t==="draft-2020-12"?"draft-2020-12":"draft-7"}function Gc(t,e){return Ge(t)?hc(t,{target:Jb(e?.target),io:e?.pipeStrategy??"input"}):Jc(t,{strictUnions:e?.strictUnions??!0,pipeStrategy:e?.pipeStrategy??"input"})}function Wc(t){let r=Lt(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Ko(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function Xc(t,e){let r=qt(t,e);if(!r.success)throw r.error;return r.data}var Gb=6e4,$s=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(es,r=>{this._oncancel(r)}),this.setNotificationHandler(rs,r=>{this._onprogress(r)}),this.setRequestHandler(ts,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(ns,async(r,n)=>{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new I(Z.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(ss,async(r,n)=>{let o=async()=>{let s=r.params.taskId;if(this._taskMessageQueue){let a;for(;a=await this._taskMessageQueue.dequeue(s,n.sessionId);){if(a.type==="response"||a.type==="error"){let c=a.message,u=c.id,l=this._requestResolvers.get(u);if(l)if(this._requestResolvers.delete(u),a.type==="response")l(c);else{let d=c,h=new I(d.error.code,d.error.message,d.error.data);l(h)}else{let d=a.type==="response"?"Response":"Error";this._onerror(new Error(`${d} handler missing for request ${u}`))}continue}await this._transport?.send(a.message,{relatedRequestId:n.requestId})}}let i=await this._taskStore.getTask(s,n.sessionId);if(!i)throw new I(Z.InvalidParams,`Task not found: ${s}`);if(!Vt(i.status))return await this._waitForTaskUpdate(s,n.signal),await o();if(Vt(i.status)){let a=await this._taskStore.getTaskResult(s,n.sessionId);return this._clearTaskQueue(s),{...a,_meta:{...a._meta,[Ut]:{taskId:s}}}}return await o()};return await o()}),this.setRequestHandler(is,async(r,n)=>{try{let{tasks:o,nextCursor:s}=await this._taskStore.listTasks(r.params?.cursor,n.sessionId);return{tasks:o,nextCursor:s,_meta:{}}}catch(o){throw new I(Z.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(cs,async(r,n)=>{try{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new I(Z.InvalidParams,`Task not found: ${r.params.taskId}`);if(Vt(o.status))throw new I(Z.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new I(Z.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof I?o:new I(Z.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.abort(e.params.reason)}_setupTimeout(e,r,n,o,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),I.fromError(Z.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){if(this._transport)throw new Error("Already connected to a transport. Call close() before connecting to a new transport, or use a separate Protocol instance per connection.");this._transport=e;let r=this.transport?.onclose;this._transport.onclose=()=>{r?.(),this._onclose()};let n=this.transport?.onerror;this._transport.onerror=s=>{n?.(s),this._onerror(s)};let o=this._transport?.onmessage;this._transport.onmessage=(s,i)=>{o?.(s,i),Nn(s)||Qp(s)?this._onresponse(s):Ec(s)?this._onrequest(s,i):Yp(s)?this._onnotification(s):this._onerror(new Error(`Unknown message type: ${JSON.stringify(s)}`))},await this._transport.start()}_onclose(){let e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();for(let n of this._requestHandlerAbortControllers.values())n.abort();this._requestHandlerAbortControllers.clear();let r=I.fromError(Z.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let n of e.values())n(r)}_onerror(e){this.onerror?.(e)}_onnotification(e){let r=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;r!==void 0&&Promise.resolve().then(()=>r(e)).catch(n=>this._onerror(new Error(`Uncaught error in notification handler: ${n}`)))}_onrequest(e,r){let n=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,o=this._transport,s=e.params?._meta?.[Ut]?.taskId;if(n===void 0){let l={jsonrpc:"2.0",id:e.id,error:{code:Z.MethodNotFound,message:"Method not found"}};s&&this._taskMessageQueue?this._enqueueTaskMessage(s,{type:"error",message:l,timestamp:Date.now()},o?.sessionId).catch(d=>this._onerror(new Error(`Failed to enqueue error response: ${d}`))):o?.send(l).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);let a=Gp(e.params)?e.params.task:void 0,c=this._taskStore?this.requestTaskStore(e,o?.sessionId):void 0,u={signal:i.signal,sessionId:o?.sessionId,_meta:e.params?._meta,sendNotification:async l=>{if(i.signal.aborted)return;let d={relatedRequestId:e.id};s&&(d.relatedTask={taskId:s}),await this.notification(l,d)},sendRequest:async(l,d,h)=>{if(i.signal.aborted)throw new I(Z.ConnectionClosed,"Request was cancelled");let f={...h,relatedRequestId:e.id};s&&!f.relatedTask&&(f.relatedTask={taskId:s});let p=f.relatedTask?.taskId??s;return p&&c&&await c.updateTaskStatus(p,"input_required"),await this.request(l,d,f)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:s,taskStore:c,taskRequestedTtl:a?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{a&&this.assertTaskHandlerCapability(e.method)}).then(()=>n(e,u)).then(async l=>{if(i.signal.aborted)return;let d={result:l,jsonrpc:"2.0",id:e.id};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"response",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)},async l=>{if(i.signal.aborted)return;let d={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(l.code)?l.code:Z.InternalError,message:l.message??"Internal error",...l.data!==void 0&&{data:l.data}}};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"error",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)}).catch(l=>this._onerror(new Error(`Failed to send response: ${l}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,o=Number(r),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),i(c);return}s(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),Nn(e))n(e);else{let i=new I(e.error.code,e.error.message,e.error.data);n(i)}return}let o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let s=!1;if(Nn(e)&&e.result&&typeof e.result=="object"){let i=e.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(s=!0,this._taskProgressTokens.set(a.taskId,r))}}if(s||this._progressHandlers.delete(r),Nn(e))o(e);else{let i=I.fromError(e.error.code,e.error.message,e.error.data);o(i)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(e,r,n){let{task:o}=n??{};if(!o){try{yield{type:"result",result:await this.request(e,r,n)}}catch(i){yield{type:"error",error:i instanceof I?i:new I(Z.InternalError,String(i))}}return}let s;try{let i=await this.request(e,Kr,n);if(i.task)s=i.task.taskId,yield{type:"taskCreated",task:i.task};else throw new I(Z.InternalError,"Task creation did not return a task");for(;;){let a=await this.getTask({taskId:s},n);if(yield{type:"taskStatus",task:a},Vt(a.status)){a.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)}:a.status==="failed"?yield{type:"error",error:new I(Z.InternalError,`Task ${s} failed`)}:a.status==="cancelled"&&(yield{type:"error",error:new I(Z.InternalError,`Task ${s} was cancelled`)});return}if(a.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)};return}let c=a.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(u=>setTimeout(u,c)),n?.signal?.throwIfAborted()}}catch(i){yield{type:"error",error:i instanceof I?i:new I(Z.InternalError,String(i))}}}request(e,r,n){let{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{let d=x=>{l(x)};if(!this._transport){d(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(x){d(x);return}n?.signal?.throwIfAborted();let h=this._requestMessageId++,f={...e,jsonrpc:"2.0",id:h};n?.onprogress&&(this._progressHandlers.set(h,n.onprogress),f.params={...e.params,_meta:{...e.params?._meta||{},progressToken:h}}),a&&(f.params={...f.params,task:a}),c&&(f.params={...f.params,_meta:{...f.params?._meta||{},[Ut]:c}});let p=x=>{this._responseHandlers.delete(h),this._progressHandlers.delete(h),this._cleanupTimeout(h),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:h,reason:String(x)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(k=>this._onerror(new Error(`Failed to send cancellation: ${k}`)));let w=x instanceof I?x:new I(Z.RequestTimeout,String(x));l(w)};this._responseHandlers.set(h,x=>{if(!n?.signal?.aborted){if(x instanceof Error)return l(x);try{let w=qt(r,x.result);w.success?u(w.data):l(w.error)}catch(w){l(w)}}}),n?.signal?.addEventListener("abort",()=>{p(n?.signal?.reason)});let m=n?.timeout??Gb,g=()=>p(I.fromError(Z.RequestTimeout,"Request timed out",{timeout:m}));this._setupTimeout(h,m,n?.maxTotalTimeout,g,n?.resetTimeoutOnProgress??!1);let v=c?.taskId;if(v){let x=w=>{let k=this._responseHandlers.get(h);k?k(w):this._onerror(new Error(`Response handler missing for side-channeled request ${h}`))};this._requestResolvers.set(h,x),this._enqueueTaskMessage(v,{type:"request",message:f,timestamp:Date.now()}).catch(w=>{this._cleanupTimeout(h),l(w)})}else this._transport.send(f,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(x=>{this._cleanupTimeout(h),l(x)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},os,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},as,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},rf,r)}async notification(e,r){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let n=r?.relatedTask?.taskId;if(n){let a={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Ut]:r.relatedTask}}};await this._enqueueTaskMessage(n,{type:"notification",message:a,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let a={...e,jsonrpc:"2.0"};r?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[Ut]:r.relatedTask}}}),this._transport?.send(a,r).catch(c=>this._onerror(c))});return}let i={...e,jsonrpc:"2.0"};r?.relatedTask&&(i={...i,params:{...i.params,_meta:{...i.params?._meta||{},[Ut]:r.relatedTask}}}),await this._transport.send(i,r)}setRequestHandler(e,r){let n=Wc(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,s)=>{let i=Xc(e,o);return Promise.resolve(r(i,s))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=Wc(e);this._notificationHandlers.set(n,o=>{let s=Xc(e,o);return Promise.resolve(r(s))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let o of n)if(o.type==="request"&&Ec(o.message)){let s=o.message.id,i=this._requestResolvers.get(s);i?(i(new I(Z.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){let n=this._options?.defaultTaskPollInterval??1e3;try{let o=await this._taskStore?.getTask(e);o?.pollInterval&&(n=o.pollInterval)}catch{}return new Promise((o,s)=>{if(r.aborted){s(new I(Z.InvalidRequest,"Request cancelled"));return}let i=setTimeout(o,n);r.addEventListener("abort",()=>{clearTimeout(i),s(new I(Z.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!e)throw new Error("No request provided");return await n.createTask(o,e.id,{method:e.method,params:e.params},r)},getTask:async o=>{let s=await n.getTask(o,r);if(!s)throw new I(Z.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,i)=>{await n.storeTaskResult(o,s,i,r);let a=await n.getTask(o,r);if(a){let c=qn.parse({method:"notifications/tasks/status",params:a});await this.notification(c),Vt(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,s,i)=>{let a=await n.getTask(o,r);if(!a)throw new I(Z.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(Vt(a.status))throw new I(Z.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,s,i,r);let c=await n.getTask(o,r);if(c){let u=qn.parse({method:"notifications/tasks/status",params:c});await this.notification(u),Vt(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}};function Vf(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Ff(t,e){let r={...t};for(let n in e){let o=n,s=e[o];if(s===void 0)continue;let i=r[o];Vf(i)&&Vf(s)?r[o]={...i,...s}:r[o]=s}return r}var Ig=hi(jl(),1),Rg=hi(Eg(),1);function Dz(){let t=new Ig.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,Rg.default)(t),t}var si=class{constructor(e){this._ajv=e??Dz()}getValidator(e){let r="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return n=>r(n)?{valid:!0,data:n,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(r.errors)}}};var ii=class{constructor(e){this._server=e}requestStream(e,r,n){return this._server.requestStream(e,r,n)}async getTask(e,r){return this._server.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._server.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._server.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._server.cancelTask({taskId:e},r)}};function Cg(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function Og(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}var ai=class extends $s{constructor(e,r){super(r),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Un.options.map((n,o)=>[n,o])),this.isMessageIgnored=(n,o)=>{let s=this._loggingLevels.get(o);return s?this.LOG_LEVEL_SEVERITY.get(n)<this.LOG_LEVEL_SEVERITY.get(s):!1},this._capabilities=r?.capabilities??{},this._instructions=r?.instructions,this._jsonSchemaValidator=r?.jsonSchemaValidator??new si,this.setRequestHandler(Cc,n=>this._oninitialize(n)),this.setNotificationHandler(Oc,()=>this.oninitialized?.()),this._capabilities.logging&&this.setRequestHandler(qc,async(n,o)=>{let s=o.sessionId||o.requestInfo?.headers["mcp-session-id"]||void 0,{level:i}=n.params,a=Un.safeParse(i);return a.success&&this._loggingLevels.set(s,a.data),{}})}get experimental(){return this._experimental||(this._experimental={tasks:new ii(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Ff(this._capabilities,e)}setRequestHandler(e,r){let o=Lt(e)?.method;if(!o)throw new Error("Schema is missing a method literal");let s;if(Ge(o)){let a=o;s=a._zod?.def?.value??a.value}else{let a=o;s=a._def?.value??a.value}if(typeof s!="string")throw new Error("Schema method literal must be a string");if(s==="tools/call"){let a=async(c,u)=>{let l=qt(Gr,c);if(!l.success){let p=l.error instanceof Error?l.error.message:String(l.error);throw new I(Z.InvalidParams,`Invalid tools/call request: ${p}`)}let{params:d}=l.data,h=await Promise.resolve(r(c,u));if(d.task){let p=qt(Kr,h);if(!p.success){let m=p.error instanceof Error?p.error.message:String(p.error);throw new I(Z.InvalidParams,`Invalid task creation result: ${m}`)}return p.data}let f=qt(hs,h);if(!f.success){let p=f.error instanceof Error?f.error.message:String(f.error);throw new I(Z.InvalidParams,`Invalid tools/call result: ${p}`)}return f.data};return super.setRequestHandler(e,a)}return super.setRequestHandler(e,r)}assertCapabilityForMethod(e){switch(e){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw new Error(`Client does not support URL elicitation (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"completion/complete":if(!this._capabilities.completions)throw new Error(`Server does not support completions (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Server does not support tasks capability (required for ${e})`);break;case"ping":case"initialize":break}}assertTaskCapability(e){Og(this._clientCapabilities?.tasks?.requests,e,"Client")}assertTaskHandlerCapability(e){this._capabilities&&Cg(this._capabilities.tasks?.requests,e,"Server")}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Bp.includes(r)?r:Tc,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},Qo)}async createMessage(e,r){if((e.tools||e.toolChoice)&&!this._clientCapabilities?.sampling?.tools)throw new Error("Client does not support sampling tools capability.");if(e.messages.length>0){let n=e.messages[e.messages.length-1],o=Array.isArray(n.content)?n.content:[n.content],s=o.some(u=>u.type==="tool_result"),i=e.messages.length>1?e.messages[e.messages.length-2]:void 0,a=i?Array.isArray(i.content)?i.content:[i.content]:[],c=a.some(u=>u.type==="tool_use");if(s){if(o.some(u=>u.type!=="tool_result"))throw new Error("The last message must contain only tool_result content if any is present");if(!c)throw new Error("tool_result blocks are not matching any tool_use from the previous message")}if(c){let u=new Set(a.filter(d=>d.type==="tool_use").map(d=>d.id)),l=new Set(o.filter(d=>d.type==="tool_result").map(d=>d.toolUseId));if(u.size!==l.size||![...u].every(d=>l.has(d)))throw new Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}return e.tools?this.request({method:"sampling/createMessage",params:e},Uc,r):this.request({method:"sampling/createMessage",params:e},Lc,r)}async elicitInput(e,r){switch(e.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support url elicitation.");let o=e;return this.request({method:"elicitation/create",params:o},gs,r)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw new Error("Client does not support form elicitation.");let o=e.mode==="form"?e:{...e,mode:"form"},s=await this.request({method:"elicitation/create",params:o},gs,r);if(s.action==="accept"&&s.content&&o.requestedSchema)try{let a=this._jsonSchemaValidator.getValidator(o.requestedSchema)(s.content);if(!a.valid)throw new I(Z.InvalidParams,`Elicitation response content does not match requested schema: ${a.errorMessage}`)}catch(i){throw i instanceof I?i:new I(Z.InternalError,`Error validating elicitation response: ${i instanceof Error?i.message:String(i)}`)}return s}}}createElicitationCompletionNotifier(e,r){if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:e}},r)}async listRoots(e,r){return this.request({method:"roots/list",params:e},Vc,r)}async sendLoggingMessage(e,r){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,r))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var Ng=Symbol.for("mcp.completable");function Fl(t){return!!t&&typeof t=="object"&&Ng in t}function jg(t){return t[Ng]?.complete}var Zg;(function(t){t.Completable="McpCompletable"})(Zg||(Zg={}));var qz=/^[A-Za-z0-9._-]{1,128}$/;function Lz(t){let e=[];if(t.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(t.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${t.length})`]};if(t.includes(" ")&&e.push("Tool name contains spaces, which may cause parsing issues"),t.includes(",")&&e.push("Tool name contains commas, which may cause parsing issues"),(t.startsWith("-")||t.endsWith("-"))&&e.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts"),(t.startsWith(".")||t.endsWith("."))&&e.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts"),!qz.test(t)){let r=t.split("").filter(n=>!/[A-Za-z0-9._-]/.test(n)).filter((n,o,s)=>s.indexOf(n)===o);return e.push(`Tool name contains invalid characters: ${r.map(n=>`"${n}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:e}}return{isValid:!0,warnings:e}}function Uz(t,e){if(e.length>0){console.warn(`Tool name validation warning for "${t}":`);for(let r of e)console.warn(`  - ${r}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function Hl(t){let e=Lz(t);return Uz(t,e.warnings),e.isValid}var ci=class{constructor(e){this._mcpServer=e}registerToolTask(e,r,n){let o={taskSupport:"required",...r.execution};if(o.taskSupport==="forbidden")throw new Error(`Cannot register task-based tool '${e}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(e,r.title,r.description,r.inputSchema,r.outputSchema,r.annotations,o,r._meta,n)}};var ui=class{constructor(e,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new ai(e,r)}get experimental(){return this._experimental||(this._experimental={tasks:new ci(this)}),this._experimental}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(ms)),this.server.assertCanSetRequestHandler(Yt(Gr)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(ms,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,r])=>{let n={name:e,title:r.title,description:r.description,inputSchema:(()=>{let o=Hr(r.inputSchema);return o?Gc(o,{strictUnions:!0,pipeStrategy:"input"}):Vz})(),annotations:r.annotations,execution:r.execution,_meta:r._meta};if(r.outputSchema){let o=Hr(r.outputSchema);o&&(n.outputSchema=Gc(o,{strictUnions:!0,pipeStrategy:"output"}))}return n})})),this.server.setRequestHandler(Gr,async(e,r)=>{try{let n=this._registeredTools[e.params.name];if(!n)throw new I(Z.InvalidParams,`Tool ${e.params.name} not found`);if(!n.enabled)throw new I(Z.InvalidParams,`Tool ${e.params.name} disabled`);let o=!!e.params.task,s=n.execution?.taskSupport,i="createTask"in n.handler;if((s==="required"||s==="optional")&&!i)throw new I(Z.InternalError,`Tool ${e.params.name} has taskSupport '${s}' but was not registered with registerToolTask`);if(s==="required"&&!o)throw new I(Z.MethodNotFound,`Tool ${e.params.name} requires task augmentation (taskSupport: 'required')`);if(s==="optional"&&!o&&i)return await this.handleAutomaticTaskPolling(n,e,r);let a=await this.validateToolInput(n,e.params.arguments,e.params.name),c=await this.executeToolHandler(n,a,r);return o||await this.validateToolOutput(n,c,e.params.name),c}catch(n){if(n instanceof I&&n.code===Z.UrlElicitationRequired)throw n;return this.createToolError(n instanceof Error?n.message:String(n))}}),this._toolHandlersInitialized=!0)}createToolError(e){return{content:[{type:"text",text:e}],isError:!0}}async validateToolInput(e,r,n){if(!e.inputSchema)return;let s=Hr(e.inputSchema)??e.inputSchema,i=await Ho(s,r);if(!i.success){let a="error"in i?i.error:"Unknown error",c=Bo(a);throw new I(Z.InvalidParams,`Input validation error: Invalid arguments for tool ${n}: ${c}`)}return i.data}async validateToolOutput(e,r,n){if(!e.outputSchema||!("content"in r)||r.isError)return;if(!r.structuredContent)throw new I(Z.InvalidParams,`Output validation error: Tool ${n} has an output schema but no structured content was provided`);let o=Hr(e.outputSchema),s=await Ho(o,r.structuredContent);if(!s.success){let i="error"in s?s.error:"Unknown error",a=Bo(i);throw new I(Z.InvalidParams,`Output validation error: Invalid structured content for tool ${n}: ${a}`)}}async executeToolHandler(e,r,n){let o=e.handler;if("createTask"in o){if(!n.taskStore)throw new Error("No task store provided.");let i={...n,taskStore:n.taskStore};if(e.inputSchema){let a=o;return await Promise.resolve(a.createTask(r,i))}else{let a=o;return await Promise.resolve(a.createTask(i))}}if(e.inputSchema){let i=o;return await Promise.resolve(i(r,n))}else{let i=o;return await Promise.resolve(i(n))}}async handleAutomaticTaskPolling(e,r,n){if(!n.taskStore)throw new Error("No task store provided for task-capable tool.");let o=await this.validateToolInput(e,r.params.arguments,r.params.name),s=e.handler,i={...n,taskStore:n.taskStore},a=o?await Promise.resolve(s.createTask(o,i)):await Promise.resolve(s.createTask(i)),c=a.task.taskId,u=a.task,l=u.pollInterval??5e3;for(;u.status!=="completed"&&u.status!=="failed"&&u.status!=="cancelled";){await new Promise(h=>setTimeout(h,l));let d=await n.taskStore.getTask(c);if(!d)throw new I(Z.InternalError,`Task ${c} not found during polling`);u=d}return await n.taskStore.getTaskResult(c)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Yt(ys)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(ys,async e=>{switch(e.params.ref.type){case"ref/prompt":return uf(e),this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return lf(e),this.handleResourceCompletion(e,e.params.ref);default:throw new I(Z.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,r){let n=this._registeredPrompts[r.name];if(!n)throw new I(Z.InvalidParams,`Prompt ${r.name} not found`);if(!n.enabled)throw new I(Z.InvalidParams,`Prompt ${r.name} disabled`);if(!n.argsSchema)return xo;let s=Lt(n.argsSchema)?.[e.params.argument.name];if(!Fl(s))return xo;let i=jg(s);if(!i)return xo;let a=await i(e.params.argument.value,e.params.context);return Mg(a)}async handleResourceCompletion(e,r){let n=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===r.uri);if(!n){if(this._registeredResources[r.uri])return xo;throw new I(Z.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let o=n.resourceTemplate.completeCallback(e.params.argument.name);if(!o)return xo;let s=await o(e.params.argument.value,e.params.context);return Mg(s)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(us)),this.server.assertCanSetRequestHandler(Yt(ls)),this.server.assertCanSetRequestHandler(Yt(ds)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(us,async(e,r)=>{let n=Object.entries(this._registeredResources).filter(([s,i])=>i.enabled).map(([s,i])=>({uri:s,name:i.name,...i.metadata})),o=[];for(let s of Object.values(this._registeredResourceTemplates)){if(!s.resourceTemplate.listCallback)continue;let i=await s.resourceTemplate.listCallback(r);for(let a of i.resources)o.push({...s.metadata,...a})}return{resources:[...n,...o]}}),this.server.setRequestHandler(ls,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,n])=>({name:r,uriTemplate:n.resourceTemplate.uriTemplate.toString(),...n.metadata}))})),this.server.setRequestHandler(ds,async(e,r)=>{let n=new URL(e.params.uri),o=this._registeredResources[n.toString()];if(o){if(!o.enabled)throw new I(Z.InvalidParams,`Resource ${n} disabled`);return o.readCallback(n,r)}for(let s of Object.values(this._registeredResourceTemplates)){let i=s.resourceTemplate.uriTemplate.match(n.toString());if(i)return s.readCallback(n,i,r)}throw new I(Z.InvalidParams,`Resource ${n} not found`)}),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(ps)),this.server.assertCanSetRequestHandler(Yt(fs)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(ps,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,r])=>({name:e,title:r.title,description:r.description,arguments:r.argsSchema?Hz(r.argsSchema):void 0}))})),this.server.setRequestHandler(fs,async(e,r)=>{let n=this._registeredPrompts[e.params.name];if(!n)throw new I(Z.InvalidParams,`Prompt ${e.params.name} not found`);if(!n.enabled)throw new I(Z.InvalidParams,`Prompt ${e.params.name} disabled`);if(n.argsSchema){let o=Hr(n.argsSchema),s=await Ho(o,e.params.arguments);if(!s.success){let c="error"in s?s.error:"Unknown error",u=Bo(c);throw new I(Z.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${u}`)}let i=s.data,a=n.callback;return await Promise.resolve(a(i,r))}else{let o=n.callback;return await Promise.resolve(o(r))}}),this._promptHandlersInitialized=!0)}resource(e,r,...n){let o;typeof n[0]=="object"&&(o=n.shift());let s=n[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let i=this._createRegisteredResource(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let i=this._createRegisteredResourceTemplate(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(e,r,n,o){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let s=this._createRegisteredResource(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let s=this._createRegisteredResourceTemplate(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}}_createRegisteredResource(e,r,n,o,s){let i={name:e,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:a=>{typeof a.uri<"u"&&a.uri!==n&&(delete this._registeredResources[n],a.uri&&(this._registeredResources[a.uri]=i)),typeof a.name<"u"&&(i.name=a.name),typeof a.title<"u"&&(i.title=a.title),typeof a.metadata<"u"&&(i.metadata=a.metadata),typeof a.callback<"u"&&(i.readCallback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendResourceListChanged()}};return this._registeredResources[n]=i,i}_createRegisteredResourceTemplate(e,r,n,o,s){let i={resourceTemplate:n,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:u=>{typeof u.name<"u"&&u.name!==e&&(delete this._registeredResourceTemplates[e],u.name&&(this._registeredResourceTemplates[u.name]=i)),typeof u.title<"u"&&(i.title=u.title),typeof u.template<"u"&&(i.resourceTemplate=u.template),typeof u.metadata<"u"&&(i.metadata=u.metadata),typeof u.callback<"u"&&(i.readCallback=u.callback),typeof u.enabled<"u"&&(i.enabled=u.enabled),this.sendResourceListChanged()}};this._registeredResourceTemplates[e]=i;let a=n.uriTemplate.variableNames;return Array.isArray(a)&&a.some(u=>!!n.completeCallback(u))&&this.setCompletionRequestHandler(),i}_createRegisteredPrompt(e,r,n,o,s){let i={title:r,description:n,argsSchema:o===void 0?void 0:$r(o),callback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:a=>{typeof a.name<"u"&&a.name!==e&&(delete this._registeredPrompts[e],a.name&&(this._registeredPrompts[a.name]=i)),typeof a.title<"u"&&(i.title=a.title),typeof a.description<"u"&&(i.description=a.description),typeof a.argsSchema<"u"&&(i.argsSchema=$r(a.argsSchema)),typeof a.callback<"u"&&(i.callback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,o&&Object.values(o).some(c=>{let u=c instanceof je?c._def?.innerType:c;return Fl(u)})&&this.setCompletionRequestHandler(),i}_createRegisteredTool(e,r,n,o,s,i,a,c,u){Hl(e);let l={title:r,description:n,inputSchema:Ag(o),outputSchema:Ag(s),annotations:i,execution:a,_meta:c,handler:u,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:d=>{typeof d.name<"u"&&d.name!==e&&(typeof d.name=="string"&&Hl(d.name),delete this._registeredTools[e],d.name&&(this._registeredTools[d.name]=l)),typeof d.title<"u"&&(l.title=d.title),typeof d.description<"u"&&(l.description=d.description),typeof d.paramsSchema<"u"&&(l.inputSchema=$r(d.paramsSchema)),typeof d.outputSchema<"u"&&(l.outputSchema=$r(d.outputSchema)),typeof d.callback<"u"&&(l.handler=d.callback),typeof d.annotations<"u"&&(l.annotations=d.annotations),typeof d._meta<"u"&&(l._meta=d._meta),typeof d.enabled<"u"&&(l.enabled=d.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let n,o,s,i;if(typeof r[0]=="string"&&(n=r.shift()),r.length>1){let c=r[0];Bl(c)?(o=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!Bl(r[0])&&(i=r.shift())):typeof c=="object"&&c!==null&&(i=r.shift())}let a=r[0];return this._createRegisteredTool(e,void 0,n,o,s,i,{taskSupport:"forbidden"},void 0,a)}registerTool(e,r,n){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let{title:o,description:s,inputSchema:i,outputSchema:a,annotations:c,_meta:u}=r;return this._createRegisteredTool(e,o,s,i,a,c,{taskSupport:"forbidden"},u,n)}prompt(e,...r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let n;typeof r[0]=="string"&&(n=r.shift());let o;r.length>1&&(o=r.shift());let s=r[0],i=this._createRegisteredPrompt(e,void 0,n,o,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,r,n){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let{title:o,description:s,argsSchema:i}=r,a=this._createRegisteredPrompt(e,o,s,i,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),a}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(e,r){return this.server.sendLoggingMessage(e,r)}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}};var Vz={type:"object",properties:{}};function Dg(t){return t!==null&&typeof t=="object"&&"parse"in t&&typeof t.parse=="function"&&"safeParse"in t&&typeof t.safeParse=="function"}function Fz(t){return"_def"in t||"_zod"in t||Dg(t)}function Bl(t){return typeof t!="object"||t===null||Fz(t)?!1:Object.keys(t).length===0?!0:Object.values(t).some(Dg)}function Ag(t){if(t)return Bl(t)?$r(t):t}function Hz(t){let e=Lt(t);return e?Object.entries(e).map(([r,n])=>{let o=wp(n),s=kp(n);return{name:r,description:o,required:!s}}):[]}function Yt(t){let r=Lt(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Ko(r);if(typeof n=="string")return n;throw new Error("Schema method literal must be a string")}function Mg(t){return{completion:{values:t.slice(0,100),total:t.length,hasMore:t.length>100}}}var xo={completion:{values:[],hasMore:!1}};var Kl=hi(require("node:process"),1);var li=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),Bz(r)}clear(){this._buffer=void 0}};function Bz(t){return ef.parse(JSON.parse(t))}function qg(t){return JSON.stringify(t)+`
`}var di=class{constructor(e=Kl.default.stdin,r=Kl.default.stdout){this._stdin=e,this._stdout=r,this._readBuffer=new li,this._started=!1,this._ondata=n=>{this._readBuffer.append(n),this.processReadBuffer()},this._onerror=n=>{this.onerror?.(n)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(;;)try{let e=this._readBuffer.readMessage();if(e===null)break;this.onmessage?.(e)}catch(e){this.onerror?.(e)}}async close(){this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),this.onclose?.()}send(e){return new Promise(r=>{let n=qg(e);this._stdout.write(n)?r():this._stdout.once("drain",r)})}};var pi=class{baseUrl;apiKey;teamId;projectId;constructor(e){if(this.apiKey=e?.apiKey??process.env.CONTOX_API_KEY??"",this.baseUrl=(e?.apiUrl??process.env.CONTOX_API_URL??"https://contox.dev").replace(/\/$/,""),this.teamId=e?.teamId??process.env.CONTOX_TEAM_ID??"",this.projectId=e?.projectId??process.env.CONTOX_PROJECT_ID??"",!this.apiKey)throw new Error("CONTOX_API_KEY is required. Set it as an environment variable.");if(!this.teamId)throw new Error("CONTOX_TEAM_ID is required. Set it as an environment variable.");if(!this.projectId)throw new Error("CONTOX_PROJECT_ID is required. Set it as an environment variable.")}async request(e,r={}){let n=`${this.baseUrl}/api${e}`,o=await fetch(n,{...r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`,...r.headers}});if(!o.ok){let s=await o.json().catch(()=>({})),i=typeof s.error=="string"?s.error:o.statusText;throw new Error(`API error (${String(o.status)}): ${i}`)}return o.json()}async listContexts(){return this.request(`/contexts?teamId=${encodeURIComponent(this.teamId)}&projectId=${encodeURIComponent(this.projectId)}`)}async getContext(e){return this.request(`/contexts/${encodeURIComponent(e)}`)}async createContext(e){return this.request("/contexts",{method:"POST",body:JSON.stringify(e)})}async updateContext(e,r){return this.request(`/contexts/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(r)})}async deleteContext(e){await this.request(`/contexts/${encodeURIComponent(e)}`,{method:"DELETE"})}async searchContexts(e){let r=await this.listContexts(),n=e.toLowerCase();return r.filter(o=>o.name.toLowerCase().includes(n)||(o.description?.toLowerCase().includes(n)??!1))}async searchContent(e){return this.request(`/contexts/search?q=${encodeURIComponent(e)}&projectId=${encodeURIComponent(this.projectId)}`)}async findContextByName(e){return(await this.listContexts()).find(n=>n.name===e)??null}};var Ct=[{id:"architecture",name:"Architecture",description:"Tech stack, architecture decisions, design patterns, project structure, infrastructure",order:0},{id:"conventions",name:"Conventions & Rules",description:"Coding conventions, style rules, linter gotchas, naming patterns, team agreements",order:1},{id:"implementation",name:"Implementation Log",description:"Features built, components created, APIs implemented, integrations added",order:2},{id:"decisions",name:"Technical Decisions",description:"Key decisions with rationale: why X over Y, trade-offs considered, constraints",order:3},{id:"bugs",name:"Bugs & Fixes",description:"Bugs found and how they were fixed, edge cases discovered, workarounds applied",order:4},{id:"todo",name:"Todo & Next Steps",description:"Pending tasks, known issues, planned improvements, tech debt to address",order:5},{id:"sessions",name:"Session Log",description:"Chronological log of all AI sessions with date and summary",order:6}],Or="Project Memory",Lg="Root context for AI project memory \u2014 contains all sub-contexts";function fn(t){return`[Memory] ${t.name}`}function Jl(t){return Ct.find(e=>e.id===t)}async function Ug(t){let e=await t.listContexts();if(e.length===0)return{document:`# Project Memory

_No context saved yet. This is the first session._
`,tokenEstimate:15,subContextCount:0,rootId:null};let r=e.find(l=>l.name===Or),n=r?.id??null,o=[];if(o.push(`# Project Memory
`),r){let l=await Gl(t,r);if(l){let d=l.match(/\*\*Latest session\*\*: (.+)/);d&&o.push(`> Last session: ${d[1]}
`)}}let s=0;for(let l of Ct){let d=fn(l),h=e.find(p=>p.name===d);if(!h)continue;let f=await Gl(t,h);!f||f.trim().length===0||(s++,o.push(`## ${l.name}
`),o.push(f.trim()),o.push(""))}let i=new Set([Or,...Ct.map(l=>fn(l))]),a=e.filter(l=>!i.has(l.name));if(a.length>0){o.push(`## Custom Contexts
`);for(let l of a){let d=await Gl(t,l);d&&d.trim().length>0&&(s++,o.push(`### ${l.name}`),l.description&&o.push(`> ${l.description}
`),o.push(d.trim()),o.push(""))}}let c=o.join(`
`),u=Math.ceil(c.length/4);return{document:c,tokenEstimate:u,subContextCount:s,rootId:n}}async function Gl(t,e){if(e.content!==null&&e.content.length>0)return e.content;try{return(await t.getContext(e.id)).content??""}catch{return""}}var Vg=48e3;async function Bg(t,e){let r=await t.listContexts(),n=new Map;for(let k of r)n.set(k.name,k);let o=n.get(Or),s=0,i=0,a=[];o||(o=await t.createContext({name:Or,teamId:t.teamId,projectId:t.projectId,description:Lg}),s++,a.push(Or));let c=r.filter(k=>k.parentContextId===o.id).length,u=Kz(e.summary,c,e.changes);await t.updateContext(o.id,{content:u});let l=`### ${new Date().toISOString().split("T")[0]} \u2014 ${e.summary.slice(0,80)}
`,d=new Map;for(let k of e.changes){let O=Jl(k.category);if(!O)continue;let me=O.id,ge=d.get(me)??[];ge.push(k),d.set(me,ge)}for(let[k,O]of d){let me=Jl(k),ge=fn(me),Be=n.get(ge);Be||(Be=await t.createContext({name:ge,teamId:t.teamId,projectId:t.projectId,description:me.description,parentContextId:o.id}),n.set(ge,Be),s++);let mn=await Fg(t,Be),Qt=O.map(gn=>`**${gn.title}**

${gn.content.trim()}`).join(`

---

`),hn=`${l}
${Qt}
`,bo=Hg(mn,hn);await t.updateContext(Be.id,{content:bo,order:me.order}),i++,a.push(ge)}let h=Ct.find(k=>k.id==="sessions"),f=fn(h),p=n.get(f);p||(p=await t.createContext({name:f,teamId:t.teamId,projectId:t.projectId,description:h.description,parentContextId:o.id}),s++);let m=await Fg(t,p),g=new Date().toISOString(),v=e.changes.map(k=>k.category).join(", "),x=`- **${g}**: ${e.summary} _(${v})_
`,w=Hg(m,x);return await t.updateContext(p.id,{content:w,order:h.order}),a.includes(f)||(i++,a.push(f)),{created:s,updated:i,affected:a,rootId:o.id}}function Kz(t,e,r){let n=[];n.push(`# Project Memory
`),n.push(`> Last session: ${new Date().toISOString()}
`),n.push(`**Sub-contexts**: ${String(e+1)}
`),n.push(`**Latest session**: ${t}
`),n.push(`## Categories
`);for(let o of Ct){let i=r.some(a=>a.category===o.id)?"(updated)":"";n.push(`- **${o.name}** \u2014 ${o.description} ${i}`)}return n.push(""),n.join(`
`)}async function Fg(t,e){if(e.content!==null)return e.content;try{return(await t.getContext(e.id)).content??""}catch{return""}}function Hg(t,e){if(!t)return e;let r=`${t}
${e}`;if(r.length<=Vg)return r;let n=r.length-Vg,o=r.slice(n),s=o.indexOf(`
`);return s>0?`[...older entries trimmed...]
${o.slice(s+1)}`:o}var Ot=new ui({name:"contox",version:"2.0.0"}),dt=new pi;Ot.tool("contox_get_memory","Load the complete project memory. Call this at the START of every session to remember previous work. Returns a markdown document with: Architecture, Conventions, Implementation Log, Decisions, Bugs & Fixes, Todo, and Session Log.",{},async()=>{try{let t=await Ug(dt);return{content:[{type:"text",text:t.document+`
---
_${String(t.subContextCount)} sub-contexts loaded (~${String(t.tokenEstimate)} tokens)_
`}]}}catch(t){return{content:[{type:"text",text:`Error loading memory: ${String(t)}`}],isError:!0}}});var Jz=Ct.filter(t=>t.id!=="sessions").map(t=>`"${t.id}": ${t.description}`).join(`
`);Ot.tool("contox_save_session",`Save this session's work into persistent project memory. Call this at the END of every session.

Provide a summary and structured changes. Each change has a category, title, and content.

Available categories:
${Jz}

The session log is updated automatically. Content is APPENDED to existing sub-contexts (never overwritten).`,{summary:ye.string().describe("Brief session summary (1-3 sentences): what was accomplished"),changes:ye.array(ye.object({category:ye.enum(["architecture","conventions","implementation","decisions","bugs","todo"]).describe("Category for this change"),title:ye.string().describe('Brief title (e.g. "Added auth middleware", "Fixed CSS z-index bug")'),content:ye.string().describe("Detailed content to save. Use markdown. Be specific and include file paths, patterns, key decisions.")})).describe("List of changes to save, organized by category")},async t=>{try{let e=await Bg(dt,{summary:t.summary,changes:t.changes});return{content:[{type:"text",text:["Session saved successfully.",`- Created: ${String(e.created)} new sub-contexts`,`- Updated: ${String(e.updated)} existing sub-contexts`,`- Affected: ${e.affected.join(", ")}`].join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Error saving session: ${String(e)}`}],isError:!0}}});Ot.tool("contox_list_contexts","List all contexts for the current project (including sub-contexts)",{},async()=>{try{let e=(await dt.listContexts()).map(r=>({id:r.id,name:r.name,description:r.description,parentContextId:r.parentContextId,tokens:r.tokens,updatedAt:r.updatedAt}));return{content:[{type:"text",text:JSON.stringify(e,null,2)}]}}catch(t){return{content:[{type:"text",text:`Error: ${String(t)}`}],isError:!0}}});Ot.tool("contox_get_context","Get a specific context by ID, including its full content",{id:ye.string().describe("The context ID")},async t=>{try{let e=await dt.getContext(t.id);return{content:[{type:"text",text:JSON.stringify(e,null,2)}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Ot.tool("contox_create_context","Create a new context manually. For session-based memory, prefer contox_save_session.",{name:ye.string().describe("Context name"),description:ye.string().optional().describe("Optional description"),content:ye.string().optional().describe("Optional initial content"),parentContextId:ye.string().optional().describe("Optional parent context ID for hierarchy")},async t=>{try{let e=await dt.createContext({name:t.name,teamId:dt.teamId,projectId:dt.projectId,description:t.description,parentContextId:t.parentContextId});return t.content&&await dt.updateContext(e.id,{content:t.content}),{content:[{type:"text",text:`Context created: ${e.name} (${e.id})`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Ot.tool("contox_update_context","Update an existing context (name, description, or content). Content is replaced, not appended. For incremental updates, prefer contox_save_session.",{id:ye.string().describe("The context ID to update"),name:ye.string().optional().describe("New name"),description:ye.string().optional().describe("New description"),content:ye.string().optional().describe("New content (replaces existing)")},async t=>{try{let e={};t.name!==void 0&&(e.name=t.name),t.description!==void 0&&(e.description=t.description),t.content!==void 0&&(e.content=t.content);let r=await dt.updateContext(t.id,e);return{content:[{type:"text",text:`Context updated: ${r.name} (${r.id})`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Ot.tool("contox_delete_context","Delete a context by ID. This is irreversible.",{id:ye.string().describe("The context ID to delete")},async t=>{try{return await dt.deleteContext(t.id),{content:[{type:"text",text:`Context deleted: ${t.id}`}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});Ot.tool("contox_search",`Search contexts by name, description, AND content. Use this to find specific code patterns, function signatures, API endpoints, component props, or any information stored in the project memory. Returns matching snippets with surrounding context.

Examples: "useAuth", "stripe", "password reset", "Button props", "GET /api/contexts"`,{query:ye.string().describe("Search query \u2014 searches across all context content, names, and descriptions")},async t=>{try{let e=await dt.searchContent(t.query);if(e.length===0)return{content:[{type:"text",text:`No results found for "${t.query}"`}]};let r=[];r.push(`Found ${String(e.length)} matching context(s) for "${t.query}":
`);for(let n of e){if(r.push(`## ${n.name}`),r.push(`> ID: ${n.id} | Match: ${n.matchType}`),n.description&&r.push(`> ${n.description}`),n.snippets.length>0){r.push("");for(let o of n.snippets)r.push("```"),r.push(o),r.push("```")}r.push("")}return{content:[{type:"text",text:r.join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Error: ${String(e)}`}],isError:!0}}});async function Gz(){let t=new di;await Ot.connect(t)}Gz().catch(t=>{console.error("Fatal error:",t),process.exit(1)});
